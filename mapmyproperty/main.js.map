{"version":3,"sources":["./$_lazy_route_resource lazy namespace object","./src/app/app-routing.module.ts","./src/app/app.component.ts","./src/app/app.component.html","./src/app/app.module.ts","./src/app/shared/store/graphics.actions.ts","./src/app/shared/store/graphics.reducer.ts","./src/app/shared/store/graphics.state.ts","./src/app/shared/store/model.ts","./src/app/shared/store/ngrx-undo.ts","./src/environments/environment.ts","./src/main.ts"],"names":[],"mappings":"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","file":"main.js","sourcesContent":["function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = \"./$$_lazy_route_resource lazy recursive\";","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\n\nconst routes: Routes = [\n  {\n    path: 'mmp',\n    loadChildren: () => import('./mapmyproperty/homepage/homepage.module').then(m => m.HomepageModule)\n  }\n];\n\n\n@NgModule({\n  imports: [RouterModule.forRoot(routes)],\n  exports: [RouterModule]\n})\nexport class AppRoutingModule { }\n","import { Component, HostListener } from '@angular/core';\n\n@Component({\n  selector: \"app-root\",\n  templateUrl: \"./app.component.html\",\n  styleUrls: [\"./app.component.scss\"]\n})\nexport class AppComponent {\n  title = \"mapmyproperty\";\n\n}\n","\n<router-outlet></router-outlet>","import { BrowserModule } from '@angular/platform-browser';\nimport { NgModule } from '@angular/core';\n\nimport { StoreModule } from '@ngrx/store';\nimport { AppRoutingModule } from './app-routing.module';\nimport { AppComponent } from './app.component';\nimport { StoreDevtoolsModule } from '@ngrx/store-devtools';\nimport { environment } from '../environments/environment';\nimport { GraphicsReducer } from './shared/store/graphics.reducer';\nimport { MatIconModule } from \"@angular/material/icon\";\nimport { BrowserAnimationsModule } from \"@angular/platform-browser/animations\";\nimport { MatButtonModule } from '@angular/material/button';\nimport { MatTooltipModule } from \"@angular/material/tooltip\";\nimport { FlexLayoutModule } from \"@angular/flex-layout\";\n@NgModule({\n  declarations: [AppComponent],\n  imports: [\n    BrowserModule,\n    AppRoutingModule,\n    BrowserAnimationsModule,\n    FlexLayoutModule,\n    StoreModule.forRoot({ app: GraphicsReducer }),\n    environment.production ? [] : StoreDevtoolsModule.instrument()\n  ],\n  providers: [],\n  bootstrap: [AppComponent],\n  exports: [MatIconModule, MatButtonModule, MatTooltipModule, FlexLayoutModule]\n})\nexport class AppModule {}\n","import { createAction, props, union } from '@ngrx/store';\nexport const addGraphics = createAction('ADD_GRAPHIC', props<{payload: any}>());\nexport const removeGraphics = createAction('REMOVE_GRAPHIC', props<any>());\nexport const updateGraphics = createAction('UPDATE_GRAPHICS', props<any>());\nexport const removeAllGraphics = createAction('REMOVE_ALL_GRAPHICS');\n\nconst all = union({addGraphics, removeGraphics, updateGraphics, removeAllGraphics});\n\nexport type Actions = typeof all;\n","import { produce, PatchListener } from \"immer\";\nimport {\n  addGraphics,\n  Actions,\n  removeGraphics,\n  updateGraphics\n} from \"./graphics.actions\";\nimport { undoRedo } from \"./ngrx-undo\";\nimport { initialGraphicState } from \"./graphics.state\";\nimport { removeAllGraphics } from './graphics.actions';\n\nconst id = (): string =>\n  Math.random()\n    .toString(36)\n    .substr(2, 9);\n\nconst reducer = (state: any, action: any, listener?: PatchListener): any => {\n  console.log(action);\n  return produce(\n    state,\n    next => {\n      switch (action.type) {\n        case addGraphics.type:\n          next.graphics.push(action.payload);\n          return;\n        case removeGraphics.type:\n          console.log(action.gids);\n          const jj = JSON.parse(JSON.stringify(next.graphics));\n          action.gids.forEach(gid => {\n            const idx = next.graphics.findIndex(g => {\n              const _gid = JSON.parse(g).attributes.gid;\n              return gid === _gid;\n            });\n            jj.splice(idx, 1);\n          });\n          next.graphics = jj;\n\n          return;\n        case updateGraphics.type:\n          const _updatedGraphics = JSON.parse(action.graphics);\n          const newIds = _updatedGraphics.map(_u => _u.attributes.gid);\n          const j = JSON.parse(JSON.stringify(next.graphics));\n          for (let i = 0; i < j.length; i++) {\n            const n = JSON.parse(j[i]);\n            if (newIds.indexOf(n.attributes.gid) !== -1) {\n              const __u = _updatedGraphics.filter(\n                _u => _u.attributes.gid === n.attributes.gid\n              )[0];\n              j[i] = JSON.stringify(__u);\n            }\n          }\n          next.graphics = j;\n          return;\n\n        case removeAllGraphics.type:\n          next.graphics = [];\n          return;\n        default:\n          return;\n      }\n    },\n    listener\n  );\n};\n\nconst undoableReducer = undoRedo({ track: true })(reducer);\n\nconst GraphicsReducer = (state = initialGraphicState, action: Actions) => {\n  return undoableReducer(state, action);\n};\n\nexport { GraphicsReducer };\n","export interface Gstate {\n  graphics: any[];\n  canUndo: boolean;\n  canRedo: boolean;\n}\n\nexport interface GraphicsState {\n  app: Gstate;\n}\nexport const initialGraphicState: Gstate = {\n  graphics: [],\n  canUndo: false,\n  canRedo: false\n};\n","import { Action, ActionReducer } from '@ngrx/store';\nimport { Patch, PatchListener } from 'immer';\n\n/**\n * Reducer extension for capturing patches from immer.\n */\nexport interface PatchActionReducer<T, V extends Action = Action> extends ActionReducer<T, V> {\n  (state: T | undefined, action: V, patchListener: PatchListener): T;\n}\n\n/**\n * Wrapper for patches between two different states.\n */\nexport interface Patches {\n  patches: Patch[];\n  inversePatches: Patch[];\n}\n\n/**\n * Predicate for deciding whether differences from\n * two consecutive actions of the same type should be merged.\n */\nexport type MergeRule = (a: Action, b: Action) => boolean;\n\n/**\n * Configuration for undoRedo reducer.\n */\nexport interface WiederConfig {\n  /**\n   * How many state differences should be buffered in\n   * either direction.\n   */\n  maxBufferSize?: number;\n  /**\n   * Types of actions to use for calculating patches\n   * between states (leave empty to allow all actions).\n   */\n  allowedActionTypes?: string[];\n  /**\n   * Types of actions whose state difference should be\n   * merged when they appear consecutively\n   */\n  mergeActionTypes?: string[];\n  /**\n   * Predicates for deciding whether differences from\n   * two consecutive actions of the same type should be merged.\n   */\n  mergeRules?: Map<string, MergeRule>;\n  /**\n   * Override for the undo action's type.\n   */\n  undoActionType?: string;\n  /**\n   * Override for the redo action's type.\n   */\n  redoActionType?: string;\n  /**\n   * Override for the break-merge action's type.\n   */\n  breakMergeActionType?: string;\n  /**\n   * Override for the clear action's type.\n   */\n  clearActionType?: string;\n  /**\n   * Whether ability for undo/redo should be tracked in the state\n   * through properties `canUndo` and `canRedo`.\n   */\n  track?: boolean;\n}\n\nexport const defaultConfig: WiederConfig = {\n  allowedActionTypes: [],\n  mergeActionTypes: [],\n  mergeRules: new Map<string, MergeRule>(),\n  maxBufferSize: 32,\n  undoActionType: 'UNDO',\n  redoActionType: 'REDO',\n  breakMergeActionType: 'BREAK_MERGE',\n  clearActionType: 'CLEAR',\n  track: false\n};\n\n","\nimport {Action, ActionReducer} from '@ngrx/store';\nimport { applyPatches,  enablePatches} from 'immer';\nimport { fromNullable, map as maps, getOrElse, filter } from 'fp-ts/lib/Option';\nimport {defaultConfig, PatchActionReducer, Patches, WiederConfig} from './model';\nimport {pipe} from 'fp-ts/lib/pipeable';\n\nconst undoReducer = <T>(reducer: PatchActionReducer<T>, config: WiederConfig = {}): ActionReducer<T> => {\n    enablePatches();\n    const {\n        allowedActionTypes,\n        mergeActionTypes,\n        mergeRules,\n        maxBufferSize,\n        undoActionType,\n        redoActionType,\n        breakMergeActionType,\n        clearActionType,\n        track\n      } = {...defaultConfig, ...config};\n\n    let undoable: Patches[] = [];\n    let undone: Patches[] = [];\n    let lastAction: Action;\n    let mergeBroken = false;\n\n    const isUndoable = (action: Action) => !allowedActionTypes.length || allowedActionTypes.some(type => type === action.type);\n    const shouldMerge = (a: Action, b: Action): boolean => {\n        return !mergeBroken && a.type === b.type\n          && (mergeActionTypes.indexOf(a.type) !== -1\n            || pipe(fromNullable(mergeRules.get(a.type)), maps(r => r(a, b)), getOrElse(() => false))\n          );\n      };\n    const applyTracking = (state: T): T => {\n        if (track) {\n          return {\n            ...state,\n            canUndo: undoable.length > 0,\n            canRedo: undone.length > 0\n          };\n        }\n        return state;\n      };\n\n    return (state: T, action) => {\n        switch (action.type) {\n          case undoActionType: {\n            return pipe(fromNullable(undoable.shift()), // take patches from last undone action\n              maps(patches => {\n                undone = [patches].concat(undone); // put patches on redo stack (Array.shift somehow breaks with AOT)\n                return applyTracking(applyPatches(state, patches.inversePatches)); // reverse patches\n              }), getOrElse(() => state));\n          }\n          case redoActionType: {\n            return pipe(fromNullable(undone.shift()), // take patches from last undone action\n              maps(patches => {\n                undoable = [patches].concat(undoable); // put patches on undo stack (Array.shift somehow breaks with AOT)\n                return applyTracking(applyPatches(state, patches.patches)); // reverse patches\n              }), getOrElse(() => state));\n          }\n          case clearActionType: {\n            undone = [];\n            undoable = [];\n            mergeBroken = false;\n            lastAction = null;\n            return applyTracking(reducer(state, action));\n          }\n          case breakMergeActionType: {\n            mergeBroken = true;\n            return state;\n          }\n          default: {\n            if (isUndoable(action)) {\n              return applyTracking(reducer(state, action, (patches, inversePatches) => {\n                if (patches.length) {\n                  undoable = pipe(fromNullable(lastAction),\n                    filter(last => shouldMerge(last, action)),\n                    maps(() => [\n                      {\n                        // merge patches for consecutive actions of same type\n                        patches: [...undoable[0].patches, ...patches],\n                        inversePatches: [...inversePatches, ...undoable[0].inversePatches]\n                      },\n                      ...undoable.slice(1)\n                    ]),\n                    getOrElse(() => [\n                      // remember differences while dropping at buffer max-size\n                      {patches, inversePatches},\n                      ...undoable.slice(0, maxBufferSize - 1)\n                    ])\n                  );\n                  undone = []; // clear redo stack\n                  lastAction = action; // clear redo stack\n                  mergeBroken = false;\n                }\n              }));\n            }\n            return reducer(state, action);\n          }\n        }\n      };\n    };\n\n    /**\n     * Factory function for constructing an undoRedo meta-reducer.\n     * @param config configuration to use for initialization\n     */\nconst undoRedo = (config?: WiederConfig) => <T>(reducer: PatchActionReducer<T>) => undoReducer(reducer, config);\n\nexport {undoRedo};\n\n","// This file can be replaced during build by using the `fileReplacements` array.\n// `ng build --prod` replaces `environment.ts` with `environment.prod.ts`.\n// The list of file replacements can be found in `angular.json`.\n\nexport const environment = {\n  production: false\n};\n\n/*\n * For easier debugging in development mode, you can import the following file\n * to ignore zone related error stack frames such as `zone.run`, `zoneDelegate.invokeTask`.\n *\n * This import should be commented out in production mode because it will have a negative impact\n * on performance if an error is thrown.\n */\n// import 'zone.js/dist/zone-error';  // Included with Angular CLI.\n","import { enableProdMode } from '@angular/core';\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n\nimport { AppModule } from './app/app.module';\nimport { environment } from './environments/environment';\n\nif (environment.production) {\n  enableProdMode();\n}\n\nplatformBrowserDynamic().bootstrapModule(AppModule)\n  .catch(err => console.error(err));\n"],"sourceRoot":"webpack:///"}
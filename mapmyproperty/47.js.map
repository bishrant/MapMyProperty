{"version":3,"sources":["./node_modules/arcgis-js-api/layers/MapImageLayer.js","./node_modules/arcgis-js-api/layers/support/ExportImageParameters.js"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,sCAAsC;AACjD;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,mCAAmC;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iEAAiE;AACjE,gCAAgC,oCAAoC;AACpE;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN,oBAAoB;AACpB,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA,IAAI;AACJ,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM,2BAA2B;AACjC,wDAAwD,0CAA0C;AAClG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,iEAAiE;AACrE,IAAI,kEAAkE;AACtE;AACA,IAAI,oEAAoE;AACxE;AACA;AACA;AACA;AACA,IAAI,qEAAqE;AACzE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,OAAO;AACP;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;;AAEA,iCAAO,CAAC,kCAAS,CAAC,OAAS,CAAC,wHAAgC,CAAC,wIAAwC,CAAC,4HAAkC,CAAC,sHAA+B,CAAC,8HAAmC,CAAC,0HAAiC,CAAC,gFAAY,CAAC,sFAAe,CAAC,sFAAe,CAAC,wHAAgC,CAAC,oGAAsB,CAAC,gIAAoC,CAAC,wHAAgC,CAAC,kFAAS,CAAC,sHAA2B,CAAC,gHAAwB,CAAC,sHAA2B,CAAC,4GAAsB,CAAC,sHAA2B,CAAC,oHAA0B,CAAC,kHAAyB,CAAC,gHAAwB,CAAC,wHAA4B,CAAC,kIAAiC,CAAC,mCAAC,8DAA8D,mBAAmB,gBAAgB,2BAA2B,qSAAqS,0DAA0D,4BAA4B,MAAM,MAAM,8BAA8B,uCAAuC,qDAAqD,+BAA+B,oBAAoB,0BAA0B,eAAe,2CAA2C,kCAAkC,gDAAgD,2DAA2D,yBAAyB,0DAA0D,mCAAmC,6BAA6B,iBAAiB,IAAI,eAAe,yBAAyB,2CAA2C,EAAE,qBAAqB,8DAA8D,SAAS,SAAS,oBAAoB,8CAA8C,6FAA6F,UAAU,gFAAgF,QAAQ,0CAA0C,OAAO,sBAAsB,0BAA0B,gBAAgB,mCAAmC,0CAA0C,iEAAiE,iDAAiD,EAAE,qGAAqG,8CAA8C,cAAc,oBAAoB,6BAA6B,0EAA0E,QAAQ,EAAE,iNAAiN,QAAQ,GAAG,uCAAuC,uCAAuC,UAAU,0BAA0B,gBAAgB,0DAA0D,oCAAoC,iCAAiC,SAAS,SAAS,gCAAgC,GAAG,4HAA4H,oCAAoC,OAAO,EAAE,EAAE,kKAAkK,MAAM,kBAAkB,sMAAsM,MAAM,SAAS,SAAS,MAAM,4BAA4B,uDAAuD,MAAM,SAAS,SAAS,MAAM,2BAA2B,+GAA+G,MAAM,kBAAkB,sDAAsD,mBAAmB,eAAe,qCAAqC,OAAO,eAAe,oDAAoD,+BAA+B,gKAAgK,qCAAqC,iDAAiD,MAAM,QAAQ,+BAA+B,+HAA+H,0LAA0L;AAAA,oGAAC,C;;;;;;;;;;;ACxKn7J;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,iCAAO,CAAC,kCAAS,CAAC,OAAS,CAAC,2HAAmC,CAAC,2IAA2C,CAAC,+HAAqC,CAAC,+FAAqB,CAAC,mIAAuC,CAAC,0GAAiB,CAAC,kGAAa,CAAC,yFAAkB,CAAC,mCAAC,8BAA8B,sCAAsC,SAAS,EAAE,OAAO,sQAAsQ,eAAe,aAAa,8CAA8C,mCAAmC,iEAAiE,eAAe,sCAAsC,4CAA4C,6BAA6B,EAAE,uCAAuC,+BAA+B,wDAAwD,eAAe,mGAAmG,+BAA+B,6CAA6C,gBAAgB,WAAW,0GAA0G,kBAAkB,6FAA6F,0CAA0C,qCAAqC,yCAAyC,KAAK,+BAA+B,8CAA8C,eAAe,4BAA4B,4CAA4C,YAAY,2BAA2B,+BAA+B,iDAAiD,eAAe,+CAA+C,oCAAoC,EAAE,sDAAsD,wCAAwC,GAAG,QAAQ,+BAA+B,6CAA6C,eAAe,mEAAmE,iBAAiB,sDAAsD,+BAA+B,+CAA+C,eAAe,WAAW,kDAAkD,cAAc,6FAA6F,iBAAiB,uBAAuB,+BAA+B,wDAAwD,eAAe,gBAAgB,wBAAwB,yCAAyC,sFAAsF,yEAAyE,gBAAgB,oCAAoC,oDAAoD,gBAAgB,MAAM,+BAA+B,gCAAgC,oBAAoB,8FAA8F,0FAA0F,IAAI,4CAA4C,IAAI,gBAAgB,8DAA8D,oDAAoD,yFAAyF,kGAAkG,2CAA2C,6CAA6C,2CAA2C,gDAAgD,qCAAqC,mIAAmI,2IAA2I,8CAA8C,OAAO,6CAA6C,kDAAkD,wGAAwG,gBAAgB,0BAA0B;AAAA,oGAAC,C","file":"47.js","sourcesContent":["// COPYRIGHT © 2019 Esri\n//\n// All rights reserved under the copyright laws of the United States\n// and applicable international laws, treaties, and conventions.\n//\n// This material is licensed for use under the Esri Master License\n// Agreement (MLA), and is bound by the terms of that agreement.\n// You may redistribute and use this code without modification,\n// provided you adhere to the terms of the MLA and include this\n// copyright notice.\n//\n// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english\n//\n// For additional information, contact:\n// Environmental Systems Research Institute, Inc.\n// Attn: Contracts and Legal Services Department\n// 380 New York Street\n// Redlands, California, USA 92373\n// USA\n//\n// email: contracts@esri.com\n//\n// See http://js.arcgis.com/4.14/esri/copyright.txt for details.\n\n/**\n * ## Overview\n *\n * MapImageLayer allows you to display and analyze data from\n * [sublayers](#sublayers) defined in a\n * [map service](http://server.arcgis.com/en/server/latest/publish-services/windows/what-is-a-map-service.htm), exporting images\n * instead of features. Map service images are\n * dynamically generated on the server based on a request, which includes an\n * LOD (level of detail), a bounding box, dpi, spatial reference and other\n * options. The exported image is of the entire map extent specified.\n *\n * ::: esri-md class=\"panel trailer-1\"\n * Unlike {@link module:esri/layers/FeatureLayer}, MapImageLayer processing\n * is handled by the server, not the client. Offloading the processing to the\n * server allows MapImageLayer to render more features with a higher level\n * of performance in some cases.\n * :::\n *\n * MapImageLayer does not display tiled images. To display\n * tiled map service layers, see {@link module:esri/layers/TileLayer}.\n *\n * ## Creating a MapImageLayer\n *\n * MapImageLayer may be created in one of two ways: from a [service URL](#url) or from an ArcGIS\n * Portal [item ID](#portalItem).\n *\n * ### Reference a service URL\n *\n * To create a MapImageLayer instance from a service, you must set the [url](#url) property\n * to the REST endpoint of a layer in a Map Service. The URL will typically look\n * like the following.\n *\n * ```js\n * https://<hostname>/arcgis/rest/services/<service-name>/MapServer\n * ```\n *\n * For a layer to be visible in a view, it must be added to the {@link module:esri/Map}\n * referenced by the view. See {@link module:esri/Map#add Map.add()} for information about adding layers to a map.\n *\n * ```js\n * require([\"esri/layers/MapImageLayer\"], function(MapImageLayer){\n *   // points to the states layer in a service storing U.S. census data\n *   var layer = new MapImageLayer({\n *     url: \"https://sampleserver6.arcgisonline.com/arcgis/rest/services/Census/MapServer\"\n *   });\n *   map.add(layer);  // adds the layer to the map\n * });\n * ```\n *\n * If the map service is requested from a different domain, a [CORS enabled server](../guide/cors/index.html) or a [proxy](../guide/proxies/index.html) is\n * required.\n *\n * ### Reference an ArcGIS portal Item ID\n *\n * You can also create a MapImageLayer from its ID if it exists as an item in ArcGIS Online or ArcGIS Enterprise.\n * For example, the following snippet shows how to add a new MapImageLayer instance to a map using the\n * [portalItem](#portalItem) property.\n *\n * ```js\n * // references an ArcGIS Online item pointing to a Map Service Layer\n * var layer = new MapImageLayer({\n *   portalItem: {  // autocasts as esri/portal/PortalItem\n *     id: \"8444e275037549c1acab02d2626daaee\"\n *   }\n * });\n * map.add(layer);  // adds the layer to the map\n * ```\n *\n * ## Sublayers\n *\n * Map services contain one or more sublayers. Sublayers may even contain nested sublayers.\n * When the [sublayers](#sublayers) property of the MapImageLayer is not specified, then an image of all sublayers\n * in the service is exported to the client. If a subset of sublayers from the service are\n * specified, then only the subset of sublayers are rendered on the client.\n * Sublayers have default rendering, scale visibility, labels, and other properties saved to the server. However, these properties may be dynamically\n * changed so a new map image is exported to the view. Sublayers of a MapImageLayer can only be styled with 2D symbology even if they are rendered in\n * a {@link module:esri/WebScene}.\n * To learn more about working with sublayers, see the {@link module:esri/layers/support/Sublayer} API\n * documentation.\n *\n * [![mapimagelayer-renderer](../../assets/img/apiref/layers/mapimagelayer-renderer.png)](../sample-code/layers-mapimagelayer-renderers/index.html)\n *\n * <a name=\"dynamic-layers\"></a>\n * ## Dynamic layers\n *\n * Sublayers may be rendered on the fly as dynamic layers. There are two types of dynamic layers:\n * {@link module:esri/layers/support/Sublayer#source DynamicMapLayer} and\n * {@link module:esri/layers/support/Sublayer#source DynamicDataLayer}.\n *\n * {@link module:esri/layers/support/Sublayer#source Dynamic map layers} allow you\n * to override sublayers in the map service with new renderers,\n * definition expressions, opacity, scale visibility, etc. Multiple dynamic map layers may exist\n * for a single map service layer.\n *\n * {@link module:esri/layers/support/Sublayer#source Dynamic data layers} provide\n * the ability to create layers on the fly from data referenced in\n * registered workspaces.\n * The data may be tables with or without geometries, feature classes, and\n * rasters. These data sources are not directly visible to the services directory, but may be\n * published and configured with the ArcGIS Server Manager.\n * Data from tables may be joined to other tables or dynamic map layers.\n *\n * ::: esri-md class=\"panel trailer-1\"\n * Esri requires that when you use an ArcGIS Online basemap in your app, the map must include Esri attribution and you must be licensed to use the content.\n * For detailed guidelines on working with attribution, please visit the official [attribution in your app](https://developers.arcgis.com/terms/attribution/) documentation.\n * For information on terms of use, see the [Terms of Use FAQ](https://developers.arcgis.com/terms/faq/).\n * :::\n *\n * @module esri/layers/MapImageLayer\n * @since 4.0\n * @see module:esri/layers/support/Sublayer\n * @see module:esri/layers/TileLayer\n * @see [Sample - MapImageLayer](../sample-code/layers-mapimagelayer/index.html)\n * @see [Sample - MapImageLayer: toggle sublayer visibility](../sample-code/layers-mapimagelayer-sublayers/index.html)\n * @see [Sample - MapImageLayer: set definition expression](../sample-code/layers-mapimagelayer-definitionexpression/index.html)\n * @see [Sample - MapImageLayer: set renderers on sublayers](../sample-code/layers-mapimagelayer-renderers/index.html)\n * @see [Sample - MapImageLayer: label sublayer features](../sample-code/layers-mapimagelayer-dynamic-labels/index.html)\n * @see [Sample - MapImageLayer: create dynamic map layers](../sample-code/layers-dynamicmaplayer/index.html)\n * @see [Sample - MapImageLayer: dynamic data layer with table join](../sample-code/layers-dynamicdatalayer-table-join/index.html)\n * @see [Sample - MapImageLayer: dynamic data layer with query table](../sample-code/layers-dynamicdatalayer-query-table/index.html)\n * @see [Sample - MapImageLayer: dynamic data layer with raster](../sample-code/layers-dynamicdatalayer-raster/index.html)\n *\n * @example\n * var layer = new MapImageLayer({\n * url: \"https://sampleserver6.arcgisonline.com/arcgis/rest/services/USA/MapServer\",\n *   sublayers: [\n *    {\n *      id: 3,\n *      visible: false\n *    }, {\n *      id: 2,\n *      visible: true\n *    }, {\n *      id: 1,\n *      visible: true\n *    }, {\n *      id: 0,\n *      visible: true,\n *      definitionExpression: \"pop2000 > 100000\"\n *    }\n *  ]\n * });\n */\n\ndefine([\"require\",\"exports\",\"../core/tsSupport/assignHelper\",\"../core/tsSupport/declareExtendsHelper\",\"../core/tsSupport/decorateHelper\",\"../core/tsSupport/paramHelper\",\"../core/tsSupport/generatorHelper\",\"../core/tsSupport/awaiterHelper\",\"../request\",\"../core/Error\",\"../core/maybe\",\"../core/MultiOriginJSONSupport\",\"../core/promiseUtils\",\"../core/accessorSupport/decorators\",\"../geometry/support/scaleUtils\",\"./Layer\",\"./mixins/ArcGISMapService\",\"./mixins/ArcGISService\",\"./mixins/OperationalLayer\",\"./mixins/PortalLayer\",\"./mixins/RefreshableLayer\",\"./mixins/ScaleRangeLayer\",\"./mixins/SublayersOwner\",\"./mixins/TemporalLayer\",\"./support/commonProperties\",\"./support/ExportImageParameters\"],function(e,r,t,o,a,i,p,s,n,l,y,u,c,d,m,h,g,v,S,f,x,b,w,O,I,L){return function(e){function r(r,t){var o=e.call(this,r)||this;return o.alwaysRefetch=!1,o.dpi=96,o.gdbVersion=null,o.imageFormat=\"png24\",o.imageMaxHeight=2048,o.imageMaxWidth=2048,o.imageTransparency=!0,o.labelsVisible=!1,o.isReference=null,o.operationalLayerType=\"ArcGISMapServiceLayer\",o.sourceJSON=null,o.sublayers=null,o.type=\"map-image\",o.url=null,o}return o(r,e),r.prototype.normalizeCtorArgs=function(e,r){return\"string\"==typeof e?t({url:e},r):e},r.prototype.load=function(e){var r=this,t=y.isSome(e)?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:[\"Map Service\"]},e).then(function(){return r._fetchService(t)})),this.when()},r.prototype.readImageFormat=function(e,r){var t=r.supportedImageFormatTypes;return t&&t.indexOf(\"PNG32\")>-1?\"png32\":\"png24\"},r.prototype.createExportImageParameters=function(e,r,o,a){var i=a&&a.pixelRatio||1;e&&this.version>=10&&(e=e.clone().shiftCentralMeridian());var p=new L.ExportImageParameters({layer:this,scale:m.getScale({extent:e,width:r})*i}),s=p.toJSON();p.layer=null,p.destroy();var n=!a||!a.rotation||this.version<10.3?{}:{rotation:-a.rotation},l=e&&e.spatialReference,y=l.wkid||JSON.stringify(l.toJSON());s.dpi*=i;var u={};if(a&&a.timeExtent){var c=a.timeExtent.toJSON(),d=c.start,h=c.end;d&&h&&d===h?u.time=\"\"+d:null==d&&null==h||(u.time=(null==d?\"null\":d)+\",\"+(null==h?\"null\":h))}return t({bbox:e&&e.xmin+\",\"+e.ymin+\",\"+e.xmax+\",\"+e.ymax,bboxSR:y,imageSR:y,size:r+\",\"+o},s,n,u)},r.prototype.fetchImage=function(e,r,o,a){var i={responseType:\"image\"};a&&a.timestamp&&(i.query={_ts:a.timestamp}),a&&a.signal&&(i.signal=a.signal);var p=this.parsedUrl.path+\"/export\",s=t({},this.parsedUrl.query,this.createExportImageParameters(e,r,o,a),{f:\"image\",_ts:this.alwaysRefetch?Date.now():null});return null==s.dynamicLayers||this.capabilities.exportMap.supportsDynamicLayers?(i.query?i.query=t({},s,i.query):i.query=s,n(p,i).then(function(e){return e.data}).catch(function(e){if(c.isAbortError(e))throw e;throw new l(\"mapimagelayer:image-fetch-error\",\"Unable to load image: \"+p,{error:e})})):c.reject(new l(\"mapimagelayer:dynamiclayer-not-supported\",\"service \"+this.url+\" doesn't support dynamic layers, which is required to be able to change the sublayer's order, rendering, labeling or source.\",{query:s}))},r.prototype._fetchService=function(e){return s(this,void 0,void 0,function(){var r,o,a;return p(this,function(i){switch(i.label){case 0:return this.sourceJSON?(this.read(this.sourceJSON,{origin:\"service\",url:this.parsedUrl}),[2]):[4,n(this.parsedUrl.path,{query:t({f:\"json\"},this.parsedUrl.query),signal:e})];case 1:return r=i.sent(),o=r.data,a=r.ssl,a&&(this.url=this.url.replace(/^http:/i,\"https:\")),this.sourceJSON=o,this.read(o,{origin:\"service\",url:this.parsedUrl}),[2]}})})},a([d.property()],r.prototype,\"alwaysRefetch\",void 0),a([d.property()],r.prototype,\"dpi\",void 0),a([d.property()],r.prototype,\"gdbVersion\",void 0),a([d.property({json:{read:!1,write:!1}})],r.prototype,\"popupEnabled\",void 0),a([d.property()],r.prototype,\"imageFormat\",void 0),a([d.reader(\"imageFormat\",[\"supportedImageFormatTypes\"])],r.prototype,\"readImageFormat\",null),a([d.property({json:{origins:{service:{read:{source:\"maxImageHeight\"}}}}})],r.prototype,\"imageMaxHeight\",void 0),a([d.property({json:{origins:{service:{read:{source:\"maxImageWidth\"}}}}})],r.prototype,\"imageMaxWidth\",void 0),a([d.property()],r.prototype,\"imageTransparency\",void 0),a([d.property({json:{read:!1,write:!1}})],r.prototype,\"labelsVisible\",void 0),a([d.property({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:function(){return{enabled:!1}}}}})],r.prototype,\"isReference\",void 0),a([d.property({type:[\"ArcGISMapServiceLayer\"]})],r.prototype,\"operationalLayerType\",void 0),a([d.property()],r.prototype,\"sourceJSON\",void 0),a([d.property()],r.prototype,\"sublayers\",void 0),a([d.property({type:[\"show\",\"hide\",\"hide-children\"]})],r.prototype,\"listMode\",void 0),a([d.property({json:{read:!1},readOnly:!0,value:\"map-image\"})],r.prototype,\"type\",void 0),a([d.property(I.url)],r.prototype,\"url\",void 0),r=a([d.subclass(\"esri.layers.MapImageLayer\")],r)}(d.declared(O.TemporalLayer(b.ScaleRangeLayer(x.RefreshableLayer(w.SublayersOwner(g.ArcGISMapService(v.ArcGISService(S.OperationalLayer(f.PortalLayer(u.MultiOriginJSONMixin(h)))))))))))});","// COPYRIGHT © 2019 Esri\n//\n// All rights reserved under the copyright laws of the United States\n// and applicable international laws, treaties, and conventions.\n//\n// This material is licensed for use under the Esri Master License\n// Agreement (MLA), and is bound by the terms of that agreement.\n// You may redistribute and use this code without modification,\n// provided you adhere to the terms of the MLA and include this\n// copyright notice.\n//\n// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english\n//\n// For additional information, contact:\n// Environmental Systems Research Institute, Inc.\n// Attn: Contracts and Legal Services Department\n// 380 New York Street\n// Redlands, California, USA 92373\n// USA\n//\n// email: contracts@esri.com\n//\n// See http://js.arcgis.com/4.14/esri/copyright.txt for details.\n\ndefine([\"require\",\"exports\",\"../../core/tsSupport/assignHelper\",\"../../core/tsSupport/declareExtendsHelper\",\"../../core/tsSupport/decorateHelper\",\"../../core/Accessor\",\"../../core/accessorSupport/decorators\",\"./sublayerUtils\",\"./timeUtils\",\"../../views/View\"],function(e,r,t,a,i,n,s,l,y,o){Object.defineProperty(r,\"__esModule\",{value:!0});var u={visible:\"visibleSublayers\",definitionExpression:\"layerDefs\",labelingInfo:\"hasDynamicLayers\",labelsVisible:\"hasDynamicLayers\",opacity:\"hasDynamicLayers\",minScale:\"visibleSublayers\",maxScale:\"visibleSublayers\",renderer:\"hasDynamicLayers\",source:\"hasDynamicLayers\"},p=function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r._scale=null,r.view=null,r}return a(r,e),Object.defineProperty(r.prototype,\"dynamicLayers\",{get:function(){if(!this.hasDynamicLayers)return null;var e=this.visibleSublayers.map(function(e){return e.toExportImageJSON()});return e.length?JSON.stringify(e):null},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,\"hasDynamicLayers\",{get:function(){return this.layer&&l.isExportDynamic(this.visibleSublayers,this.layer.serviceSublayers,this.layer)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,\"layer\",{set:function(e){var r=this;this._get(\"layer\")!==e&&(this._set(\"layer\",e),this._layerHandles&&(this._layerHandles.forEach(function(e){return e.remove()}),this._layerHandles.length=0),e&&(this._layerHandles=[e.allSublayers.on(\"change\",function(){return r.notifyChange(\"visibleSublayers\")}),e.on(\"sublayer-update\",function(e){return r.notifyChange(u[e.propertyName])})]))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,\"layers\",{get:function(){var e=this.visibleSublayers;return e?e.length?\"show:\"+e.map(function(e){return e.id}).join(\",\"):\"show:-1\":null},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,\"layerDefs\",{get:function(){var e=this.visibleSublayers.filter(function(e){return null!=e.definitionExpression});return e.length?JSON.stringify(e.reduce(function(e,r){return e[r.id]=r.definitionExpression,e},{})):null},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,\"scale\",{get:function(){return null!=this._scale?this._scale:this.view&&this.view.scale||0},set:function(e){this.view||(this._scale=e,this.notifyChange(\"scale\"))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,\"version\",{get:function(){var e=this;e.layers,e.layerDefs,e.dynamicLayers,e.timeExtent;var r=e.layer;return r&&(r.dpi,r.imageFormat,r.imageTransparency,r.gdbVersion),(this._get(\"version\")||0)+1},set:function(e){this._set(\"version\",e)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,\"visibleSublayers\",{get:function(){var e=this,r=[];if(!this.layer)return r;var t=this.layer.sublayers,a=function(t){var i=e.scale,n=0===i,s=0===t.minScale||i<=t.minScale,l=0===t.maxScale||i>=t.maxScale;t.visible&&(n||s&&l)&&(t.sublayers?t.sublayers.forEach(a):r.unshift(t))};t&&t.forEach(a);var i=this._get(\"visibleSublayers\");return!i||i.length!==r.length||i.some(function(e,t){return r[t]!==e})?r:i},enumerable:!0,configurable:!0}),r.prototype.toJSON=function(){var e=this.layer,r={dpi:e.dpi,format:e.imageFormat,transparent:e.imageTransparency,gdbVersion:e.gdbVersion||null};return this.hasDynamicLayers&&this.dynamicLayers?r.dynamicLayers=this.dynamicLayers:r=t({},r,{layers:this.layers,layerDefs:this.layerDefs}),r},i([s.property({readOnly:!0,dependsOn:[\"hasDynamicLayers\",\"visibleSublayers\"]})],r.prototype,\"dynamicLayers\",null),i([s.property({readOnly:!0,dependsOn:[\"visibleSublayers\",\"layer.serviceSublayers\",\"layer.capabilities\"]})],r.prototype,\"hasDynamicLayers\",null),i([s.property()],r.prototype,\"layer\",null),i([s.property({readOnly:!0,dependsOn:[\"visibleSublayers\"]})],r.prototype,\"layers\",null),i([s.property({readOnly:!0,dependsOn:[\"visibleSublayers\"]})],r.prototype,\"layerDefs\",null),i([s.property({type:Number,dependsOn:[\"view.scale\"]})],r.prototype,\"scale\",null),i([s.property(y.combinedViewLayerTimeExtentProperty)],r.prototype,\"timeExtent\",void 0),i([s.property({dependsOn:[\"layers\",\"layerDefs\",\"dynamicLayers\",\"layer.dpi\",\"layer.imageFormat\",\"layer.imageTransparency\",\"layer.gdbVersion\",\"timeExtent\"]})],r.prototype,\"version\",null),i([s.property({type:o})],r.prototype,\"view\",void 0),i([s.property({readOnly:!0,dependsOn:[\"layer.sublayers\",\"scale\"]})],r.prototype,\"visibleSublayers\",null),r=i([s.subclass(\"esri.layers.mixins.ExportImageParameters\")],r)}(s.declared(n));r.ExportImageParameters=p});"],"sourceRoot":"webpack:///"}
{"version":3,"sources":["./node_modules/arcgis-js-api/layers/support/MapImage.js","./node_modules/arcgis-js-api/renderers/visualVariables/support/sizeVariableUtils.js","./node_modules/arcgis-js-api/renderers/visualVariables/support/visualVariableUtils.js","./node_modules/arcgis-js-api/tasks/Geoprocessor.js","./node_modules/arcgis-js-api/tasks/PrintTask.js","./node_modules/arcgis-js-api/tasks/support/DataFile.js","./node_modules/arcgis-js-api/tasks/support/GPMessage.js","./node_modules/arcgis-js-api/tasks/support/JobInfo.js","./node_modules/arcgis-js-api/tasks/support/LinearUnit.js","./node_modules/arcgis-js-api/tasks/support/ParameterValue.js","./node_modules/arcgis-js-api/tasks/support/PrintTemplate.js","./node_modules/arcgis-js-api/tasks/support/QuantizationParameters.js","./node_modules/arcgis-js-api/tasks/support/RasterData.js","./node_modules/arcgis-js-api/tasks/support/fileFormat.js","./node_modules/arcgis-js-api/tasks/support/layoutTemplate.js","./node_modules/arcgis-js-api/tasks/support/printTaskUtils.js","./node_modules/dojox/gfx/_base.js","./node_modules/dojox/gfx/arc.js","./node_modules/dojox/gfx/bezierutils.js","./node_modules/dojox/gfx/canvas.js","./node_modules/dojox/gfx/decompose.js","./node_modules/dojox/gfx/matrix.js","./node_modules/dojox/gfx/path.js","./node_modules/dojox/gfx/shape.js"],"names":[],"mappings":"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ACA;AACA;AACA;AACA,iBAAiB;AACjB;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C;AAC/C;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,UAAU;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,UAAU;AACV,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;;AAEA,+DAA+D,MAAgB,GAAG,SAAe;AACjG;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,uBAAuB,2BAA2B,EAAE,0BAA0B;AAC9E;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,uBAAuB,2BAA2B,EAAE,0BAA0B;AAC9E;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,mCAAmC,QAAQ;AAC3C;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,wBAAwB,2BAA2B,EAAE,0BAA0B;AAC/E;AACA,KAAK,4BAA4B,GAAG;AACpC;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,wBAAwB,2BAA2B,EAAE,0BAA0B;AAC/E;AACA,KAAK,4BAA4B,GAAG;AACpC;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,8DAA8D;AAC9D,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA,qCAAqC;AACrC,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,oGAAoG;AACpG,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,OAAO;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ,eAAe;AACf,GAAG;AACH;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,4DAA4D;AAC5D,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,UAAU;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B,GAAG;;AAEH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,UAAU;AACV,CAAC;AAAA,oGAAC;;;;;;;;;;;;AC//BF,iGAAO,CAAC,uEAAS,EAAE,+EAAiB,EAAE,yEAAU,CAAC,mCAC/C;AACF;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,UAAU;AACV,QAAQ,kBAAkB;AAC1B,QAAQ,kBAAkB;AAC1B;AACA,QAAQ;AACR;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,iBAAiB,QAAQ;AACzB;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC;AAClC,aAAa,gBAAgB;AAC7B;AACA;AACA,IAAI;AACJ;AACA;;AAEA;AACA;AACA;AACA,yBAAyB,WAAW;AACpC;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;;AAEA;AACA,CAAC;AAAA,oGAAC;;;;;;;;;;;;AC9IF,iGAAO;AACP,CAAC,uEAAS;AACV,CAAC,mCAAE;;AAEH,8BAA8B;AAC9B;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,gBAAgB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,gBAAgB,qBAAqB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,CAAC;AAAA,oGAAC,C;;;;;;;;;;;AC1KF,iGAAO,CAAC,uEAAS,EAAE,+EAAiB,EAAE,iFAAkB,EAAE,qFAAoB,EAAE,mFAAmB,EAAE,mFAAmB;AACxH,EAAE,iEAAU,EAAE,uEAAS,EAAE,qEAAQ,EAAE,mEAAO,EAAE,yEAAU,EAAE,+EAAa,EAAE,mFAAe,CAAC,mCACvF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,cAAc,iBAAiB;AAC/B;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,gBAAgB,cAAc;AAC9B,MAAM;AACN;AACA;AACA,KAAK;AACL,eAAe,cAAc;AAC7B;AACA,IAAI;AACJ;AACA;AACA,GAAG;AACH,6CAA6C;;AAE7C;AACA,6BAA6B,aAAa,EAAE;AAC5C,qBAAqB;AACrB,wBAAwB;AACxB,2BAA2B;;AAE3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB;AACnB;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA,iCAAiC,eAAe;AAChD,2BAA2B;AAC3B;AACA;AACA;AACA,oCAAoC,IAAI;AACxC,2BAA2B;AAC3B;AACA;AACA;AACA;AACA,2BAA2B;AAC3B;AACA;AACA;AACA;AACA,2BAA2B;AAC3B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA,IAAI;AACJ;AACA,oBAAoB;AACpB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,eAAe;AAC9B;AACA;AACA;AACA,gBAAgB,eAAe;AAC/B;AACA,qBAAqB,WAAW;AAChC;AACA,gBAAgB,eAAe;AAC/B;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA,GAAG;;AAEH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,0BAA0B;AAC3C;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,EAAE;;;;AAIF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA,iBAAiB,SAAS;AAC1B;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,yBAAyB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,cAAc;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,aAAa,cAAc;AAC3B;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,iBAAiB,cAAc;AAC/B;AACA,gBAAgB,gBAAgB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,yDAAyD;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wDAAwD,IAAI,GAAG,IAAI;AACnE;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA,KAAK,KAAK;AACV;AACA,aAAa,cAAc;AAC3B;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,kBAAkB,cAAc;AAChC;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,iBAAiB,cAAc;AAC/B;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA,EAAE;AACF;;AAEA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,IAAI;AACJ;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,iBAAiB,cAAc;AAC/B;AACA;AACA,GAAG;AACH,mDAAmD;AACnD;AACA;AACA,iBAAiB,cAAc;AAC/B;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,iBAAiB,iBAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA,iBAAiB,iBAAiB;AAClC;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,iBAAiB,iBAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,iBAAiB,iBAAiB;AAClC;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,iBAAiB,iBAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,iBAAiB,iBAAiB;AAClC;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,iBAAiB,iBAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,iBAAiB,iBAAiB;AAClC;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,iBAAiB,iBAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,iBAAiB,iBAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,iBAAiB,iBAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,iBAAiB,iBAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,iBAAiB,iBAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,iBAAiB,iBAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,iBAAiB,iBAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,iBAAiB,iBAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,iBAAiB,iBAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA,mBAAmB,mCAAmC;AACtD;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,uCAAuC;AACvC;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C;AAC3C,4CAA4C;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf,GAAG;AACH;AACA;AACA;AACA,0BAA0B,wDAAwD,QAAQ;AAC1F,GAAG;AACH;AACA;AACA;AACA,2DAA2D,QAAQ;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,0BAA0B;AAC3C;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,6BAA6B,aAAa,EAAE;AAC5C,wBAAwB;AACxB,2BAA2B;AAC3B;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,uCAAuC;AACvC,wCAAwC;;AAExC;AACA;AACA;AACA;AACA,WAAW;AACX;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,CAAC;AAAA,oGAAC;;;;;;;;;;;;ACxxCF,iGAAO,CAAC,uEAAS,EAAE,+EAAiB,EAAE,yEAAU,CAAC,mCAC/C;AACF;AACA;AACA;AACA,+DAA+D;AAC/D;;AAEA;AACA;AACA;AACA;AACA,aAAa;AACb,GAAG;AACH,aAAa;AACb;AACA,oBAAoB;AACpB,yCAAyC;AACzC;;AAEA;AACA;AACA;AACA;AACA,wBAAwB,iCAAiC,EAAE;AAC3D;;AAEA;AACA,2EAA2E;AAC3E;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,SAAS;AACpC,2BAA2B,SAAS;AACpC,2BAA2B,SAAS;AACpC,2BAA2B,SAAS;AACpC,UAAU;AACV;AACA;AACA,aAAa,eAAe;AAC5B,aAAa;AACb;AACA;;AAEA;AACA;AACA,+CAA+C;AAC/C;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;;AAEA;AACA;AACA,+CAA+C;AAC/C;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,8BAA8B,mBAAmB,EAAE;AACnD;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA,wBAAwB,mEAAmE;AAC3F,wBAAwB,mEAAmE;AAC3F;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,mBAAmB,EAAE;AAClD;AACA,CAAC;AAAA,oGAAC;;;;;;;;;;;;AC1IF,iGAAO,CAAC,uEAAS,CAAC,+EAAiB,CAAC,mCAClC;AACF;;AAEA;AACA;AACA;AACA;AACA;AACA,gCAAgC,+BAA+B;;AAE/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA,mBAAmB,gBAAgB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;;AAEA;AACA,0BAA0B,yCAAyC;;AAEnE;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,4BAA4B,OAAO;;AAEnC;AACA;AACA,4BAA4B,OAAO;;AAEnC;AACA;AACA,4BAA4B,eAAe;;AAE3C;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,aAAa,EAAE;AAC1C;AACA;AACA,0BAA0B,iBAAiB,EAAE;AAC7C,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,aAAa,EAAE;AAC1C;AACA;AACA,2BAA2B,aAAa,EAAE;AAC1C;AACA,0BAA0B,iBAAiB,EAAE;AAC7C,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,4BAA4B,EAAE;AACxD,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC;AACxC,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,oBAAoB,EAAE;AAChD,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC;AACvC,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,oBAAoB,EAAE;AAChD,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC;AACvC,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,yDAAyD,EAAE;AACrF,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,yCAAyC,EAAE;AACrE,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2EAA2E;AAC3E,GAAG;;AAEH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,mHAAmH;AACnH,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,YAAY;AACZ,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,4FAA4F;AACvG,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC;AACrC;AACA,wCAAwC;AACxC,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,6B;AACnB;AACA,YAAY,8DAA8D;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,sBAAsB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ,GAAG;;AAEH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qEAAqE;AACrE,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C;AAC7C;AACA;AACA,2CAA2C;AAC3C;AACA,iDAAiD;AACjD;AACA,4CAA4C;AAC5C,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C;AAC9C;AACA,iDAAiD;AACjD,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD;AAChD;AACA,mDAAmD;AACnD,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C;AAC7C;AACA,gDAAgD;AAChD,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C;AAC/C;AACA,kDAAkD;AAClD,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C;AAC7C;AACA,gDAAgD;AAChD,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C;AAC/C;AACA,kDAAkD;AAClD;;AAEA;;AAEA,EAAE;AACF;AACA;;AAEA;AACA,CAAC;AAAA,oGAAC;;;;;;;;;;;;;;AClfF,iGAAO,CAAC,uEAAS,EAAE,+EAAiB,CAAC,qFAAoB,EAAE,yEAAU,EAAE,uEAAS,CAAC,mCAChF;;AAED;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf,GAAG;AACH;AACA;AACA;AACA;AACA,wBAAwB;AACxB,GAAG;;AAEH;AACA;AACA,iCAAiC,oBAAoB;AACrD;AACA,+CAA+C,oGAAoG,QAAQ;AAC3J,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA,6CAA6C,SAAS;AACtD;AACA;AACA;AACA;AACA;AACA,KAAK,eAAe;AACpB,KAAK,eAAe;AACpB,KAAK,eAAe;AACpB,KAAK;AACL;AACA,qBAAqB;AACrB,GAAG;;AAEH;AACA;AACA;AACA;AACA,8CAA8C;AAC9C,GAAG;;AAEH;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,cAAc,WAAW;AACzB;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ,iBAAiB;AACjB;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA,IAAI;AACJ,+BAA+B,OAAO;AACtC;AACA;AACA;AACA,GAAG;;AAEH;AACA,mBAAmB,2DAA2D;;AAE9E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA,KAAK;AACL,gBAAgB;AAChB;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,iBAAiB;AAClC;AACA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,eAAe;AACf,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,OAAO;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,6DAA6D,eAAe;;AAE5E;AACA;AACA;AACA;AACA;AACA,eAAe;AACf,GAAG;;AAEH;AACA;AACA,EAAE;;AAEF;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,oBAAoB;AACpB,GAAG;AACH;AACA;AACA;AACA;AACA,kCAAkC,cAAc;AAChD;AACA,eAAe;AACf,GAAG;AACH;AACA;AACA;AACA,yBAAyB;AACzB,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA,EAAE;;AAEF;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,CAAC;AAAA,oGAAC;;;;;;;;;;;;AC7dF,iGAAO,CAAC,uEAAS,EAAE,+EAAiB,EAAE,qFAAoB,EAAE,mFAAmB,EAAE,iFAAkB;AACnG,CAAC,+DAAS,EAAE,iFAAkB,EAAE,qFAAoB,EAAE,iFAAkB,EAAE,yEAAU,EAAE,mCACrF;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB;AACvB,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB,GAAG;AACH;AACA;AACA;AACA,sBAAsB;AACtB,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB,GAAG;AACH;AACA;AACA;AACA;AACA,2BAA2B;AAC3B,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA,uBAAuB;AACvB,GAAG;;AAEH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,gDAAgD;AAC1D,UAAU,2CAA2C;AACrD,UAAU,aAAa;AACvB,UAAU,SAAS;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,8BAA8B,WAAW,6BAA6B;AACnG,6BAA6B,yCAAyC,WAAW,0BAA0B;AAC3G,6BAA6B,wCAAwC,WAAW,0BAA0B;AAC1G,6BAA6B,wCAAwC,WAAW,sCAAsC;AACtH,6BAA6B,0CAA0C,WAAW,8CAA8C;;AAEhI;AACA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,eAAe;AACf,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA,eAAe;AACf,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA,eAAe;AACf,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,iCAAiC;AACjC,GAAG;;AAEH;AACA;AACA;;AAEA;AACA,eAAe;AACf,GAAG;;AAEH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA,eAAe;AACf,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA,GAAG;;AAEH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mEAAmE;AACnE,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mEAAmE;AACnE,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mEAAmE;AACnE,GAAG;;AAEH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C;AAC3C,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA,EAAE;;AAEF;AACA;AACA;AACA;;AAEA;AACA,GAAG;;AAEH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,sGAAsG;AAC5H,sB;AACA,+FAA+F,GAAG;AAClG;AACA;AACA,iB;AACA,kFAAkF,E;AAClF,iB;AACA,wFAAwF,GAAG;AAC3F;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wDAAwD;AACxD,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,0BAA0B;AAC3C;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,0BAA0B;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,0BAA0B;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,iBAAiB,0BAA0B;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,OAAO,YAAY,EAAE,EAAE;AAChE;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,uBAAuB;AACvB,GAAG;AACH;AACA;AACA;AACA,eAAe;AACf,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,KAAK;AACL;AACA;AACA,EAAE;AACF;;AAEA;AACA;AACA;AACA,+BAA+B;AAC/B;AACA;AACA,qCAAqC,WAAW;AAChD,EAAE;;AAEF;AACA;AACA,mBAAmB;AACnB;AACA;AACA,qCAAqC,oCAAoC;AACzE,EAAE;AACF;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,qBAAqB;AACrB;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA,oBAAoB;AACpB;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA,oBAAoB;AACpB;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,eAAe;AAC/C;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,eAAe;AACf,GAAG;AACH;AACA;AACA,qCAAqC;AACrC;AACA;AACA;AACA,kBAAkB,OAAO;AACzB,kBAAkB,qBAAqB;AACvC;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB,kBAAkB,OAAO;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,qBAAqB;AACrB,GAAG;AACH;AACA;AACA;AACA,eAAe;AACf,GAAG;AACH;AACA;AACA;AACA,eAAe;AACf;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,yBAAyB;AACzB,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA,gDAAgD;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,qCAAqC;AACrC,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,0CAA0C;AAC1C,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,gDAAgD;AAChD,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,8CAA8C;AAC9C,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,0CAA0C;AAC1C,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD;AAChD,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,4CAA4C;AAC5C,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,0CAA0C;AAC1C,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,0CAA0C;AAC1C,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,0CAA0C,gBAAgB;AAC1D,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,eAAe;AACf;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,CAAC;AAAA,oGAAC","file":"77.js","sourcesContent":["// COPYRIGHT © 2019 Esri\n//\n// All rights reserved under the copyright laws of the United States\n// and applicable international laws, treaties, and conventions.\n//\n// This material is licensed for use under the Esri Master License\n// Agreement (MLA), and is bound by the terms of that agreement.\n// You may redistribute and use this code without modification,\n// provided you adhere to the terms of the MLA and include this\n// copyright notice.\n//\n// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english\n//\n// For additional information, contact:\n// Environmental Systems Research Institute, Inc.\n// Attn: Contracts and Legal Services Department\n// 380 New York Street\n// Redlands, California, USA 92373\n// USA\n//\n// email: contracts@esri.com\n//\n// See http://js.arcgis.com/4.14/esri/copyright.txt for details.\n\ndefine([\"require\",\"exports\",\"../../core/tsSupport/declareExtendsHelper\",\"../../core/tsSupport/decorateHelper\",\"../../core/tsSupport/paramHelper\",\"../../core/JSONSupport\",\"../../core/accessorSupport/decorators\",\"../../geometry/Extent\"],function(t,e,r,o,p,i,l,n){return function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.extent=null,e.height=null,e.href=null,e.opacity=1,e.rotation=0,e.scale=null,e.visible=!0,e.width=null,e}return r(e,t),o([l.property({type:n})],e.prototype,\"extent\",void 0),o([l.property()],e.prototype,\"height\",void 0),o([l.property()],e.prototype,\"href\",void 0),o([l.property()],e.prototype,\"opacity\",void 0),o([l.property()],e.prototype,\"rotation\",void 0),o([l.property()],e.prototype,\"scale\",void 0),o([l.property()],e.prototype,\"visible\",void 0),o([l.property()],e.prototype,\"width\",void 0),e=o([l.subclass(\"esri.layer.support.MapImage\")],e)}(l.declared(i.JSONSupport))});","// COPYRIGHT © 2019 Esri\n//\n// All rights reserved under the copyright laws of the United States\n// and applicable international laws, treaties, and conventions.\n//\n// This material is licensed for use under the Esri Master License\n// Agreement (MLA), and is bound by the terms of that agreement.\n// You may redistribute and use this code without modification,\n// provided you adhere to the terms of the MLA and include this\n// copyright notice.\n//\n// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english\n//\n// For additional information, contact:\n// Environmental Systems Research Institute, Inc.\n// Attn: Contracts and Legal Services Department\n// 380 New York Street\n// Redlands, California, USA 92373\n// USA\n//\n// email: contracts@esri.com\n//\n// See http://js.arcgis.com/4.14/esri/copyright.txt for details.\n\ndefine([\"require\",\"exports\"],function(e,n){function i(e){return e&&\"esri.renderers.visualVariables.SizeVariable\"===e.declaredClass}function a(e){return null!=e&&!isNaN(e)&&isFinite(e)}function l(e){return e.valueExpression?\"expression\":e.field&&\"string\"==typeof e.field?\"field\":\"unknown\"}function r(e,n){var i=n||l(e),a=e.valueUnit||\"unknown\";return\"unknown\"===i?\"constant\":e.stops?\"stops\":null!=e.minSize&&null!=e.maxSize&&null!=e.minDataValue&&null!=e.maxDataValue?\"clamped-linear\":\"unknown\"===a?null!=e.minSize&&null!=e.minDataValue?e.minSize&&e.minDataValue?\"proportional\":\"additive\":\"identity\":\"real-world-size\"}Object.defineProperty(n,\"__esModule\",{value:!0}),n.isSizeVariable=i,n.isValidNumber=a,n.getInputValueType=l,n.getTransformationType=r});","// COPYRIGHT © 2019 Esri\n//\n// All rights reserved under the copyright laws of the United States\n// and applicable international laws, treaties, and conventions.\n//\n// This material is licensed for use under the Esri Master License\n// Agreement (MLA), and is bound by the terms of that agreement.\n// You may redistribute and use this code without modification,\n// provided you adhere to the terms of the MLA and include this\n// copyright notice.\n//\n// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english\n//\n// For additional information, contact:\n// Environmental Systems Research Institute, Inc.\n// Attn: Contracts and Legal Services Department\n// 380 New York Street\n// Redlands, California, USA 92373\n// USA\n//\n// email: contracts@esri.com\n//\n// See http://js.arcgis.com/4.14/esri/copyright.txt for details.\n\ndefine([\"require\",\"exports\",\"../../../Color\",\"../../../Graphic\",\"../../../core/Logger\",\"../../../core/maybe\",\"../../support/utils\",\"./sizeVariableUtils\"],function(e,a,r,i,n,t,s,l){function o(e,a,i){var n=\"visualVariables\"in e&&e.visualVariables?e.visualVariables.filter(function(e){return\"color\"===e.type})[0]:e;if(n){if(\"esri.renderers.visualVariables.ColorVariable\"!==n.declaredClass)return void M.warn(\"The visualVariable should be an instance of esri.renderers.visualVariables.ColorVariable\");var s=\"number\"==typeof a,l=s?null:a,o=l&&l.attributes,u=s?a:null,c=n.field,v=n.cache,f=v.ipData,d=v.hasExpression,p=n.cache.compiledFunc;if(!c&&!d){var b=n.stops;return b&&b[0]&&b[0].color}if(\"number\"!=typeof u)if(d){if(!t.isSome(i)||!t.isSome(i.arcade))return void M.error(\"Use of arcade expressions requires an arcade context\");var m={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},h=i.arcade.arcadeUtils,V=h.getViewInfo(m),x=h.createExecContext(l,V);if(!p){var g=h.createSyntaxTree(n.valueExpression);p=h.createFunction(g),n.cache.compiledFunc=p}u=h.executeFunction(p,x)}else o&&(u=o[c]);var y=n.normalizationField,S=o?parseFloat(o[y]):void 0;if(null!=u&&(!y||s||!isNaN(S)&&0!==S)){isNaN(S)||s||(u/=S);var z=N(u,f);if(z){var w=z[0],F=z[1],E=w===F?n.stops[w].color:r.blendColors(n.stops[w].color,n.stops[F].color,z[2],t.isSome(i)?i.color:void 0);return new r(E)}}}}function u(e,a,r){var i=\"visualVariables\"in e&&e.visualVariables?e.visualVariables.filter(function(e){return\"opacity\"===e.type})[0]:e;if(i){if(\"esri.renderers.visualVariables.OpacityVariable\"!==i.declaredClass)return void M.warn(\"The visualVariable should be an instance of esri.renderers.visualVariables.OpacityVariable\");var n=\"number\"==typeof a,s=n?null:a,l=s&&s.attributes,o=n?a:null,u=i.field,c=i.cache,v=c.ipData,f=c.hasExpression,d=i.cache.compiledFunc;if(!u&&!f){var p=i.stops;return p&&p[0]&&p[0].opacity}if(\"number\"!=typeof o)if(f){if(t.isNone(r)||t.isNone(r.arcade))return void M.error(\"Use of arcade expressions requires an arcade context\");var b={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},m=r.arcade.arcadeUtils,h=m.getViewInfo(b),V=m.createExecContext(s,h);if(!d){var x=m.createSyntaxTree(i.valueExpression);d=m.createFunction(x),i.cache.compiledFunc=d}o=m.executeFunction(d,V)}else l&&(o=l[u]);var g=i.normalizationField,y=l?parseFloat(l[g]):void 0;if(null!=o&&(!g||n||!isNaN(y)&&0!==y)){isNaN(y)||n||(o/=y);var S=N(o,v);if(S){var z=S[0],w=S[1];if(z===w)return i.stops[z].opacity;var F=i.stops[z].opacity;return F+(i.stops[w].opacity-F)*S[2]}}}}function c(e,a,r){var i=\"visualVariables\"in e&&e.visualVariables?e.visualVariables.filter(function(e){return\"rotation\"===e.type})[0]:e;if(i){if(\"esri.renderers.visualVariables.RotationVariable\"!==i.declaredClass)return void M.warn(\"The visualVariable should be an instance of esri.renderers.visualVariables.RotationVariable\");var n=i.axis||\"heading\",s=\"heading\"===n&&\"arithmetic\"===i.rotationType?90:0,l=\"heading\"===n&&\"arithmetic\"===i.rotationType?-1:1,o=\"number\"==typeof a?null:a,u=o&&o.attributes,c=i.field,v=i.cache.hasExpression,f=i.cache.compiledFunc,d=0;if(!c&&!v)return d;if(v){if(t.isNone(r)||t.isNone(r.arcade))return void M.error(\"Use of arcade expressions requires an arcade context\");var p={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},b=r.arcade.arcadeUtils,m=b.getViewInfo(p),h=b.createExecContext(o,m);if(!f){var V=b.createSyntaxTree(i.valueExpression);f=b.createFunction(V),i.cache.compiledFunc=f}d=b.executeFunction(f,h)}else u&&(d=u[c]||0);return d=\"number\"!=typeof d||isNaN(d)?null:s+l*d}}function v(e,a,r){var i=\"number\"==typeof a,n=i?null:a,s=n&&n.attributes,o=i?a:null,u=e.cache.isScaleDriven,c=e.cache.compiledFunc;if(u){var v=t.isSome(r)?r.scale:void 0,d=t.isSome(r)?r.view:void 0;o=null==v||d&&\"3d\"===d.type?f(e):v}else if(!i)switch(e.inputValueType){case\"expression\":if(t.isNone(r)||t.isNone(r.arcade))return void M.error(\"Use of arcade expressions requires an arcade context\");var p={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},b=r.arcade.arcadeUtils,m=b.getViewInfo(p),h=b.createExecContext(n,m);if(!c){var V=b.createSyntaxTree(e.valueExpression);c=b.createFunction(V),e.cache.compiledFunc=c}o=b.executeFunction(c,h);break;case\"field\":s&&(o=s[e.field]);break;case\"unknown\":o=null}if(!l.isValidNumber(o))return null;if(i||!e.normalizationField)return o;var x=s?parseFloat(s[e.normalizationField]):null;return l.isValidNumber(x)&&0!==x?o/x:null}function f(e){var a=null,r=null,i=e.stops;return i?(a=i[0].value,r=i[i.length-1].value):(a=e.minDataValue||0,r=e.maxDataValue||0),(a+r)/2}function d(e,a,r){var i=\"visualVariables\"in e&&e.visualVariables?e.visualVariables.filter(function(e){return\"size\"===e.type})[0]:e;if(i){if(\"esri.renderers.visualVariables.SizeVariable\"!==i.declaredClass)return void M.warn(\"The visualVariable should be an instance of esri.renderers.visualVariables.SizeVariable\");var n=v(i,a,r),t=z(n,i,a,r,i.cache.ipData);return null===t||void 0===t||isNaN(t)?0:t}}function p(e,a,r){return null==e?null:l.isSizeVariable(e)?d(e,a,r):l.isValidNumber(e)?e:null}function b(e,a,r){return l.isValidNumber(r)&&e>r?r:l.isValidNumber(a)&&e<a?a:e}function m(e,a,r,i){return e+(p(a.minSize,r,i)||a.minDataValue)}function h(e,a,r){var i=e.stops,n=i&&i.length&&i[0].size;return null==n&&(n=e.minSize),p(n,a,r)}function V(e,a,r,i){var n=(e-a.minDataValue)/(a.maxDataValue-a.minDataValue),s=p(a.minSize,r,i),l=p(a.maxSize,r,i),o=t.isSome(i)?i.shape:void 0;if(e<=a.minDataValue)return s;if(e>=a.maxDataValue)return l;if(\"area\"===a.scaleBy&&o){var u=\"circle\"===o,c=u?D*Math.pow(s/2,2):s*s,v=u?D*Math.pow(l/2,2):l*l,f=c+n*(v-c);return u?2*Math.sqrt(f/D):Math.sqrt(f)}return s+n*(l-s)}function x(e,a,r,i){var n=t.isSome(i)?i.shape:void 0,s=e/a.minDataValue,l=p(a.minSize,r,i),o=p(a.maxSize,r,i),u=null;return u=\"circle\"===n?2*Math.sqrt(s*Math.pow(l/2,2)):\"square\"===n||\"diamond\"===n||\"image\"===n?Math.sqrt(s*Math.pow(l,2)):s*l,b(u,l,o)}function g(e,a,r,i,n){var t=N(e,n),s=t[0],l=t[1],o=t[2];if(s===l)return p(a.stops[s].size,r,i);var u=p(a.stops[s].size,r,i);return u+(p(a.stops[l].size,r,i)-u)*o}function y(e,a,r,i){var n=t.isSome(i)&&i.resolution?i.resolution:1,l=n*s.meterIn[a.valueUnit],o=p(a.minSize,r,i),u=p(a.maxSize,r,i),c=a.valueRepresentation,v=null;return v=\"area\"===c?2*Math.sqrt(e/D)/l:\"radius\"===c||\"distance\"===c?2*e/l:e/l,b(v,o,u)}function S(e){return e}function z(e,a,r,i,n){switch(a.transformationType){case\"additive\":return m(e,a,r,i);case\"constant\":return h(a,r,i);case\"clamped-linear\":return V(e,a,r,i);case\"proportional\":return x(e,a,r,i);case\"stops\":return g(e,a,r,i,n);case\"real-world-size\":return y(e,a,r,i);case\"identity\":return S(e);case\"unknown\":return null}}function w(e,a,r){var i=e.cache.isScaleDriven,n=r&&\"3d\"===r.type;if(!(i&&n||a))return null;var t={scale:a,view:r},s=p(e.minSize,E,t),l=p(e.maxSize,E,t);if(null!=s||null!=l){if(s>l){var o=l;l=s,s=o}return{minSize:s,maxSize:l}}}function F(e,a,r){if(e.visualVariables){for(var i=[],n=[],t=[],s=[],l=[],v=0,f=e.visualVariables;v<f.length;v++){var p=f[v];switch(p.type){case\"color\":n.push(p);break;case\"opacity\":t.push(p);break;case\"rotation\":l.push(p);break;case\"size\":s.push(p)}}return n.forEach(function(e){var n=o(e,a,r);i.push({variable:e,value:n})}),t.forEach(function(e){var n=u(e,a,r);i.push({variable:e,value:n})}),l.forEach(function(e){var n=c(e,a,r);i.push({variable:e,value:n})}),s.forEach(function(e){var n=d(e,a,r);i.push({variable:e,value:n})}),i.filter(function(e){return null!=e.value})}}function N(e,a){if(a){var r=0,i=a.length-1;return a.some(function(a,n){return e<a?(i=n,!0):(r=n,!1)}),[r,i,(e-a[r])/(a[i]-a[r])]}}Object.defineProperty(a,\"__esModule\",{value:!0});var M=n.getLogger(\"esri.renderers.visualVariables.support.visualVariableUtils\"),E=new i,D=Math.PI;a.getColor=o,a.getOpacity=u,a.getRotationAngle=c,a.getSize=d,a.getSizeFromNumberOrVariable=p,a.getSizeForValue=z,a.getSizeRangeAtScale=w,a.getVisualVariableValues=F});","// COPYRIGHT © 2019 Esri\n//\n// All rights reserved under the copyright laws of the United States\n// and applicable international laws, treaties, and conventions.\n//\n// This material is licensed for use under the Esri Master License\n// Agreement (MLA), and is bound by the terms of that agreement.\n// You may redistribute and use this code without modification,\n// provided you adhere to the terms of the MLA and include this\n// copyright notice.\n//\n// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english\n//\n// For additional information, contact:\n// Environmental Systems Research Institute, Inc.\n// Attn: Contracts and Legal Services Department\n// 380 New York Street\n// Redlands, California, USA 92373\n// USA\n//\n// email: contracts@esri.com\n//\n// See http://js.arcgis.com/4.14/esri/copyright.txt for details.\n\ndefine([\"require\",\"exports\",\"../core/tsSupport/assignHelper\",\"../core/tsSupport/declareExtendsHelper\",\"../core/tsSupport/decorateHelper\",\"../core/tsSupport/generatorHelper\",\"../core/tsSupport/awaiterHelper\",\"../request\",\"../core/compilerUtils\",\"../core/promiseUtils\",\"../core/accessorSupport/decorators\",\"../geometry/Extent\",\"../geometry/SpatialReference\",\"../geometry/support/normalizeUtils\",\"../layers/support/Field\",\"../layers/support/MapImage\",\"./Task\",\"./support/DataFile\",\"./support/FeatureSet\",\"./support/GPMessage\",\"./support/JobInfo\",\"./support/LinearUnit\",\"./support/ParameterValue\",\"./support/RasterData\"],function(e,t,r,a,o,n,u,s,i,c,l,p,f,v,d,m,h,b,y,S,G,g,P,R){return function(t){function h(e){var r=t.call(this,e)||this;return r._timers=new Map,r.outSpatialReference=null,r.processExtent=null,r.processSpatialReference=null,r.returnFeatureCollection=!1,r.returnM=!1,r.returnZ=!1,r}return a(h,t),h.prototype.destroy=function(){this._timers.forEach(function(e){clearInterval(e)})},h.prototype.cancelJob=function(e,t){var a=this.parsedUrl.path,o=r({},this.requestOptions,t,{query:{f:\"json\"}});return this._clearTimer(e),s(a+\"/jobs/\"+e+\"/cancel\",o).then(function(e){return G.fromJSON(e.data)})},h.prototype.checkJobStatus=function(e,t){var a=this.parsedUrl.path,o=r({},this.requestOptions,t,{query:{f:\"json\"}});return s(a+\"/jobs/\"+e,o).then(function(e){return G.fromJSON(e.data)})},h.prototype.execute=function(e,t){var r=this;return this._constructRequest(\"execute\",e,t).then(function(e){var t=e.data.results||[],a=e.data.messages||[];return{results:t.map(r._decode),messages:a.map(function(e){return S.fromJSON(e)})}})},h.prototype.getResultData=function(e,t,a){var o=this,n=this,u=n.returnFeatureCollection,i=n.returnM,c=n.returnZ,l=n.outSpatialReference,p=n.parsedUrl,f=p.path,v={returnFeatureCollection:u||void 0,returnM:i||void 0,returnZ:c||void 0,outSR:l,returnType:\"data\",f:\"json\"},d=this._gpEncode(v,null),m=r({},this.requestOptions,a,{query:d});return s(f+\"/jobs/\"+e+\"/results/\"+t,m).then(function(e){return o._decode(e.data)})},h.prototype.getResultImage=function(e,t,a,o){var n=this,u=this.parsedUrl.path,i=r({},a.toJSON(),{f:\"json\"}),c=this._gpEncode(i),l=r({},this.requestOptions,o,{query:c});return s(u+\"/jobs/\"+e+\"/results/\"+t,l).then(function(e){return n._decode(e.data)})},h.prototype.getResultMapImageLayer=function(t){return u(this,void 0,void 0,function(){var r,a,o,u,s;return n(this,function(n){switch(n.label){case 0:return r=this.parsedUrl.path,a=r.indexOf(\"/GPServer/\"),o=r.substring(0,a),u=o+\"/MapServer/jobs/\"+t,[4,c.create(function(t){return e([\"../layers/MapImageLayer\"],t)})];case 1:return s=n.sent(),[2,new s({url:u})]}})})},h.prototype.submitJob=function(e,t){return this._constructRequest(\"submitJob\",e,t).then(function(e){return G.fromJSON(e.data)})},h.prototype.waitForJobCompletion=function(e,t){var r=this;void 0===t&&(t={});var a=t.interval,o=void 0===a?1e3:a,n=t.signal,u=t.statusCallback;return c.create(function(t,a){c.onAbort(n,function(){r._clearTimer(e),a(c.createAbortError())}),r._clearTimer(e);var s=setInterval(function(){r._timers.has(e)||a(c.createAbortError()),r._getJobStatus(e,r.requestOptions).then(function(o){var n=o.jobStatus;switch(n){case\"job-succeeded\":r._clearTimer(e),t(o);break;case\"job-submitted\":case\"job-executing\":case\"job-waiting\":case\"job-new\":u&&u(o);break;case\"job-cancelled\":case\"job-cancelling\":case\"job-deleted\":case\"job-deleting\":case\"job-timed-out\":case\"job-failed\":r._clearTimer(e),a(o);break;default:i.neverReached(n)}})},o);r._timers.set(e,s)})},h.prototype._clearTimer=function(e){this._timers.has(e)&&(clearInterval(this._timers.get(e)),this._timers.delete(e))},h.prototype._constructRequest=function(e,t,a){var o=this,n={},u={},i=[];return this._collectGeometries(t,i,n),v.normalizeCentralMeridian(i).then(function(i){var c=o,l=c.outSpatialReference,p=c.parsedUrl,f=c.processExtent,v=c.processSpatialReference,d=c.returnFeatureCollection,m=c.returnM,h=c.returnZ,b=p.path;for(var y in n){var S=n[y];u[y]=i.slice(S[0],S[1])}var G=l?l.wkid||l:null,g=v?v.wkid||v:null,P=f?{context:{extent:f,outSR:G,processSR:g}}:{\"env:outSR\":G,\"env:processSR\":g},R=\"execute\"===e?{returnFeatureCollection:d||void 0,returnM:m||void 0,returnZ:h||void 0}:null,_=r({},P,t,R,{f:\"json\"}),J=o._gpEncode(_,null,u),O=r({},o.requestOptions,a,{query:J});return s(b+\"/\"+e,O)})},h.prototype._collectGeometries=function(e,t,r){for(var a in e){var o=e[a];if(o&&\"object\"==typeof o&&o instanceof y){var n=o.features;r[a]=[t.length,t.length+n.length],n.forEach(function(e){t.push(e.geometry)})}}},h.prototype._decode=function(e){var t=e.dataType,r=P.fromJSON(e);switch(t){case\"GPBoolean\":case\"GPDouble\":case\"GPLong\":case\"GPString\":return r;case\"GPDate\":r.value=new Date(r.value);break;case\"GPDataFile\":r.value=b.fromJSON(r.value);break;case\"GPLinearUnit\":r.value=g.fromJSON(r.value);break;case\"GPFeatureRecordSetLayer\":case\"GPRecordSet\":var a=e.value.url;r.value=a?b.fromJSON(r.value):y.fromJSON(r.value);break;case\"GPRasterData\":case\"GPRasterDataLayer\":var o=e.value.mapImage;r.value=o?m.fromJSON(o):R.fromJSON(r.value);break;case\"GPField\":r.value=d.fromJSON(r.value);break;case\"GPMultiValue:GPBoolean\":case\"GPMultiValue:GPDouble\":case\"GPMultiValue:GPLong\":case\"GPMultiValue:GPString\":return r;case\"GPMultiValue:GPDate\":var n=r.value;r.value=n.map(function(e){return new Date(e)});break;case\"GPMultiValue:GPDataFile\":r.value=r.value.map(function(e){return b.fromJSON(e)});break;case\"GPMultiValue:GPLinearUnit\":r.value=r.value.map(function(e){return g.fromJSON(e)});break;case\"GPMultiValue:GPFeatureRecordSetLayer\":case\"GPMultiValue:GPRecordSet\":r.value=r.value.map(function(e){return y.fromJSON(e)});break;case\"GPMultiValue:GPRasterData\":case\"GPMultiValue:GPRasterDataLayer\":r.value=r.value.map(function(e){return e?m.fromJSON(e):R.fromJSON(r.value)});break;case\"GPMultiValue:GPField\":r.value=r.value.map(function(e){return d.fromJSON(e)});break;default:i.neverReached(t)}return r},h.prototype._gpEncode=function(e,t,r){var a=this;for(var o in e){var n=e[o];Array.isArray(n)?e[o]=JSON.stringify(n.map(function(e){return a._gpEncode({item:e},!0).item},this)):n instanceof Date&&(e[o]=n.getTime())}return this._encode(e,t,r)},h.prototype._getJobStatus=function(e,t){var a=this.parsedUrl.path,o=a+\"/jobs/\"+e,n=r({},this.requestOptions,t,{query:{f:\"json\"}});return s(o,n).then(function(e){return G.fromJSON(e.data)})},o([l.property({type:f})],h.prototype,\"outSpatialReference\",void 0),o([l.property({type:p})],h.prototype,\"processExtent\",void 0),o([l.property({type:f})],h.prototype,\"processSpatialReference\",void 0),o([l.property({nonNullable:!0})],h.prototype,\"returnFeatureCollection\",void 0),o([l.property({nonNullable:!0})],h.prototype,\"returnM\",void 0),o([l.property({nonNullable:!0})],h.prototype,\"returnZ\",void 0),h=o([l.subclass(\"esri/tasks/Geoprocessor\")],h)}(l.declared(h))});","// COPYRIGHT © 2019 Esri\n//\n// All rights reserved under the copyright laws of the United States\n// and applicable international laws, treaties, and conventions.\n//\n// This material is licensed for use under the Esri Master License\n// Agreement (MLA), and is bound by the terms of that agreement.\n// You may redistribute and use this code without modification,\n// provided you adhere to the terms of the MLA and include this\n// copyright notice.\n//\n// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english\n//\n// For additional information, contact:\n// Environmental Systems Research Institute, Inc.\n// Attn: Contracts and Legal Services Department\n// 380 New York Street\n// Redlands, California, USA 92373\n// USA\n//\n// email: contracts@esri.com\n//\n// See http://js.arcgis.com/4.14/esri/copyright.txt for details.\n\ndefine([\"require\",\"exports\",\"../core/tsSupport/assignHelper\",\"../core/tsSupport/awaiterHelper\",\"../core/tsSupport/declareExtendsHelper\",\"../core/tsSupport/decorateHelper\",\"../core/tsSupport/generatorHelper\",\"dojox/gfx/canvas\",\"../kernel\",\"../request\",\"../core/iteratorUtils\",\"../core/jsonMap\",\"../core/lang\",\"../core/promiseUtils\",\"../core/screenUtils\",\"../core/urlUtils\",\"../core/accessorSupport/decorators\",\"../geometry/Polygon\",\"../renderers/visualVariables/support/visualVariableUtils\",\"./Geoprocessor\",\"./Task\",\"./support/fileFormat\",\"./support/layoutTemplate\",\"./support/printTaskUtils\",\"./support/PrintTemplate\",\"./support/Query\"],function(e,t,r,a,i,n,s,o,l,u,c,y,p,d,f,h,m,g,S,b,v,_,L,x,O,w){function N(e){return e&&(e.path||\"image/svg+xml\"===e.contentType)}var J={Feet:\"ft\",Kilometers:\"km\",Meters:\"m\",Miles:\"mi\"},M=new y.default({esriFeet:\"Feet\",esriKilometers:\"Kilometers\",esriMeters:\"Meters\",esriMiles:\"Miles\"}),T=new y.default({esriExecutionTypeSynchronous:\"sync\",esriExecutionTypeAsynchronous:\"async\"}),I=new w({returnGeometry:!0});return function(e){function t(t){var r=e.call(this,t)||this;return r._ssExtent=null,r._legendLayers=[],r._legendLayerNameMap={},r._gpServerUrl=null,r._cimVersion=null,r._is11xService=!1,r._gpMetadata=null,r.updateDelay=1e3,r}return i(t,e),Object.defineProperty(t.prototype,\"_geoprocessor\",{get:function(){return new b({url:this.url})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"mode\",{get:function(){return this._gpMetadata&&this._gpMetadata.executionType?T.fromJSON(this._gpMetadata.executionType):\"sync\"},enumerable:!0,configurable:!0}),t.prototype.execute=function(e,t){var r=this,a=this.url,i=a.lastIndexOf(\"/GPServer/\");return i>0&&(a=a.slice(0,i+9)),d.resolve().then(function(){return r._gpServerUrl===a?{data:r._gpMetadata}:(r._gpServerUrl=a,u(a,{query:{f:\"json\"}}))}).then(function(t){return r._gpMetadata=t.data,r._cimVersion=r._gpMetadata.cimVersion,r._is11xService=!!r._cimVersion,r._getGpPrintParams(e)}).then(function(e){var a=function(e){return\"sync\"===r.mode?e.results&&e.results[0]&&e.results[0].value:r._geoprocessor.getResultData(e.jobId,\"Output_File\",t).then(function(e){return e.value})};return\"async\"===r.mode?r._geoprocessor.submitJob(e,t).then(function(e){return r._geoprocessor.waitForJobCompletion(e.jobId,{interval:r.updateDelay}).then(a)}):r._geoprocessor.execute(e,t).then(a)})},t.prototype._createOperationalLayers=function(e,t){return a(this,void 0,void 0,function(){var r,a,i,n,o,l,u,c,y,y;return s(this,function(s){switch(s.label){case 0:r=[],a={layerView:null,printTemplate:t,view:e},i=0,t.preserveScale&&(i=t.outScale||e.scale),n=x.getVisibleLayerViews(e,i),o=0,l=n,s.label=1;case 1:return o<l.length?(u=l[o],c=u.layer,!c.loaded||x.isGroupLayer(c)?[3,26]:(y=void 0,a.layerView=u,x.isBingMapsLayer(c)?(y=this._createBingMapsLayerJSON(c),[3,25]):[3,2])):[3,27];case 2:return x.isCSVLayer(c)?[4,this._createCSVLayerJSON(c,a)]:[3,4];case 3:return y=s.sent(),[3,25];case 4:return x.isFeatureLayer(c)?[4,this._createFeatureLayerJSON(c,a)]:[3,6];case 5:return y=s.sent(),[3,25];case 6:return x.isGraphicsLayer(c)?[4,this._createGraphicsLayerJSON(c,a)]:[3,8];case 7:return y=s.sent(),[3,25];case 8:return x.isImageryLayer(c)?(y=this._createImageryLayerJSON(c),[3,25]):[3,9];case 9:return x.isKMLLayer(c)?[4,this._createKMLLayerJSON(c,a)]:[3,11];case 10:return y=s.sent(),[3,25];case 11:return x.isMapImageLayer(c)?(y=this._createMapImageLayerJSON(c,a),[3,25]):[3,12];case 12:return x.isMapNotesLayer(c)?[4,this._createMapNotesLayerJSON(a)]:[3,14];case 13:return y=s.sent(),[3,25];case 14:return x.isOpenStreetMapLayer(c)?(y=this._createOpenStreetMapLayerJSON(),[3,25]):[3,15];case 15:return x.isStreamLayer(c)?[4,this._createStreamLayerJSON(c,a)]:[3,17];case 16:return y=s.sent(),[3,25];case 17:return x.isTileLayer(c)?(y=this._createTileLayerJSON(c),[3,25]):[3,18];case 18:return x.isVectorTileLayer(c)?[4,this._createVectorTileLayerJSON(c,a)]:[3,20];case 19:return y=s.sent(),[3,25];case 20:return x.isWebTileLayer(c)?(y=this._createWebTileLayerJSON(c),[3,25]):[3,21];case 21:return x.isWMSLayer(c)?(y=this._createWMSLayerJSON(c),[3,25]):[3,22];case 22:return x.isWMTSLayer(c)?(y=this._createWMTSLayerJSON(c),[3,25]):[3,23];case 23:return[4,this._createScreenshotJSON(c,a)];case 24:y=s.sent(),s.label=25;case 25:y&&(Array.isArray(y)?r.push.apply(r,y):(y.id=c.id,y.title=this._legendLayerNameMap[c.id]||c.title,y.opacity=c.opacity,y.minScale=c.minScale||0,y.maxScale=c.maxScale||0,r.push(y))),s.label=26;case 26:return o++,[3,1];case 27:return i&&r.forEach(function(e){e.minScale=0,e.maxScale=0}),e.graphics&&e.graphics.length?[4,this._createFeatureCollectionJSON(null,e.graphics,t)]:[3,29];case 28:y=s.sent(),y&&r.push(y),s.label=29;case 29:return[2,r]}})})},t.prototype._createBingMapsLayerJSON=function(e){return{culture:e.culture,key:e.key,type:\"BingMaps\"+(\"aerial\"===e.style?\"Aerial\":\"hybrid\"===e.style?\"Hybrid\":\"Road\")}},t.prototype._createCSVLayerJSON=function(e,t){var r=t.layerView,i=t.printTemplate;return a(this,void 0,void 0,function(){var t,a;return s(this,function(n){switch(n.label){case 0:return this._legendLayers&&this._legendLayers.push({id:e.id}),this._is11xService?(t={type:\"CSV\"},e.write(t,{origin:\"web-map\"}),delete t.popupInfo,delete t.layerType,t.showLabels=i.showLabels&&e.labelsVisible,[3,3]):[3,1];case 1:return[4,this._getGraphics(r)];case 2:return a=n.sent(),[2,this._createFeatureCollectionJSON(e,a,i)];case 3:return[2,t]}})})},t.prototype._createFeatureCollectionJSON=function(e,t,r){return a(this,void 0,void 0,function(){var a,i,n,o,l,u,y,p,d,f,h,m,S,b,v,_,L,O,w=this;return s(this,function(J){switch(J.label){case 0:return a=e,(i=x.createPolygonLayer(),n=x.createPolylineLayer(),o=x.createPointLayer(),l=x.createMultipointLayer(),u=x.createPointLayer(),u.layerDefinition.name=\"textLayer\",delete u.layerDefinition.drawingInfo,a&&(\"esri.layers.FeatureLayer\"===a.declaredClass||\"esri.layers.StreamLayer\"===a.declaredClass?i.layerDefinition.name=n.layerDefinition.name=o.layerDefinition.name=l.layerDefinition.name=this._legendLayerNameMap[a.id]||a.get(\"arcgisProps.title\")||a.title:\"esri.layers.GraphicsLayer\"===a.declaredClass&&(t=a.graphics.items)),a&&a.renderer?(y=a.renderer.toJSON(),i.layerDefinition.drawingInfo.renderer=y,n.layerDefinition.drawingInfo.renderer=y,o.layerDefinition.drawingInfo.renderer=y,l.layerDefinition.drawingInfo.renderer=y):(delete i.layerDefinition.drawingInfo,delete n.layerDefinition.drawingInfo,delete o.layerDefinition.drawingInfo,delete l.layerDefinition.drawingInfo),d=a&&a.fields,f=a&&a.renderer,d&&f&&\"function\"==typeof f.collectRequiredFields)?(h=new Set,[4,f.collectRequiredFields(h,d)]):[3,2];case 1:J.sent(),p=c.valuesOfSet(h),J.label=2;case 2:d&&(m=d.map(function(e){return e.toJSON()}),i.layerDefinition.fields=m,n.layerDefinition.fields=m,o.layerDefinition.fields=m,l.layerDefinition.fields=m),S=t&&t.length,v=function(e){var c,y,d,f,h;return s(this,function(s){switch(s.label){case 0:return c=t[e]||t.getItemAt(e),!1!==c.visible&&c.geometry?(b=c.toJSON(),b.hasOwnProperty(\"popupTemplate\")&&delete b.popupTemplate,b.geometry&&b.geometry.z&&delete b.geometry.z,b.symbol&&b.symbol.outline&&\"esriCLS\"===b.symbol.outline.type&&!_._is11xService?[2,\"continue\"]:(!_._is11xService&&b.symbol&&b.symbol.outline&&b.symbol.outline.color&&b.symbol.outline.color[3]&&(b.symbol.outline.color[3]=255),y=a&&a.renderer&&(\"valueExpression\"in a.renderer&&a.renderer.valueExpression||\"hasVisualVariables\"in a.renderer&&a.renderer.hasVisualVariables()),!b.symbol&&a&&a.renderer&&y&&!_._is11xService?(d=a.renderer,[4,d.getSymbolAsync(c)]):[3,2])):[2,\"continue\"];case 1:if(!(f=s.sent()))return[2,\"continue\"];b.symbol=f.toJSON(),\"hasVisualVariables\"in d&&d.hasVisualVariables()&&x.applyVisualVariables(b.symbol,{renderer:d,graphic:c,symbol:f}),s.label=2;case 2:return b.symbol&&(b.symbol.angle||delete b.symbol.angle,N(b.symbol)?b.symbol=_._convertSvgToPictureMarkerSymbolJson(b.symbol):b.symbol.text&&delete b.attributes),r&&r.forceFeatureAttributes||!p||!p.length||(h={},p.forEach(function(e){b.attributes&&b.attributes.hasOwnProperty(e)&&(h[e]=b.attributes[e])}),b.attributes=h),\"polygon\"===c.geometry.type?i.featureSet.features.push(b):\"polyline\"===c.geometry.type?n.featureSet.features.push(b):\"point\"===c.geometry.type?b.symbol&&b.symbol.text?u.featureSet.features.push(b):o.featureSet.features.push(b):\"multipoint\"===c.geometry.type?l.featureSet.features.push(b):\"extent\"===c.geometry.type&&(b.geometry=g.fromExtent(c.geometry).toJSON(),i.featureSet.features.push(b)),[2]}})},_=this,L=0,J.label=3;case 3:return L<S?[5,v(L)]:[3,6];case 4:J.sent(),J.label=5;case 5:return L++,[3,3];case 6:return O=[i,n,l,o,u].filter(function(e){return e.featureSet.features.length>0}),O.forEach(function(e){var t=e.featureSet.features.every(function(e){return e.symbol});!t||r&&r.forceFeatureAttributes||e.featureSet.features.forEach(function(e){delete e.attributes}),t&&delete e.layerDefinition.drawingInfo,e.layerDefinition.drawingInfo&&e.layerDefinition.drawingInfo.renderer&&w._convertSvgRenderer(e.layerDefinition.drawingInfo.renderer)}),[2,O.length?{featureCollection:{layers:O}}:null]}})})},t.prototype._createFeatureLayerJSON=function(e,t){return a(this,void 0,void 0,function(){var r,a,i,n,o,l,u,c,y,p;return s(this,function(s){switch(s.label){case 0:return this._legendLayers&&this._legendLayers.push({id:e.id}),(a=e.renderer,e.featureReduction||a&&\"dot-density\"===a.type)?[2,this._createScreenshotJSON(e,t)]:(i=t.layerView,n=t.printTemplate,o=t.view,l=a&&(\"valueExpression\"in a&&a.valueExpression||\"hasVisualVariables\"in a&&a.hasVisualVariables()),u=e.source&&\"feature-layer\"!==e.source.type,!this._is11xService&&l||e.featureReduction||u||!a||\"field\"in a&&null!=a.field&&(\"string\"!=typeof a.field||!e.getField(a.field))?[3,1]:(r={},this._setURLandToken(r,e),e.write(r,{origin:\"web-map\"}),delete r.layerType,delete r.popupInfo,delete r.visibility,r.showLabels=n.showLabels&&e.labelsVisible,r.layerDefinition&&r.layerDefinition.drawingInfo&&r.layerDefinition.drawingInfo.renderer&&(this._convertSvgRenderer(r.layerDefinition.drawingInfo.renderer),\"visualVariables\"in a&&a.visualVariables&&a.visualVariables[0]&&(c=a.visualVariables[0],\"size\"===c.type&&c.maxSize&&\"number\"!=typeof c.maxSize&&c.minSize&&\"number\"!=typeof c.minSize&&(y=S.getSizeRangeAtScale(c,o.scale),r.layerDefinition.drawingInfo.renderer.visualVariables[0].minSize=y.minSize,r.layerDefinition.drawingInfo.renderer.visualVariables[0].maxSize=y.maxSize))),[3,4]));case 1:return[4,this._getGraphics(i)];case 2:return p=s.sent(),[4,this._createFeatureCollectionJSON(e,p,n)];case 3:r=s.sent(),s.label=4;case 4:return[2,r]}})})},t.prototype._createGraphicsLayerJSON=function(e,t){var r=t.printTemplate;return a(this,void 0,void 0,function(){return s(this,function(t){return[2,this._createFeatureCollectionJSON(e,null,r)]})})},t.prototype._createImageryLayerJSON=function(e){this._legendLayers&&this._legendLayers.push({id:e.id});var t={bandIds:e.bandIds,compressionQuality:e.compressionQuality,format:e.format,interpolation:e.interpolation};if((e.mosaicRule||e.definitionExpression)&&(t.mosaicRule=e.exportImageServiceParameters.mosaicRule.toJSON()),e.renderingRule||e.renderer)if(this._is11xService)e.renderingRule&&(t.renderingRule=e.renderingRule.toJSON()),e.renderer&&(t.layerDefinition=t.layerDefinition||{},t.layerDefinition.drawingInfo=t.layerDefinition.drawingInfo||{},t.layerDefinition.drawingInfo.renderer=e.renderer.toJSON());else{var r=e.exportImageServiceParameters.combineRendererWithRenderingRule();r&&(t.renderingRule=r.toJSON())}return this._setURLandToken(t,e),t},t.prototype._createKMLLayerJSON=function(e,t){return a(this,void 0,void 0,function(){var a,i,n,o,l,u,c;return s(this,function(s){switch(s.label){case 0:return a=t.printTemplate,this._is11xService?(i={type:\"kml\"},e.write(i,{origin:\"web-map\"}),delete i.layerType,i.url=h.normalize(e.url),[2,i]):(n=[],o=t.layerView,o.allVisibleMapImages.forEach(function(t,r){var a={id:e.id+\"_image\"+r,type:\"image\",title:e.id,minScale:e.minScale||0,maxScale:e.maxScale||0,opacity:e.opacity,extent:t.extent};\"data:image/png;base64,\"===t.href.substr(0,22)?a.imageData=t.href.substr(22):a.url=t.href,n.push(a)}),l=o.allVisiblePoints.items.concat(o.allVisiblePolylines.items,o.allVisiblePolygons.items),c=[{id:e.id}],[4,this._createFeatureCollectionJSON(null,l,a)]);case 1:return u=r.apply(void 0,c.concat([s.sent()])),n.push(u),[2,n]}})})},t.prototype._createMapImageLayerJSON=function(e,t){var r,a=t.view,i={id:e.id,subLayerIds:[]},n=[],s=a.scale,o=function(e){var t=0===s,r=0===e.minScale||s<=e.minScale,a=0===e.maxScale||s>=e.maxScale;if(e.visible&&(t||r&&a))if(e.sublayers)e.sublayers.forEach(o);else{var l=e.toExportImageJSON().drawingInfo,u=e.toJSON();u.layerDefinition.drawingInfo=l,n.unshift(u),i.subLayerIds.push(e.id)}};return e.sublayers&&e.sublayers.forEach(o),n.length&&(n=n.map(function(e){return{id:e.id,name:e.name,layerDefinition:e.layerDefinition}}),r={layers:n,visibleLayers:i.subLayerIds},this._setURLandToken(r,e),this._legendLayers.push(i)),r},t.prototype._createMapNotesLayerJSON=function(e){var t=e.layerView,r=e.printTemplate;return a(this,void 0,void 0,function(){var e,a,i,n,o;return s(this,function(s){switch(s.label){case 0:e=[],a=0,i=t.graphicsViews,s.label=1;case 1:return a<i.length?(n=i[a],[4,this._createFeatureCollectionJSON(n,n.graphics,r)]):[3,4];case 2:o=s.sent(),o&&e.push.apply(e,o.featureCollection.layers),s.label=3;case 3:return a++,[3,1];case 4:return[2,{featureCollection:{layers:e}}]}})})},t.prototype._createOpenStreetMapLayerJSON=function(){return{type:\"OpenStreetMap\"}},t.prototype._createScreenshotJSON=function(e,t){var r=t.printTemplate,i=t.view;return a(this,void 0,void 0,function(){var t,a,n,o,l,u,c,y,p,d;return s(this,function(s){switch(s.label){case 0:return t={type:\"image\"},a={format:\"png\",ignoreBackground:!0,layers:[e],rotation:0},n=this._ssExtent||i.extent.clone(),o=96,l=!0,u=!0,r.exportOptions&&(c=r.exportOptions,c.dpi>0&&(o=c.dpi),c.width>0&&(l=c.width%2==i.width%2),c.height>0&&(u=c.height%2==i.height%2)),\"map-only\"!==r.layout||!r.preserveScale||r.outScale&&r.outScale!==i.scale||96!==o||l&&u||(a.area={x:0,y:0,width:i.width,height:i.height},l||(a.area.width-=1),u||(a.area.height-=1),this._ssExtent||(y=i.toMap(f.createScreenPoint(a.area.width,a.area.height)),n.ymin=y.y,n.xmax=y.x,this._ssExtent=n)),t.extent=n.clone()._normalize(!0).toJSON(),[4,i.takeScreenshot(a)];case 1:return p=s.sent(),d=h.dataComponents(p.dataUrl),t.imageData=d.data,[2,t]}})})},t.prototype._createStreamLayerJSON=function(e,t){var r=t.layerView,i=t.printTemplate;return a(this,void 0,void 0,function(){var t;return s(this,function(a){switch(a.label){case 0:return this._legendLayers&&this._legendLayers.push({id:e.id}),[4,this._getGraphics(r)];case 1:return t=a.sent(),[2,this._createFeatureCollectionJSON(e,t,i)]}})})},t.prototype._createTileLayerJSON=function(e){var t={};return this._setURLandToken(t,e),t},t.prototype._createVectorTileLayerJSON=function(e,t){return a(this,void 0,void 0,function(){var r,a,i;return s(this,function(n){return this._is11xService&&e.serviceUrl&&e.styleUrl&&(r=l.id&&l.id.findCredential(e.styleUrl),a=l.id&&l.id.findCredential(e.serviceUrl),!r&&!a||\"2.1.0\"!==this._cimVersion)?(i={type:\"VectorTileLayer\"},i.styleUrl=h.normalize(e.styleUrl),r&&(i.token=r.token),a&&a.token!==i.token&&(i.additionalTokens=[{url:e.serviceUrl,token:a.token}]),[2,i]):[2,this._createScreenshotJSON(e,t)]})})},t.prototype._createWebTileLayerJSON=function(e){var t=e.urlTemplate.replace(/\\${/g,\"{\"),r={type:\"WebTiledLayer\",urlTemplate:t,credits:e.copyright};return e.subDomains&&e.subDomains.length>0&&(r.subDomains=e.subDomains),r},t.prototype._createWMSLayerJSON=function(e){var t,r=[],a=function(e){e.visible&&(e.sublayers?e.sublayers.forEach(a):e.name&&r.unshift(e.name))};return e.sublayers&&e.sublayers.forEach(a),r.length&&(t={type:\"wms\",customLayerParameters:e.customLayerParameters,customParameters:e.customParameters,transparentBackground:e.imageTransparency,visibleLayers:r,url:h.normalize(e.url),version:e.version}),t},t.prototype._createWMTSLayerJSON=function(e){var t=e.activeLayer;return{type:\"wmts\",customLayerParameters:e.customLayerParameters,customParameters:e.customParameters,format:t.imageFormat,layer:t.id,style:t.styleId,tileMatrixSet:t.tileMatrixSetId,url:h.normalize(e.url)}},t.prototype._setURLandToken=function(e,t){if(t.url){e.url=h.normalize(t.url);var r=l.id&&l.id.findCredential(t.url);r&&(e.token=r.token)}},t.prototype._convertSvgToPictureMarkerSymbolJson=function(e){this._canvasParent?(this._canvasSurface.clear(),this._canvasSurface.setDimensions(1024,1024)):(this._canvasParent=document.createElement(\"div\"),this._canvasSurface=o.createSurface(this._canvasParent,1024,1024));var t;t=\"image/svg+xml\"===e.contentType?this._canvasSurface.createObject(o.Image,{src:\"data:image/svg+xml;base64,\"+e.imageData,width:f.pt2px(e.width),height:f.pt2px(e.height),x:0,y:0}):this._canvasSurface.createObject(o.Path,e.path).setFill(e.color).setStroke(e.outline),\"pendingRender\"in this._canvasSurface&&this._canvasSurface._render(!0);var r=this._canvasSurface.rawNode.getContext(\"2d\"),a=t.getBoundingBox(),i=Math.ceil(a.width+a.x),n=Math.ceil(a.height+a.y),s=r.getImageData(a.x,a.y,i,n);r.canvas.width=i,r.canvas.height=n,r.putImageData(s,0,0);return{type:\"esriPMS\",imageData:r.canvas.toDataURL(\"image/png\").substr(22),angle:e.angle,contentType:\"image/png\",height:e.size?e.size:n-a.y,width:e.size?e.size:i-a.x,xoffset:e.xoffset,yoffset:e.yoffset}},t.prototype._convertSvgRenderer=function(e){var t=this,r=e.type;if(\"simple\"===r&&N(e.symbol))e.symbol=this._convertSvgToPictureMarkerSymbolJson(e.symbol);else if(\"unique-value\"===r||\"class-breaks\"===r){N(e.defaultSymbol)&&(e.defaultSymbol=this._convertSvgToPictureMarkerSymbolJson(e.defaultSymbol));var a=\"unique-value\"===r?\"uniqueValueInfos\":\"classBreakInfos\",i=e[a];i&&i.forEach(function(e){N(e.symbol)&&(e.symbol=t._convertSvgToPictureMarkerSymbolJson(e.symbol))})}},t.prototype._getGraphics=function(e){return e.queryFeatures(I).then(function(e){return e.features})},t.prototype._getPrintDefinition=function(e,t){return a(this,void 0,void 0,function(){var r,a,i,n,o;return s(this,function(s){switch(s.label){case 0:return r=e.view,a=r.spatialReference,n={},[4,this._createOperationalLayers(r,t)];case 1:return n.operationalLayers=s.sent(),i=n,o=this._ssExtent||e.extent||r.extent,a&&a.isWrappable&&(o=o.clone()._normalize(!0),a=o.spatialReference),i.mapOptions={extent:o&&o.toJSON(),spatialReference:a&&a.toJSON(),showAttribution:t.attributionVisible},this._ssExtent=null,r.rotation&&(i.mapOptions.rotation=-r.rotation),t.preserveScale&&(i.mapOptions.scale=t.outScale||r.scale),[2,i]}})})},t.prototype._getGpPrintParams=function(e){return a(this,void 0,void 0,function(){var t,r,a,i,n,o,l,u,c,y,d,f,h,m,g,S,b,v,x,w=this;return s(this,function(s){switch(s.label){case 0:return t=e.template||new O,null==t.showLabels&&(t.showLabels=!0),r=t.exportOptions,i=L.toJSON(t.layout),r&&(n=r.dpi,a={dpi:n},\"map_only\"!==i.toLowerCase()&&\"\"!==i||(o=r.width,l=r.height,a.outputSize=[o,l])),u=t.layoutOptions,u&&(y=void 0,d=void 0,\"Miles\"===u.scalebarUnit||\"Kilometers\"===u.scalebarUnit?(y=\"Kilometers\",d=\"Miles\"):\"Meters\"!==u.scalebarUnit&&\"Feet\"!==u.scalebarUnit||(y=\"Meters\",d=\"Feet\"),c={titleText:u.titleText,authorText:u.authorText,copyrightText:u.copyrightText,customTextElements:u.customTextElements,scaleBarOptions:{metricUnit:M.toJSON(y),metricLabel:J[y],nonMetricUnit:M.toJSON(d),nonMetricLabel:J[d]}}),f=null,u&&u.legendLayers&&(f=u.legendLayers.map(function(e){w._legendLayerNameMap[e.layerId]=e.title;var t={id:e.layerId};return e.subLayerIds&&(t.subLayerIds=e.subLayerIds),t})),[4,this._getPrintDefinition(e,t)];case 1:return h=s.sent(),h.operationalLayers&&(g=new RegExp(\"[\\\\u4E00-\\\\u9FFF\\\\u0E00-\\\\u0E7F\\\\u0900-\\\\u097F\\\\u3040-\\\\u309F\\\\u30A0-\\\\u30FF\\\\u31F0-\\\\u31FF]\"),S=/[\\u0600-\\u06FF]/,b=function(e){var t=e.text,r=e.font,a=r&&r.family&&r.family.toLowerCase();t&&r&&(\"arial\"===a||\"arial unicode ms\"===a)&&(r.family=g.test(t)?\"Arial Unicode MS\":\"Arial\",\"normal\"!==r.style&&S.test(t)&&(r.family=\"Arial Unicode MS\"))},h.operationalLayers.forEach(function(e){e.featureCollection&&e.featureCollection.layers&&e.featureCollection.layers.forEach(function(e){e.layerDefinition&&e.layerDefinition.drawingInfo&&e.layerDefinition.drawingInfo.renderer&&e.layerDefinition.drawingInfo.renderer.symbol&&(m=e.layerDefinition.drawingInfo.renderer,\"esriTS\"===m.symbol.type&&b(m.symbol)),e.featureSet&&e.featureSet.features&&e.featureSet.features.forEach(function(e){e.symbol&&\"esriTS\"===e.symbol.type&&b(e.symbol)})})})),e.outSpatialReference&&(h.mapOptions.spatialReference=e.outSpatialReference.toJSON()),p.mixin(h,{exportOptions:a,layoutOptions:c}),p.mixin(h.layoutOptions,{legendOptions:{operationalLayers:null!=f?f:this._legendLayers.slice()}}),this._legendLayers.length=0,v=JSON.stringify(h),x={Web_Map_as_JSON:v,Format:_.toJSON(t.format),Layout_Template:i},e.extraParameters&&p.mixin(x,e.extraParameters),[2,x]}})})},n([m.property({dependsOn:[\"url\"]})],t.prototype,\"_geoprocessor\",null),n([m.property()],t.prototype,\"_gpMetadata\",void 0),n([m.property({dependsOn:[\"_gpMetadata\"],readOnly:!0})],t.prototype,\"mode\",null),n([m.property()],t.prototype,\"updateDelay\",void 0),t=n([m.subclass(\"esri.tasks.PrintTask\")],t)}(m.declared(v))});","// COPYRIGHT © 2019 Esri\n//\n// All rights reserved under the copyright laws of the United States\n// and applicable international laws, treaties, and conventions.\n//\n// This material is licensed for use under the Esri Master License\n// Agreement (MLA), and is bound by the terms of that agreement.\n// You may redistribute and use this code without modification,\n// provided you adhere to the terms of the MLA and include this\n// copyright notice.\n//\n// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english\n//\n// For additional information, contact:\n// Environmental Systems Research Institute, Inc.\n// Attn: Contracts and Legal Services Department\n// 380 New York Street\n// Redlands, California, USA 92373\n// USA\n//\n// email: contracts@esri.com\n//\n// See http://js.arcgis.com/4.14/esri/copyright.txt for details.\n\ndefine([\"require\",\"exports\",\"../../core/tsSupport/declareExtendsHelper\",\"../../core/tsSupport/decorateHelper\",\"../../core/JSONSupport\",\"../../core/accessorSupport/decorators\"],function(r,e,t,o,p,i){return function(r){function e(e){var t=r.call(this,e)||this;return t.itemId=null,t.url=null,t}return t(e,r),o([i.property({type:String,json:{read:{source:\"itemID\"},write:{target:\"itemID\"}}})],e.prototype,\"itemId\",void 0),o([i.property({type:String,json:{write:!0}})],e.prototype,\"url\",void 0),e=o([i.subclass(\"esri.tasks.support.DataFile\")],e)}(i.declared(p.JSONSupport))});","// COPYRIGHT © 2019 Esri\n//\n// All rights reserved under the copyright laws of the United States\n// and applicable international laws, treaties, and conventions.\n//\n// This material is licensed for use under the Esri Master License\n// Agreement (MLA), and is bound by the terms of that agreement.\n// You may redistribute and use this code without modification,\n// provided you adhere to the terms of the MLA and include this\n// copyright notice.\n//\n// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english\n//\n// For additional information, contact:\n// Environmental Systems Research Institute, Inc.\n// Attn: Contracts and Legal Services Department\n// 380 New York Street\n// Redlands, California, USA 92373\n// USA\n//\n// email: contracts@esri.com\n//\n// See http://js.arcgis.com/4.14/esri/copyright.txt for details.\n\ndefine([\"require\",\"exports\",\"../../core/tsSupport/declareExtendsHelper\",\"../../core/tsSupport/decorateHelper\",\"../../core/jsonMap\",\"../../core/JSONSupport\",\"../../core/accessorSupport/decorators\"],function(e,r,s,o,t,p,i){var n=new t.default({esriJobMessageTypeInformative:\"informative\",esriJobMessageTypeProcessDefinition:\"process-definition\",esriJobMessageTypeProcessStart:\"process-start\",esriJobMessageTypeProcessStop:\"process-stop\",esriJobMessageTypeWarning:\"warning\",esriJobMessageTypeError:\"error\",esriJobMessageTypeEmpty:\"empty\",esriJobMessageTypeAbort:\"abort\"});return function(e){function r(r){var s=e.call(this,r)||this;return s.description=null,s.type=null,s}return s(r,e),o([i.property({type:String,json:{write:!0}})],r.prototype,\"description\",void 0),o([i.property({type:String,json:{read:n.read,write:n.write}})],r.prototype,\"type\",void 0),r=o([i.subclass(\"esri.tasks.support.GPMessage\")],r)}(i.declared(p.JSONSupport))});","// COPYRIGHT © 2019 Esri\n//\n// All rights reserved under the copyright laws of the United States\n// and applicable international laws, treaties, and conventions.\n//\n// This material is licensed for use under the Esri Master License\n// Agreement (MLA), and is bound by the terms of that agreement.\n// You may redistribute and use this code without modification,\n// provided you adhere to the terms of the MLA and include this\n// copyright notice.\n//\n// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english\n//\n// For additional information, contact:\n// Environmental Systems Research Institute, Inc.\n// Attn: Contracts and Legal Services Department\n// 380 New York Street\n// Redlands, California, USA 92373\n// USA\n//\n// email: contracts@esri.com\n//\n// See http://js.arcgis.com/4.14/esri/copyright.txt for details.\n\ndefine([\"require\",\"exports\",\"../../core/tsSupport/declareExtendsHelper\",\"../../core/tsSupport/decorateHelper\",\"../../core/jsonMap\",\"../../core/JSONSupport\",\"../../core/accessorSupport/decorators\",\"./GPMessage\"],function(e,o,r,t,s,i,d,n){var b=new s.default({esriJobCancelled:\"job-cancelled\",esriJobCancelling:\"job-cancelling\",esriJobDeleted:\"job-deleted\",esriJobDeleting:\"job-deleting\",esriJobTimedOut:\"job-timed-out\",esriJobExecuting:\"job-executing\",esriJobFailed:\"job-failed\",esriJobNew:\"job-new\",esriJobSubmitted:\"job-submitted\",esriJobSucceeded:\"job-succeeded\",esriJobWaiting:\"job-waiting\"});return function(e){function o(o){var r=e.call(this,o)||this;return r.jobId=null,r.jobStatus=null,r.messages=null,r}return r(o,e),t([d.property()],o.prototype,\"jobId\",void 0),t([d.property({json:{read:b.read}})],o.prototype,\"jobStatus\",void 0),t([d.property({type:[n]})],o.prototype,\"messages\",void 0),o=t([d.subclass(\"esri.tasks.support.JobInfo\")],o)}(d.declared(i.JSONSupport))});","// COPYRIGHT © 2019 Esri\n//\n// All rights reserved under the copyright laws of the United States\n// and applicable international laws, treaties, and conventions.\n//\n// This material is licensed for use under the Esri Master License\n// Agreement (MLA), and is bound by the terms of that agreement.\n// You may redistribute and use this code without modification,\n// provided you adhere to the terms of the MLA and include this\n// copyright notice.\n//\n// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english\n//\n// For additional information, contact:\n// Environmental Systems Research Institute, Inc.\n// Attn: Contracts and Legal Services Department\n// 380 New York Street\n// Redlands, California, USA 92373\n// USA\n//\n// email: contracts@esri.com\n//\n// See http://js.arcgis.com/4.14/esri/copyright.txt for details.\n\ndefine([\"require\",\"exports\",\"../../core/tsSupport/declareExtendsHelper\",\"../../core/tsSupport/decorateHelper\",\"../../core/jsonMap\",\"../../core/JSONSupport\",\"../../core/accessorSupport/decorators\"],function(e,r,t,s,i,o,n){var p=new i.default({esriMeters:\"meters\",esriFeet:\"feet\",esriKilometers:\"kilometers\",esriMiles:\"miles\",esriNauticalMiles:\"nautical-miles\",esriYards:\"yards\"},{ignoreUnknown:!1});return function(e){function r(r){var t=e.call(this,r)||this;return t.distance=0,t.units=null,t}return t(r,e),s([n.property({json:{write:!0}})],r.prototype,\"distance\",void 0),s([n.property({json:{read:p.read,write:p.write}})],r.prototype,\"units\",void 0),r=s([n.subclass(\"esri/tasks/support/LinearUnit\")],r)}(n.declared(o.JSONSupport))});","// COPYRIGHT © 2019 Esri\n//\n// All rights reserved under the copyright laws of the United States\n// and applicable international laws, treaties, and conventions.\n//\n// This material is licensed for use under the Esri Master License\n// Agreement (MLA), and is bound by the terms of that agreement.\n// You may redistribute and use this code without modification,\n// provided you adhere to the terms of the MLA and include this\n// copyright notice.\n//\n// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english\n//\n// For additional information, contact:\n// Environmental Systems Research Institute, Inc.\n// Attn: Contracts and Legal Services Department\n// 380 New York Street\n// Redlands, California, USA 92373\n// USA\n//\n// email: contracts@esri.com\n//\n// See http://js.arcgis.com/4.14/esri/copyright.txt for details.\n\ndefine([\"require\",\"exports\",\"../../core/tsSupport/declareExtendsHelper\",\"../../core/tsSupport/decorateHelper\",\"../../core/jsonMap\",\"../../core/JSONSupport\",\"../../core/accessorSupport/decorators\"],function(e,t,a,l,u,r,i){var o=new u.default({GPBoolean:\"boolean\",GPDataFile:\"data-file\",GPDate:\"date\",GPDouble:\"double\",GPFeatureRecordSetLayer:\"feature-record-set-layer\",GPField:\"field\",GPLinearUnit:\"linear-unit\",GPLong:\"long\",GPRasterData:\"raster-data\",GPRasterDataLayer:\"raster-data-layer\",GPRecordSet:\"record-set\",GPString:\"string\",\"GPMultiValue:GPBoolean\":\"multi-value\",\"GPMultiValue:GPDataFile\":\"multi-value\",\"GPMultiValue:GPDate\":\"multi-value\",\"GPMultiValue:GPDouble\":\"multi-value\",\"GPMultiValue:GPFeatureRecordSetLayer\":\"multi-value\",\"GPMultiValue:GPField\":\"multi-value\",\"GPMultiValue:GPLinearUnit\":\"multi-value\",\"GPMultiValue:GPLong\":\"multi-value\",\"GPMultiValue:GPRasterData\":\"multi-value\",\"GPMultiValue:GPRasterDataLayer\":\"multi-value\",\"GPMultiValue:GPRecordSet\":\"multi-value\",\"GPMultiValue:GPString\":\"multi-value\"});return function(e){function t(t){var a=e.call(this,t)||this;return a.dataType=null,a.value=null,a}return a(t,e),l([i.property({json:{read:o.read,write:o.write}})],t.prototype,\"dataType\",void 0),l([i.property()],t.prototype,\"value\",void 0),t=l([i.subclass(\"esri.tasks.support.ParameterValue\")],t)}(i.declared(r.JSONSupport))});","// COPYRIGHT © 2019 Esri\n//\n// All rights reserved under the copyright laws of the United States\n// and applicable international laws, treaties, and conventions.\n//\n// This material is licensed for use under the Esri Master License\n// Agreement (MLA), and is bound by the terms of that agreement.\n// You may redistribute and use this code without modification,\n// provided you adhere to the terms of the MLA and include this\n// copyright notice.\n//\n// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english\n//\n// For additional information, contact:\n// Environmental Systems Research Institute, Inc.\n// Attn: Contracts and Legal Services Department\n// 380 New York Street\n// Redlands, California, USA 92373\n// USA\n//\n// email: contracts@esri.com\n//\n// See http://js.arcgis.com/4.14/esri/copyright.txt for details.\n\n/**\n       * Defines the layout elements. It's an object with the following properties:\n       *\n       * @property {string} [titleText] - The text used for the map title if the specified layout contains a title text element.\n       * @property {string} [authorText] - The text used for the author if the specified layout contains an author text element.\n       * @property {string} [copyrightText] - The text used for the copyright if the specified layout contains a copyright text element.\n       * @property {\"Miles\" | \"Kilometers\" | \"Meters\" | \"Feet\"} [scalebarUnit=Miles] - The unit used for the scalebar.\n       * @property {module:esri/tasks/support/LegendLayer[]} [legendLayers] - An array of {@link module:esri/tasks/support/LegendLayer}\n       * containing the ids of the layers that will be included in the legend. Tiled layers and GraphicsLayer will not appear in the\n       * legend. If `legendLayers` is not specified, all operational layers (non-tiled layers) except {@link module:esri/layers/GraphicsLayer}\n       * will be present in the legend. To specify that no layers will be included in the legend, set `legendLayer = []`.\n       * @property {Object[]} [customTextElements] - An array of name-value pair objects. Use this property to update the text for custom text elements\n       * on the page layout. Values must be strings. The custom text elements must exist in the print service. All out-of-the-box print service layout\n       * templates contain a text element named `date` that gets populated by default with the system date-time, but can be overwritten.\n       *\n       * @example\n       * layoutOptions: {\n       *   titleText: \"My Print\",\n       *   authorText: \"Sam\",\n       *   copyrightText: \"My Company\",\n       *   scalebarUnit: \"Miles\",\n       *   // the following text elements must\n       *   // exist in the print service to appear\n       *   customTextElements: [\n       *     {\"description\": \"My description\"},\n       *     {\"location\": \"My Location\"},\n       *     {\"date\": \"11/11/2020, 11:11:20 AM\"}\n       *   ]\n       * }\n       * @type {Object}\n       */\n\ndefine([\"../../core/Accessor\"],function(e){return e.createSubclass({declaredClass:\"esri.tasks.support.PrintTemplate\",properties:{attributionVisible:{value:!0,type:Boolean},exportOptions:{value:{width:800,height:1100,dpi:96},type:Object},forceFeatureAttributes:{value:!1,type:Boolean},format:{value:\"png32\",type:String},label:{value:null,type:String},layout:{value:\"map-only\",type:String},layoutOptions:{value:null,type:Object},outScale:{value:0,type:Number},preserveScale:{value:!0,type:Boolean},showLabels:{value:!0,type:Boolean}}})});","// COPYRIGHT © 2019 Esri\n//\n// All rights reserved under the copyright laws of the United States\n// and applicable international laws, treaties, and conventions.\n//\n// This material is licensed for use under the Esri Master License\n// Agreement (MLA), and is bound by the terms of that agreement.\n// You may redistribute and use this code without modification,\n// provided you adhere to the terms of the MLA and include this\n// copyright notice.\n//\n// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english\n//\n// For additional information, contact:\n// Environmental Systems Research Institute, Inc.\n// Attn: Contracts and Legal Services Department\n// 380 New York Street\n// Redlands, California, USA 92373\n// USA\n//\n// email: contracts@esri.com\n//\n// See http://js.arcgis.com/4.14/esri/copyright.txt for details.\n\ndefine([\"require\",\"exports\",\"../../core/tsSupport/declareExtendsHelper\",\"../../core/tsSupport/decorateHelper\",\"../../geometry\",\"../../core/jsonMap\",\"../../core/JSONSupport\",\"../../core/lang\",\"../../core/accessorSupport/decorators\"],function(e,t,r,o,i,n,p,s,a){Object.defineProperty(t,\"__esModule\",{value:!0});var c=new n.default({upperLeft:\"upper-left\",lowerLeft:\"lower-left\"}),l=function(e){function t(t){var r=e.call(this,t)||this;return r.extent=null,r.mode=\"view\",r.originPosition=\"upper-left\",r.tolerance=1,r}r(t,e),n=t,t.prototype.clone=function(){return new n(s.clone({extent:this.extent,mode:this.mode,originPosition:this.originPosition,tolerance:this.tolerance}))};var n;return o([a.property({type:i.Extent,json:{write:!0}})],t.prototype,\"extent\",void 0),o([a.property({type:[\"view\",\"edit\"],json:{write:!0}})],t.prototype,\"mode\",void 0),o([a.property({type:String,json:{read:c.read,write:c.write}})],t.prototype,\"originPosition\",void 0),o([a.property({type:Number,json:{write:!0}})],t.prototype,\"tolerance\",void 0),t=n=o([a.subclass(\"esri.tasks.support.QuantizationParameters\")],t)}(a.declared(p.JSONSupport));t.default=l});","// COPYRIGHT © 2019 Esri\n//\n// All rights reserved under the copyright laws of the United States\n// and applicable international laws, treaties, and conventions.\n//\n// This material is licensed for use under the Esri Master License\n// Agreement (MLA), and is bound by the terms of that agreement.\n// You may redistribute and use this code without modification,\n// provided you adhere to the terms of the MLA and include this\n// copyright notice.\n//\n// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english\n//\n// For additional information, contact:\n// Environmental Systems Research Institute, Inc.\n// Attn: Contracts and Legal Services Department\n// 380 New York Street\n// Redlands, California, USA 92373\n// USA\n//\n// email: contracts@esri.com\n//\n// See http://js.arcgis.com/4.14/esri/copyright.txt for details.\n\ndefine([\"require\",\"exports\",\"../../core/tsSupport/declareExtendsHelper\",\"../../core/tsSupport/decorateHelper\",\"../../core/JSONSupport\",\"../../core/accessorSupport/decorators\"],function(r,e,t,o,p,u){return function(r){function e(e){var t=r.call(this,e)||this;return t.format=null,t.itemId=null,t.url=null,t}return t(e,r),o([u.property()],e.prototype,\"format\",void 0),o([u.property({json:{read:{source:\"itemID\"},write:{target:\"itemID\"}}})],e.prototype,\"itemId\",void 0),o([u.property()],e.prototype,\"url\",void 0),e=o([u.subclass(\"esri/tasks/support/RasterData\")],e)}(u.declared(p.JSONSupport))});","// COPYRIGHT © 2019 Esri\n//\n// All rights reserved under the copyright laws of the United States\n// and applicable international laws, treaties, and conventions.\n//\n// This material is licensed for use under the Esri Master License\n// Agreement (MLA), and is bound by the terms of that agreement.\n// You may redistribute and use this code without modification,\n// provided you adhere to the terms of the MLA and include this\n// copyright notice.\n//\n// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english\n//\n// For additional information, contact:\n// Environmental Systems Research Institute, Inc.\n// Attn: Contracts and Legal Services Department\n// 380 New York Street\n// Redlands, California, USA 92373\n// USA\n//\n// email: contracts@esri.com\n//\n// See http://js.arcgis.com/4.14/esri/copyright.txt for details.\n\ndefine([\"require\",\"exports\",\"../../core/jsonMap\"],function(e,n,o){Object.defineProperty(n,\"__esModule\",{value:!0});var r=new o.default({PDF:\"pdf\",PNG32:\"png32\",PNG8:\"png8\",JPG:\"jpg\",GIF:\"gif\",EPS:\"eps\",SVG:\"svg\",SVGZ:\"svgz\"});n.fromJSON=r.fromJSON.bind(r),n.toJSON=r.toJSON.bind(r)});","// COPYRIGHT © 2019 Esri\n//\n// All rights reserved under the copyright laws of the United States\n// and applicable international laws, treaties, and conventions.\n//\n// This material is licensed for use under the Esri Master License\n// Agreement (MLA), and is bound by the terms of that agreement.\n// You may redistribute and use this code without modification,\n// provided you adhere to the terms of the MLA and include this\n// copyright notice.\n//\n// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english\n//\n// For additional information, contact:\n// Environmental Systems Research Institute, Inc.\n// Attn: Contracts and Legal Services Department\n// 380 New York Street\n// Redlands, California, USA 92373\n// USA\n//\n// email: contracts@esri.com\n//\n// See http://js.arcgis.com/4.14/esri/copyright.txt for details.\n\ndefine([\"require\",\"exports\",\"../../core/jsonMap\"],function(a,t,e){Object.defineProperty(t,\"__esModule\",{value:!0});var r=new e.default({MAP_ONLY:\"map-only\",\"A3 Landscape\":\"a3-landscape\",\"A3 Portrait\":\"a3-portrait\",\"A4 Landscape\":\"a4-landscape\",\"A4 Portrait\":\"a4-portrait\",\"Letter ANSI A Landscape\":\"letter-ansi-a-landscape\",\"Letter ANSI A Portrait\":\"letter-ansi-a-portrait\",\"Tabloid ANSI B Landscape\":\"tabloid-ansi-b-landscape\",\"Tabloid ANSI B Portrait\":\"tabloid-ansi-b-portrait\"});t.fromJSON=r.fromJSON.bind(r),t.toJSON=r.toJSON.bind(r)});","// COPYRIGHT © 2019 Esri\n//\n// All rights reserved under the copyright laws of the United States\n// and applicable international laws, treaties, and conventions.\n//\n// This material is licensed for use under the Esri Master License\n// Agreement (MLA), and is bound by the terms of that agreement.\n// You may redistribute and use this code without modification,\n// provided you adhere to the terms of the MLA and include this\n// copyright notice.\n//\n// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english\n//\n// For additional information, contact:\n// Environmental Systems Research Institute, Inc.\n// Attn: Contracts and Legal Services Department\n// 380 New York Street\n// Redlands, California, USA 92373\n// USA\n//\n// email: contracts@esri.com\n//\n// See http://js.arcgis.com/4.14/esri/copyright.txt for details.\n\ndefine([\"require\",\"exports\",\"@dojo/framework/shim/array\",\"../../Color\",\"../../core/screenUtils\",\"../../renderers/visualVariables/support/visualVariableUtils\"],function(e,r,t,i,n,a){function o(e,r){var t=r.graphic,o=r.renderer,l=r.symbol,y=l.type;if(y!==O&&y!==D&&\"visualVariables\"in o&&o.visualVariables){var s=o.getVisualVariablesForType(\"size\"),u=o.getVisualVariablesForType(\"color\"),p=o.getVisualVariablesForType(\"opacity\"),f=o.getVisualVariablesForType(\"rotation\"),c=s&&s[0],m=u&&u[0],g=p&&p[0],L=f&&f[0];if(c){var d=y===I?l.style:null,V=a.getSize(c,t,{shape:d});null!=V&&(y===I?e.size=n.px2pt(V):y===F?(e.width=n.px2pt(V),e.height=n.px2pt(V)):y===k?e.width=n.px2pt(V):e.outline&&(e.outline.width=n.px2pt(V)))}if(m){var b=a.getColor(m,t);(b&&y===I||y===k||y===C)&&(e.color=i.toJSON(b))}if(g){var v=a.getOpacity(g,t);null!=v&&e.color&&(e.color[3]=Math.round(255*v))}L&&(e.angle=-a.getRotationAngle(o,t))}}function l(){return{layerDefinition:{name:\"multipointLayer\",geometryType:\"esriGeometryMultipoint\",drawingInfo:{renderer:null}},featureSet:{geometryType:\"esriGeometryMultipoint\",features:[]}}}function y(){return{layerDefinition:{name:\"polygonLayer\",geometryType:\"esriGeometryPolygon\",drawingInfo:{renderer:null}},featureSet:{geometryType:\"esriGeometryPolygon\",features:[]}}}function s(){return{layerDefinition:{name:\"pointLayer\",geometryType:\"esriGeometryPoint\",drawingInfo:{renderer:null}},featureSet:{geometryType:\"esriGeometryPoint\",features:[]}}}function u(){return{layerDefinition:{name:\"polylineLayer\",geometryType:\"esriGeometryPolyline\",drawingInfo:{renderer:null}},featureSet:{geometryType:\"esriGeometryPolyline\",features:[]}}}function p(e,r){var i,n=e.allLayerViews.items;if(r===e.scale)i=n.filter(function(e){return!e.suspended});else{i=[];for(var a=0,o=n;a<o.length;a++){var l=o[a];d(l.parent)&&!t.includes(i,l.parent)||(!l.visible||r&&\"isVisibleAtScale\"in l&&!l.isVisibleAtScale(r)||i.push(l))}}return i}function f(e){return e&&\"bing-maps\"===e.type}function c(e){return e&&\"csv\"===e.type}function m(e){return e&&\"feature\"===e.type}function g(e){return e&&\"graphics\"===e.type}function L(e){return e&&\"group\"===e.type}function d(e){return e&&\"esri.views.layers.GroupLayerView\"===e.declaredClass}function V(e){return e&&\"imagery\"===e.type}function b(e){return e&&\"kml\"===e.type}function v(e){return e&&\"map-image\"===e.type}function T(e){return e&&\"map-notes\"===e.type}function w(e){return e&&\"open-street-map\"===e.type}function h(e){return e&&\"stream\"===e.type}function S(e){return e&&\"tile\"===e.type}function M(e){return e&&\"vector-tile\"===e.type}function G(e){return e&&\"web-tile\"===e.type}function P(e){return e&&\"wms\"===e.type}function x(e){return e&&\"wmts\"===e.type}Object.defineProperty(r,\"__esModule\",{value:!0});var I=\"simple-marker\",F=\"picture-marker\",k=\"simple-line\",C=\"simple-fill\",D=\"shield-label-symbol\",O=\"text\";r.applyVisualVariables=o,r.createMultipointLayer=l,r.createPolygonLayer=y,r.createPointLayer=s,r.createPolylineLayer=u,r.getVisibleLayerViews=p,r.isBingMapsLayer=f,r.isCSVLayer=c,r.isFeatureLayer=m,r.isGraphicsLayer=g,r.isGroupLayer=L,r.isImageryLayer=V,r.isKMLLayer=b,r.isMapImageLayer=v,r.isMapNotesLayer=T,r.isOpenStreetMapLayer=w,r.isStreamLayer=h,r.isTileLayer=S,r.isVectorTileLayer=M,r.isWebTileLayer=G,r.isWMSLayer=P,r.isWMTSLayer=x});","define([\"dojo/_base/kernel\", \"dojo/_base/lang\", \"dojo/_base/Color\", \"dojo/_base/sniff\", \"dojo/_base/window\",\n\t    \"dojo/_base/array\",\"dojo/dom\", \"dojo/dom-construct\",\"dojo/dom-geometry\"],\nfunction(kernel, lang, Color, has, win, arr, dom, domConstruct, domGeom){\n\t// module:\n\t//\t\tdojox/gfx\n\t// summary:\n\t//\t\tThis module contains common core Graphics API used by different graphics renderers.\n\n\tvar g = lang.getObject(\"dojox.gfx\", true),\n\t\tb = g._base = {};\n\t\n\t// candidates for dojox.style (work on VML and SVG nodes)\n\tg._hasClass = function(/*DomNode*/node, /*String*/classStr){\n\t\t// summary:\n\t\t//\t\tReturns whether or not the specified classes are a portion of the\n\t\t//\t\tclass list currently applied to the node.\n\t\t\n\t\t// return (new RegExp('(^|\\\\s+)'+classStr+'(\\\\s+|$)')).test(node.className)\t// Boolean\n\t\tvar cls = node.getAttribute(\"className\");\n\t\treturn cls && (\" \" + cls + \" \").indexOf(\" \" + classStr + \" \") >= 0;  // Boolean\n\t};\n\tg._addClass = function(/*DomNode*/node, /*String*/classStr){\n\t\t// summary:\n\t\t//\t\tAdds the specified classes to the end of the class list on the\n\t\t//\t\tpassed node.\n\t\tvar cls = node.getAttribute(\"className\") || \"\";\n\t\tif(!cls || (\" \" + cls + \" \").indexOf(\" \" + classStr + \" \") < 0){\n\t\t\tnode.setAttribute(\"className\", cls + (cls ? \" \" : \"\") + classStr);\n\t\t}\n\t};\n\tg._removeClass = function(/*DomNode*/node, /*String*/classStr){\n\t\t// summary:\n\t\t//\t\tRemoves classes from node.\n\t\tvar cls = node.getAttribute(\"className\");\n\t\tif(cls){\n\t\t\tnode.setAttribute(\n\t\t\t\t\"className\",\n\t\t\t\tcls.replace(new RegExp('(^|\\\\s+)' + classStr + '(\\\\s+|$)'), \"$1$2\")\n\t\t\t);\n\t\t}\n\t};\n\n\t// candidate for dojox.html.metrics (dynamic font resize handler is not implemented here)\n\n\t//\t\tderived from Morris John's emResized measurer\n\tb._getFontMeasurements = function(){\n\t\t// summary:\n\t\t//\t\tReturns an object that has pixel equivilents of standard font\n\t\t//\t\tsize values.\n\t\tvar heights = {\n\t\t\t'1em': 0, '1ex': 0, '100%': 0, '12pt': 0, '16px': 0, 'xx-small': 0,\n\t\t\t'x-small': 0, 'small': 0, 'medium': 0, 'large': 0, 'x-large': 0,\n\t\t\t'xx-large': 0\n\t\t};\n\t\tvar p, oldStyle;\t\n\t\tif(has(\"ie\")){\n\t\t\t//\tWe do a font-size fix if and only if one isn't applied already.\n\t\t\t// NOTE: If someone set the fontSize on the HTML Element, this will kill it.\n\t\t\toldStyle = win.doc.documentElement.style.fontSize || \"\";\n\t\t\tif(!oldStyle){\n\t\t\t\twin.doc.documentElement.style.fontSize=\"100%\";\n\t\t\t}\n\t\t}\n\n\t\t//\t\tset up the measuring node.\n\t\tvar div = domConstruct.create(\"div\", {style: {\n\t\t\t\tposition: \"absolute\",\n\t\t\t\tleft: \"0\",\n\t\t\t\ttop: \"-100px\",\n\t\t\t\twidth: \"30px\",\n\t\t\t\theight: \"1000em\",\n\t\t\t\tborderWidth: \"0\",\n\t\t\t\tmargin: \"0\",\n\t\t\t\tpadding: \"0\",\n\t\t\t\toutline: \"none\",\n\t\t\t\tlineHeight: \"1\",\n\t\t\t\toverflow: \"hidden\"\n\t\t\t}}, win.body());\n\n\t\t//\t\tdo the measurements.\n\t\tfor(p in heights){\n\t\t\tdiv.style.fontSize = p;\n\t\t\theights[p] = Math.round(div.offsetHeight * 12/16) * 16/12 / 1000;\n\t\t}\n\n\t\tif(has(\"ie\")){\n\t\t\t// Restore the font to its old style.\n\t\t\twin.doc.documentElement.style.fontSize = oldStyle;\n\t\t}\n\t\twin.body().removeChild(div);\n\t\treturn heights; //object\n\t};\n\n\tvar fontMeasurements = null;\n\n\tb._getCachedFontMeasurements = function(recalculate){\n\t\tif(recalculate || !fontMeasurements){\n\t\t\tfontMeasurements = b._getFontMeasurements();\n\t\t}\n\t\treturn fontMeasurements;\n\t};\n\n\t// candidate for dojox.html.metrics\n\n\tvar measuringNode = null, empty = {};\n\tb._getTextBox = function(\t/*String*/ text,\n\t\t\t\t\t\t\t\t/*Object*/ style,\n\t\t\t\t\t\t\t\t/*String?*/ className){\n\t\tvar m, s, al = arguments.length;\n\t\tvar i, box;\n\t\tif(!measuringNode){\n\t\t\tmeasuringNode = domConstruct.create(\"div\", {style: {\n\t\t\t\tposition: \"absolute\",\n\t\t\t\ttop: \"-10000px\",\n\t\t\t\tleft: \"0\",\n\t\t\t\tvisibility: \"hidden\"\n\t\t\t}}, win.body());\n\t\t}\n\t\tm = measuringNode;\n\t\t// reset styles\n\t\tm.className = \"\";\n\t\ts = m.style;\n\t\ts.borderWidth = \"0\";\n\t\ts.margin = \"0\";\n\t\ts.padding = \"0\";\n\t\ts.outline = \"0\";\n\t\t// set new style\n\t\tif(al > 1 && style){\n\t\t\tfor(i in style){\n\t\t\t\tif(i in empty){ continue; }\n\t\t\t\ts[i] = style[i];\n\t\t\t}\n\t\t}\n\t\t// set classes\n\t\tif(al > 2 && className){\n\t\t\tm.className = className;\n\t\t}\n\t\t// take a measure\n\t\tm.innerHTML = text;\n\n\t\tif(m.getBoundingClientRect){\n\t\t\tvar bcr = m.getBoundingClientRect();\n\t\t\tbox = {l: bcr.left, t: bcr.top, w: bcr.width || (bcr.right - bcr.left), h: bcr.height || (bcr.bottom - bcr.top)};\n\t\t}else{\n\t\t\tbox = domGeom.getMarginBox(m);\n\t\t}\n\t\tm.innerHTML = \"\";\n\t\treturn box;\n\t};\n\n\tb._computeTextLocation = function(/*g.defaultTextShape*/textShape, /*Number*/width, /*Number*/height, /*Boolean*/fixHeight) {\n\t\tvar loc = {}, align = textShape.align;\n\t\tswitch (align) {\n\t\t\tcase 'end':\n\t\t\t\tloc.x = textShape.x - width;\n\t\t\t\tbreak;\n\t\t\tcase 'middle':\n\t\t\t\tloc.x = textShape.x - width / 2;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tloc.x = textShape.x;\n\t\t\t\tbreak;\n\t\t}\n\t\tvar c = fixHeight ? 0.75 : 1;\n\t\tloc.y = textShape.y - height*c; // **rough** approximation of the ascent...\n\t\treturn loc;\n\t};\n\tb._computeTextBoundingBox = function(/*shape.Text*/s){\n\t\t// summary:\n\t\t//\t\tCompute the bbox of the given shape.Text instance. Note that this method returns an\n\t\t//\t\tapproximation of the bbox, and should be used when the underlying renderer cannot provide precise metrics.\n\t\tif(!g._base._isRendered(s)){\n\t\t\treturn {x:0, y:0, width:0, height:0};\n\t\t}\n\t\tvar loc, textShape = s.getShape(),\n\t\t\tfont = s.getFont() || g.defaultFont,\n\t\t\tw = s.getTextWidth(),\n\t\t\th = g.normalizedLength(font.size);\n\t\tloc = b._computeTextLocation(textShape, w, h, true);\n\t\treturn {\n\t\t\tx: loc.x,\n\t\t\ty: loc.y,\n\t\t\twidth: w,\n\t\t\theight: h\n\t\t};\n\t};\n\tb._isRendered = function(/*Shape*/s){\n\t\tvar p = s.parent;\n\t\twhile(p && p.getParent){\n\t\t\tp = p.parent;\n\t\t}\n\t\treturn p !== null;\n\t};\n\n\t// candidate for dojo.dom\n\n\tvar uniqueId = 0;\n\tb._getUniqueId = function(){\n\t\t// summary:\n\t\t//\t\treturns a unique string for use with any DOM element\n\t\tvar id;\n\t\tdo{\n\t\t\tid = kernel._scopeName + \"xUnique\" + (++uniqueId);\n\t\t}while(dom.byId(id));\n\t\treturn id;\n\t};\n\n\t// IE10\n\n\tvar touchActionProp = has(\"pointer-events\") ? \"touchAction\" : has(\"MSPointer\") ? \"msTouchAction\" : null;\n\tb._fixMsTouchAction = touchActionProp ? function(/*dojox/gfx/shape.Surface*/surface){\n\t\tsurface.rawNode.style[touchActionProp] = \"none\";\n\t} : function() {};\n\n\t/*=====\n\tg.Stroke = {\n\t\t// summary:\n\t\t//\t\tA stroke defines stylistic properties that are used when drawing a path.\n\n\t\t// color: String\n\t\t//\t\tThe color of the stroke, default value 'black'.\n\t\tcolor: \"black\",\n\n\t\t// style: String\n\t\t//\t\tThe style of the stroke, one of 'solid', ... . Default value 'solid'.\n\t\tstyle: \"solid\",\n\n\t\t// width: Number\n\t\t//\t\tThe width of a stroke, default value 1.\n\t\twidth: 1,\n\n\t\t// cap: String\n\t\t//\t\tThe endcap style of the path. One of 'butt', 'round', ... . Default value 'butt'.\n\t\tcap: \"butt\",\n\n\t\t// join: Number\n\t\t//\t\tThe join style to use when combining path segments. Default value 4.\n\t\tjoin: 4\n\t};\n\t\n\tg.Fill = {\n\t\t// summary:\n\t\t//\t\tDefines how to fill a shape. Four types of fills can be used: solid, linear gradient, radial gradient and pattern.\n\t\t//\t\tSee dojox/gfx.LinearGradient, dojox/gfx.RadialGradient and dojox/gfx.Pattern respectively for more information about the properties supported by each type.\n\t\t\n\t\t// type: String?\n\t\t//\t\tThe type of fill. One of 'linear', 'radial', 'pattern' or undefined. If not specified, a solid fill is assumed.\n\t\ttype:\"\",\n\t\t\n\t\t// color: String|dojo/Color?\n\t\t//\t\tThe color of a solid fill type.\n\t\tcolor:null,\n\t\t\n\t};\n\t\n\tg.LinearGradient = {\n\t\t// summary:\n\t\t//\t\tAn object defining the default stylistic properties used for Linear Gradient fills.\n\t\t//\t\tLinear gradients are drawn along a virtual line, which results in appearance of a rotated pattern in a given direction/orientation.\n\n\t\t// type: String\n\t\t//\t\tSpecifies this object is a Linear Gradient, value 'linear'\n\t\ttype: \"linear\",\n\n\t\t// x1: Number\n\t\t//\t\tThe X coordinate of the start of the virtual line along which the gradient is drawn, default value 0.\n\t\tx1: 0,\n\n\t\t// y1: Number\n\t\t//\t\tThe Y coordinate of the start of the virtual line along which the gradient is drawn, default value 0.\n\t\ty1: 0,\n\n\t\t// x2: Number\n\t\t//\t\tThe X coordinate of the end of the virtual line along which the gradient is drawn, default value 100.\n\t\tx2: 100,\n\n\t\t// y2: Number\n\t\t//\t\tThe Y coordinate of the end of the virtual line along which the gradient is drawn, default value 100.\n\t\ty2: 100,\n\n\t\t// colors: Array\n\t\t//\t\tAn array of colors at given offsets (from the start of the line).  The start of the line is\n\t\t//\t\tdefined at offest 0 with the end of the line at offset 1.\n\t\t//\t\tDefault value, [{ offset: 0, color: 'black'},{offset: 1, color: 'white'}], is a gradient from black to white.\n\t\tcolors: []\n\t};\n\t\n\tg.RadialGradient = {\n\t\t// summary:\n\t\t//\t\tSpecifies the properties for RadialGradients using in fills patterns.\n\n\t\t// type: String\n\t\t//\t\tSpecifies this is a RadialGradient, value 'radial'\n\t\ttype: \"radial\",\n\n\t\t// cx: Number\n\t\t//\t\tThe X coordinate of the center of the radial gradient, default value 0.\n\t\tcx: 0,\n\n\t\t// cy: Number\n\t\t//\t\tThe Y coordinate of the center of the radial gradient, default value 0.\n\t\tcy: 0,\n\n\t\t// r: Number\n\t\t//\t\tThe radius to the end of the radial gradient, default value 100.\n\t\tr: 100,\n\n\t\t// colors: Array\n\t\t//\t\tAn array of colors at given offsets (from the center of the radial gradient).\n\t\t//\t\tThe center is defined at offest 0 with the outer edge of the gradient at offset 1.\n\t\t//\t\tDefault value, [{ offset: 0, color: 'black'},{offset: 1, color: 'white'}], is a gradient from black to white.\n\t\tcolors: []\n\t};\n\t\n\tg.Pattern = {\n\t\t// summary:\n\t\t//\t\tAn object specifying the default properties for a Pattern using in fill operations.\n\n\t\t// type: String\n\t\t//\t\tSpecifies this object is a Pattern, value 'pattern'.\n\t\ttype: \"pattern\",\n\n\t\t// x: Number\n\t\t//\t\tThe X coordinate of the position of the pattern, default value is 0.\n\t\tx: 0,\n\n\t\t// y: Number\n\t\t//\t\tThe Y coordinate of the position of the pattern, default value is 0.\n\t\ty: 0,\n\n\t\t// width: Number\n\t\t//\t\tThe width of the pattern image, default value is 0.\n\t\twidth: 0,\n\n\t\t// height: Number\n\t\t//\t\tThe height of the pattern image, default value is 0.\n\t\theight: 0,\n\n\t\t// src: String\n\t\t//\t\tA url specifying the image to use for the pattern.\n\t\tsrc: \"\"\n\t};\n\n\tg.Text = {\n\t\t//\tsummary:\n\t\t//\t\tA keyword argument object defining both the text to be rendered in a VectorText shape,\n\t\t//\t\tand specifying position, alignment, and fitting.\n\t\t//\ttext: String\n\t\t//\t\tThe text to be rendered.\n\t\t//\tx: Number?\n\t\t//\t\tThe left coordinate for the text's bounding box.\n\t\t//\ty: Number?\n\t\t//\t\tThe top coordinate for the text's bounding box.\n\t\t//\twidth: Number?\n\t\t//\t\tThe width of the text's bounding box.\n\t\t//\theight: Number?\n\t\t//\t\tThe height of the text's bounding box.\n\t\t//\talign: String?\n\t\t//\t\tThe alignment of the text, as defined in SVG. Can be \"start\", \"end\" or \"middle\".\n\t\t//\tfitting: Number?\n\t\t//\t\tHow the text is to be fitted to the bounding box. Can be 0 (no fitting), 1 (fitting based on\n\t\t//\t\tpassed width of the bounding box and the size of the font), or 2 (fit text to the bounding box,\n\t\t//\t\tand ignore any size parameters).\n\t\t//\tleading: Number?\n\t\t//\t\tThe leading to be used between lines in the text.\n\t\t//\tdecoration: String?\n\t\t//\t\tAny text decoration to be used.\n\t};\n\n\tg.Font = {\n\t\t// summary:\n\t\t//\t\tAn object specifying the properties for a Font used in text operations.\n\t\n\t\t// type: String\n\t\t//\t\tSpecifies this object is a Font, value 'font'.\n\t\ttype: \"font\",\n\t\n\t\t// style: String\n\t\t//\t\tThe font style, one of 'normal', 'bold', default value 'normal'.\n\t\tstyle: \"normal\",\n\t\n\t\t// variant: String\n\t\t//\t\tThe font variant, one of 'normal', ... , default value 'normal'.\n\t\tvariant: \"normal\",\n\t\n\t\t// weight: String\n\t\t//\t\tThe font weight, one of 'normal', ..., default value 'normal'.\n\t\tweight: \"normal\",\n\t\n\t\t// size: String\n\t\t//\t\tThe font size (including units), default value '10pt'.\n\t\tsize: \"10pt\",\n\t\n\t\t// family: String\n\t\t//\t\tThe font family, one of 'serif', 'sanserif', ..., default value 'serif'.\n\t\tfamily: \"serif\"\n\t};\n\n\t=====*/\n\n\tlang.mixin(g, {\n\t\t// summary:\n\t\t//\t\tdefines constants, prototypes, and utility functions for the core Graphics API\n\n\t\t// default shapes, which are used to fill in missing parameters\n\t\tdefaultPath: {\n\t\t\t// summary:\n\t\t\t//\t\tDefines the default Path prototype object.\n\n\t\t\t// type: String\n\t\t\t//\t\tSpecifies this object is a Path, default value 'path'.\n\t\t\ttype: \"path\", \n\n\t\t\t// path: String\n\t\t\t//\t\tThe path commands. See W32C SVG 1.0 specification.\n\t\t\t//\t\tDefaults to empty string value.\n\t\t\tpath: \"\"\n\t\t},\n\t\tdefaultPolyline: {\n\t\t\t// summary:\n\t\t\t//\t\tDefines the default PolyLine prototype.\n\n\t\t\t// type: String\n\t\t\t//\t\tSpecifies this object is a PolyLine, default value 'polyline'.\n\t\t\ttype: \"polyline\",\n\n\t\t\t// points: Array\n\t\t\t//\t\tAn array of point objects [{x:0,y:0},...] defining the default polyline's line segments. Value is an empty array [].\n\t\t\tpoints: []\n\t\t},\n\t\tdefaultRect: {\n\t\t\t// summary:\n\t\t\t//\t\tDefines the default Rect prototype.\n\n\t\t\t// type: String\n\t\t\t//\t\tSpecifies this default object is a type of Rect. Value is 'rect'\n\t\t\ttype: \"rect\",\n\n\t\t\t// x: Number\n\t\t\t//\t\tThe X coordinate of the default rectangles position, value 0.\n\t\t\tx: 0,\n\n\t\t\t// y: Number\n\t\t\t//\t\tThe Y coordinate of the default rectangle's position, value 0.\n\t\t\ty: 0,\n\n\t\t\t// width: Number\n\t\t\t//\t\tThe width of the default rectangle, value 100.\n\t\t\twidth: 100,\n\n\t\t\t// height: Number\n\t\t\t//\t\tThe height of the default rectangle, value 100.\n\t\t\theight: 100,\n\n\t\t\t// r: Number\n\t\t\t//\t\tThe corner radius for the default rectangle, value 0.\n\t\t\tr: 0\n\t\t},\n\t\tdefaultEllipse: {\n\t\t\t// summary:\n\t\t\t//\t\tDefines the default Ellipse prototype.\n\n\t\t\t// type: String\n\t\t\t//\t\tSpecifies that this object is a type of Ellipse, value is 'ellipse'\n\t\t\ttype: \"ellipse\",\n\n\t\t\t// cx: Number\n\t\t\t//\t\tThe X coordinate of the center of the ellipse, default value 0.\n\t\t\tcx: 0,\n\n\t\t\t// cy: Number\n\t\t\t//\t\tThe Y coordinate of the center of the ellipse, default value 0.\n\t\t\tcy: 0,\n\n\t\t\t// rx: Number\n\t\t\t//\t\tThe radius of the ellipse in the X direction, default value 200.\n\t\t\trx: 200,\n\n\t\t\t// ry: Number\n\t\t\t//\t\tThe radius of the ellipse in the Y direction, default value 200.\n\t\t\try: 100\n\t\t},\n\t\tdefaultCircle: {\n\t\t\t// summary:\n\t\t\t//\t\tAn object defining the default Circle prototype.\n\n\t\t\t// type: String\n\t\t\t//\t\tSpecifies this object is a circle, value 'circle'\n\t\t\ttype: \"circle\",\n\n\t\t\t// cx: Number\n\t\t\t//\t\tThe X coordinate of the center of the circle, default value 0.\n\t\t\tcx: 0,\n\t\t\t// cy: Number\n\t\t\t//\t\tThe Y coordinate of the center of the circle, default value 0.\n\t\t\tcy: 0,\n\n\t\t\t// r: Number\n\t\t\t//\t\tThe radius, default value 100.\n\t\t\tr: 100\n\t\t},\n\t\tdefaultLine: {\n\t\t\t// summary:\n\t\t\t//\t\tAn object defining the default Line prototype.\n\n\t\t\t// type: String\n\t\t\t//\t\tSpecifies this is a Line, value 'line'\n\t\t\ttype: \"line\",\n\n\t\t\t// x1: Number\n\t\t\t//\t\tThe X coordinate of the start of the line, default value 0.\n\t\t\tx1: 0,\n\n\t\t\t// y1: Number\n\t\t\t//\t\tThe Y coordinate of the start of the line, default value 0.\n\t\t\ty1: 0,\n\n\t\t\t// x2: Number\n\t\t\t//\t\tThe X coordinate of the end of the line, default value 100.\n\t\t\tx2: 100,\n\n\t\t\t// y2: Number\n\t\t\t//\t\tThe Y coordinate of the end of the line, default value 100.\n\t\t\ty2: 100\n\t\t},\n\t\tdefaultImage: {\n\t\t\t// summary:\n\t\t\t//\t\tDefines the default Image prototype.\n\n\t\t\t// type: String\n\t\t\t//\t\tSpecifies this object is an image, value 'image'.\n\t\t\ttype: \"image\",\n\n\t\t\t// x: Number\n\t\t\t//\t\tThe X coordinate of the image's position, default value 0.\n\t\t\tx: 0,\n\n\t\t\t// y: Number\n\t\t\t//\t\tThe Y coordinate of the image's position, default value 0.\n\t\t\ty: 0,\n\n\t\t\t// width: Number\n\t\t\t//\t\tThe width of the image, default value 0.\n\t\t\twidth: 0,\n\n\t\t\t// height: Number\n\t\t\t//\t\tThe height of the image, default value 0.\n\t\t\theight: 0,\n\n\t\t\t// src: String\n\t\t\t//\t\tThe src url of the image, defaults to empty string.\n\t\t\tsrc: \"\"\n\t\t},\n\t\tdefaultText: {\n\t\t\t// summary:\n\t\t\t//\t\tDefines the default Text prototype.\n\n\t\t\t// type: String\n\t\t\t//\t\tSpecifies this is a Text shape, value 'text'.\n\t\t\ttype: \"text\",\n\n\t\t\t// x: Number\n\t\t\t//\t\tThe X coordinate of the text position, default value 0.\n\t\t\tx: 0,\n\n\t\t\t// y: Number\n\t\t\t//\t\tThe Y coordinate of the text position, default value 0.\n\t\t\ty: 0,\n\n\t\t\t// text: String\n\t\t\t//\t\tThe text to be displayed, default value empty string.\n\t\t\ttext: \"\",\n\n\t\t\t// align:\tString\n\t\t\t//\t\tThe horizontal text alignment, one of 'start', 'end', 'center'. Default value 'start'.\n\t\t\talign: \"start\",\n\n\t\t\t// decoration: String\n\t\t\t//\t\tThe text decoration , one of 'none', ... . Default value 'none'.\n\t\t\tdecoration: \"none\",\n\n\t\t\t// rotated: Boolean\n\t\t\t//\t\tWhether the text is rotated, boolean default value false.\n\t\t\trotated: false,\n\n\t\t\t// kerning: Boolean\n\t\t\t//\t\tWhether kerning is used on the text, boolean default value true.\n\t\t\tkerning: true\n\t\t},\n\t\tdefaultTextPath: {\n\t\t\t// summary:\n\t\t\t//\t\tDefines the default TextPath prototype.\n\n\t\t\t// type: String\n\t\t\t//\t\tSpecifies this is a TextPath, value 'textpath'.\n\t\t\ttype: \"textpath\",\n\n\t\t\t// text: String\n\t\t\t//\t\tThe text to be displayed, default value empty string.\n\t\t\ttext: \"\",\n\n\t\t\t// align: String\n\t\t\t//\t\tThe horizontal text alignment, one of 'start', 'end', 'center'. Default value 'start'.\n\t\t\talign: \"start\",\n\n\t\t\t// decoration: String\n\t\t\t//\t\tThe text decoration , one of 'none', ... . Default value 'none'.\n\t\t\tdecoration: \"none\",\n\n\t\t\t// rotated: Boolean\n\t\t\t//\t\tWhether the text is rotated, boolean default value false.\n\t\t\trotated: false,\n\n\t\t\t// kerning: Boolean\n\t\t\t//\t\tWhether kerning is used on the text, boolean default value true.\n\t\t\tkerning: true\n\t\t},\n\n\t\t// default stylistic attributes\n\t\tdefaultStroke: {\n\t\t\t// summary:\n\t\t\t//\t\tA stroke defines stylistic properties that are used when drawing a path.\n\t\t\t//\t\tThis object defines the default Stroke prototype.\n\t\t\t// type: String\n\t\t\t//\t\tSpecifies this object is a type of Stroke, value 'stroke'.\n\t\t\ttype: \"stroke\",\n\n\t\t\t// color: String\n\t\t\t//\t\tThe color of the stroke, default value 'black'.\n\t\t\tcolor: \"black\",\n\n\t\t\t// style: String\n\t\t\t//\t\tThe style of the stroke, one of 'solid', ... . Default value 'solid'.\n\t\t\tstyle: \"solid\",\n\n\t\t\t// width: Number\n\t\t\t//\t\tThe width of a stroke, default value 1.\n\t\t\twidth: 1,\n\n\t\t\t// cap: String\n\t\t\t//\t\tThe endcap style of the path. One of 'butt', 'round', ... . Default value 'butt'.\n\t\t\tcap: \"butt\",\n\n\t\t\t// join: Number\n\t\t\t//\t\tThe join style to use when combining path segments. Default value 4.\n\t\t\tjoin: 4\n\t\t},\n\t\tdefaultLinearGradient: {\n\t\t\t// summary:\n\t\t\t//\t\tAn object defining the default stylistic properties used for Linear Gradient fills.\n\t\t\t//\t\tLinear gradients are drawn along a virtual line, which results in appearance of a rotated pattern in a given direction/orientation.\n\n\t\t\t// type: String\n\t\t\t//\t\tSpecifies this object is a Linear Gradient, value 'linear'\n\t\t\ttype: \"linear\",\n\n\t\t\t// x1: Number\n\t\t\t//\t\tThe X coordinate of the start of the virtual line along which the gradient is drawn, default value 0.\n\t\t\tx1: 0,\n\n\t\t\t// y1: Number\n\t\t\t//\t\tThe Y coordinate of the start of the virtual line along which the gradient is drawn, default value 0.\n\t\t\ty1: 0,\n\n\t\t\t// x2: Number\n\t\t\t//\t\tThe X coordinate of the end of the virtual line along which the gradient is drawn, default value 100.\n\t\t\tx2: 100,\n\n\t\t\t// y2: Number\n\t\t\t//\t\tThe Y coordinate of the end of the virtual line along which the gradient is drawn, default value 100.\n\t\t\ty2: 100,\n\n\t\t\t// colors: Array\n\t\t\t//\t\tAn array of colors at given offsets (from the start of the line).  The start of the line is\n\t\t\t//\t\tdefined at offest 0 with the end of the line at offset 1.\n\t\t\t//\t\tDefault value, [{ offset: 0, color: 'black'},{offset: 1, color: 'white'}], is a gradient from black to white.\n\t\t\tcolors: [\n\t\t\t\t{ offset: 0, color: \"black\" }, { offset: 1, color: \"white\" }\n\t\t\t]\n\t\t},\n\t\tdefaultRadialGradient: {\n\t\t\t// summary:\n\t\t\t//\t\tAn object specifying the default properties for RadialGradients using in fills patterns.\n\n\t\t\t// type: String\n\t\t\t//\t\tSpecifies this is a RadialGradient, value 'radial'\n\t\t\ttype: \"radial\",\n\n\t\t\t// cx: Number\n\t\t\t//\t\tThe X coordinate of the center of the radial gradient, default value 0.\n\t\t\tcx: 0,\n\n\t\t\t// cy: Number\n\t\t\t//\t\tThe Y coordinate of the center of the radial gradient, default value 0.\n\t\t\tcy: 0,\n\n\t\t\t// r: Number\n\t\t\t//\t\tThe radius to the end of the radial gradient, default value 100.\n\t\t\tr: 100,\n\n\t\t\t// colors: Array\n\t\t\t//\t\tAn array of colors at given offsets (from the center of the radial gradient).\n\t\t\t//\t\tThe center is defined at offest 0 with the outer edge of the gradient at offset 1.\n\t\t\t//\t\tDefault value, [{ offset: 0, color: 'black'},{offset: 1, color: 'white'}], is a gradient from black to white.\n\t\t\tcolors: [\n\t\t\t\t{ offset: 0, color: \"black\" }, { offset: 1, color: \"white\" }\n\t\t\t]\n\t\t},\n\t\tdefaultPattern: {\n\t\t\t// summary:\n\t\t\t//\t\tAn object specifying the default properties for a Pattern using in fill operations.\n\n\t\t\t// type: String\n\t\t\t//\t\tSpecifies this object is a Pattern, value 'pattern'.\n\t\t\ttype: \"pattern\",\n\n\t\t\t// x: Number\n\t\t\t//\t\tThe X coordinate of the position of the pattern, default value is 0.\n\t\t\tx: 0,\n\n\t\t\t// y: Number\n\t\t\t//\t\tThe Y coordinate of the position of the pattern, default value is 0.\n\t\t\ty: 0,\n\n\t\t\t// width: Number\n\t\t\t//\t\tThe width of the pattern image, default value is 0.\n\t\t\twidth: 0,\n\n\t\t\t// height: Number\n\t\t\t//\t\tThe height of the pattern image, default value is 0.\n\t\t\theight: 0,\n\n\t\t\t// src: String\n\t\t\t//\t\tA url specifying the image to use for the pattern.\n\t\t\tsrc: \"\"\n\t\t},\n\t\tdefaultFont: {\n\t\t\t// summary:\n\t\t\t//\t\tAn object specifying the default properties for a Font used in text operations.\n\n\t\t\t// type: String\n\t\t\t//\t\tSpecifies this object is a Font, value 'font'.\n\t\t\ttype: \"font\",\n\n\t\t\t// style: String\n\t\t\t//\t\tThe font style, one of 'normal', 'bold', default value 'normal'.\n\t\t\tstyle: \"normal\",\n\n\t\t\t// variant: String\n\t\t\t//\t\tThe font variant, one of 'normal', ... , default value 'normal'.\n\t\t\tvariant: \"normal\",\n\n\t\t\t// weight: String\n\t\t\t//\t\tThe font weight, one of 'normal', ..., default value 'normal'.\n\t\t\tweight: \"normal\",\n\n\t\t\t// size: String\n\t\t\t//\t\tThe font size (including units), default value '10pt'.\n\t\t\tsize: \"10pt\",\n\n\t\t\t// family: String\n\t\t\t//\t\tThe font family, one of 'serif', 'sanserif', ..., default value 'serif'.\n\t\t\tfamily: \"serif\"\n\t\t},\n\n\t\tgetDefault: (function(){\n\t\t\t// summary:\n\t\t\t//\t\tReturns a function used to access default memoized prototype objects (see them defined above).\n\t\t\tvar typeCtorCache = {};\n\t\t\t// a memoized delegate()\n\t\t\treturn function(/*String*/ type){\n\t\t\t\tvar t = typeCtorCache[type];\n\t\t\t\tif(t){\n\t\t\t\t\treturn new t();\n\t\t\t\t}\n\t\t\t\tt = typeCtorCache[type] = new Function();\n\t\t\t\tt.prototype = g[ \"default\" + type ];\n\t\t\t\treturn new t();\n\t\t\t}\n\t\t})(),\n\n\t\tnormalizeColor: function(/*dojo/Color|Array|string|Object*/ color){\n\t\t\t// summary:\n\t\t\t//\t\tconverts any legal color representation to normalized\n\t\t\t//\t\tdojo/Color object\n\t\t\t// color:\n\t\t\t//\t\tA color representation.\n\t\t\treturn (color instanceof Color) ? color : new Color(color); // dojo/Color\n\t\t},\n\t\tnormalizeParameters: function(existed, update){\n\t\t\t// summary:\n\t\t\t//\t\tupdates an existing object with properties from an 'update'\n\t\t\t//\t\tobject\n\t\t\t// existed: Object\n\t\t\t//\t\tthe target object to be updated\n\t\t\t// update: Object\n\t\t\t//\t\tthe 'update' object, whose properties will be used to update\n\t\t\t//\t\tthe existed object\n\t\t\tvar x;\n\t\t\tif(update){\n\t\t\t\tvar empty = {};\n\t\t\t\tfor(x in existed){\n\t\t\t\t\tif(x in update && !(x in empty)){\n\t\t\t\t\t\texisted[x] = update[x];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn existed;\t// Object\n\t\t},\n\t\tmakeParameters: function(defaults, update){\n\t\t\t// summary:\n\t\t\t//\t\tcopies the original object, and all copied properties from the\n\t\t\t//\t\t'update' object\n\t\t\t// defaults: Object\n\t\t\t//\t\tthe object to be cloned before updating\n\t\t\t// update: Object\n\t\t\t//\t\tthe object, which properties are to be cloned during updating\n\t\t\t// returns: Object\n\t\t\t//      new object with new and default properties\n\t\t\tvar i = null;\n\t\t\tif(!update){\n\t\t\t\t// return dojo.clone(defaults);\n\t\t\t\treturn lang.delegate(defaults);\n\t\t\t}\n\t\t\tvar result = {};\n\t\t\tfor(i in defaults){\n\t\t\t\tif(!(i in result)){\n\t\t\t\t\tresult[i] = lang.clone((i in update) ? update[i] : defaults[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn result; // Object\n\t\t},\n\t\tformatNumber: function(x, addSpace){\n\t\t\t// summary:\n\t\t\t//\t\tconverts a number to a string using a fixed notation\n\t\t\t// x: Number\n\t\t\t//\t\tnumber to be converted\n\t\t\t// addSpace: Boolean\n\t\t\t//\t\twhether to add a space before a positive number\n\t\t\t// returns: String\n\t\t\t//      the formatted value\n\t\t\tvar val = x.toString();\n\t\t\tif(val.indexOf(\"e\") >= 0){\n\t\t\t\tval = x.toFixed(4);\n\t\t\t}else{\n\t\t\t\tvar point = val.indexOf(\".\");\n\t\t\t\tif(point >= 0 && val.length - point > 5){\n\t\t\t\t\tval = x.toFixed(4);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(x < 0){\n\t\t\t\treturn val; // String\n\t\t\t}\n\t\t\treturn addSpace ? \" \" + val : val; // String\n\t\t},\n\t\t// font operations\n\t\tmakeFontString: function(font){\n\t\t\t// summary:\n\t\t\t//\t\tconverts a font object to a CSS font string\n\t\t\t// font: Object\n\t\t\t//\t\tfont object (see dojox/gfx.defaultFont)\n\t\t\treturn font.style + \" \" + font.variant + \" \" + font.weight + \" \" + font.size + \" \" + font.family; // Object\n\t\t},\n\t\tsplitFontString: function(str){\n\t\t\t// summary:\n\t\t\t//\t\tconverts a CSS font string to a font object\n\t\t\t// description:\n\t\t\t//\t\tConverts a CSS font string to a gfx font object. The CSS font\n\t\t\t//\t\tstring components should follow the W3C specified order\n\t\t\t//\t\t(see http://www.w3.org/TR/CSS2/fonts.html#font-shorthand):\n\t\t\t//\t\tstyle, variant, weight, size, optional line height (will be\n\t\t\t//\t\tignored), and family. Note that the Font.size attribute is limited to numeric CSS length.\n\t\t\t// str: String\n\t\t\t//\t\ta CSS font string.\n\t\t\t// returns: Object\n\t\t\t//      object in dojox/gfx.defaultFont format\n\t\t\tvar font = g.getDefault(\"Font\");\n\t\t\tvar t = str.split(/\\s+/);\n\t\t\tdo{\n\t\t\t\tif(t.length < 5){ break; }\n\t\t\t\tfont.style   = t[0];\n\t\t\t\tfont.variant = t[1];\n\t\t\t\tfont.weight  = t[2];\n\t\t\t\tvar i = t[3].indexOf(\"/\");\n\t\t\t\tfont.size = i < 0 ? t[3] : t[3].substring(0, i);\n\t\t\t\tvar j = 4;\n\t\t\t\tif(i < 0){\n\t\t\t\t\tif(t[4] == \"/\"){\n\t\t\t\t\t\tj = 6;\n\t\t\t\t\t}else if(t[4].charAt(0) == \"/\"){\n\t\t\t\t\t\tj = 5;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(j < t.length){\n\t\t\t\t\tfont.family = t.slice(j).join(\" \");\n\t\t\t\t}\n\t\t\t}while(false);\n\t\t\treturn font;\t// Object\n\t\t},\n\t\t// length operations\n\n\t\t// cm_in_pt: Number\n\t\t//\t\tpoints per centimeter (constant)\n\t\tcm_in_pt: 72 / 2.54,\n\n\t\t// mm_in_pt: Number\n\t\t//\t\tpoints per millimeter (constant)\n\t\tmm_in_pt: 7.2 / 2.54,\n\n\t\tpx_in_pt: function(){\n\t\t\t// summary:\n\t\t\t//\t\treturns the current number of pixels per point.\n\t\t\treturn g._base._getCachedFontMeasurements()[\"12pt\"] / 12;\t// Number\n\t\t},\n\n\t\tpt2px: function(len){\n\t\t\t// summary:\n\t\t\t//\t\tconverts points to pixels\n\t\t\t// len: Number\n\t\t\t//\t\ta value in points\n\t\t\treturn len * g.px_in_pt();\t// Number\n\t\t},\n\n\t\tpx2pt: function(len){\n\t\t\t// summary:\n\t\t\t//\t\tconverts pixels to points\n\t\t\t// len: Number\n\t\t\t//\t\ta value in pixels\n\t\t\treturn len / g.px_in_pt();\t// Number\n\t\t},\n\n\t\tnormalizedLength: function(len) {\n\t\t\t// summary:\n\t\t\t//\t\tconverts any length value to pixels\n\t\t\t// len: String\n\t\t\t//\t\ta length, e.g., '12pc'\n\t\t\t// returns: Number\n\t\t\t//      pixels\n\t\t\tif(len.length === 0){ return 0; }\n\t\t\tif(len.length > 2){\n\t\t\t\tvar px_in_pt = g.px_in_pt();\n\t\t\t\tvar val = parseFloat(len);\n\t\t\t\tswitch(len.slice(-2)){\n\t\t\t\t\tcase \"px\": return val;\n\t\t\t\t\tcase \"pt\": return val * px_in_pt;\n\t\t\t\t\tcase \"in\": return val * 72 * px_in_pt;\n\t\t\t\t\tcase \"pc\": return val * 12 * px_in_pt;\n\t\t\t\t\tcase \"mm\": return val * g.mm_in_pt * px_in_pt;\n\t\t\t\t\tcase \"cm\": return val * g.cm_in_pt * px_in_pt;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn parseFloat(len);\t// Number\n\t\t},\n\n\t\t// pathVmlRegExp: RegExp\n\t\t//\t\ta constant regular expression used to split a SVG/VML path into primitive components\n\t\t// tags:\n\t\t//\t\tprivate\n\t\tpathVmlRegExp: /([A-Za-z]+)|(\\d+(\\.\\d+)?)|(\\.\\d+)|(-\\d+(\\.\\d+)?)|(-\\.\\d+)/g,\n\n\t\t// pathVmlRegExp: RegExp\n\t\t//\t\ta constant regular expression used to split a SVG/VML path into primitive components\n\t\t// tags:\n\t\t//\t\tprivate\n\t\tpathSvgRegExp: /([A-DF-Za-df-z])|([-+]?\\d*[.]?\\d+(?:[eE][-+]?\\d+)?)/g,\n\n\t\tequalSources: function(a, b){\n\t\t\t// summary:\n\t\t\t//\t\tcompares event sources, returns true if they are equal\n\t\t\t// a: Object\n\t\t\t//\t\tfirst event source\n\t\t\t// b: Object\n\t\t\t//\t\tevent source to compare against a\n\t\t\t// returns: Boolean\n\t\t\t//      true, if objects are truthy and the same\n\t\t\treturn a && b && a === b;\n\t\t},\n\n\t\tswitchTo: function(/*String|Object*/ renderer){\n\t\t\t// summary:\n\t\t\t//\t\tswitch the graphics implementation to the specified renderer.\n\t\t\t// renderer:\n\t\t\t//\t\tEither the string name of a renderer (eg. 'canvas', 'svg, ...) or the renderer\n\t\t\t//\t\tobject to switch to.\n\t\t\tvar ns = typeof renderer == \"string\" ? g[renderer] : renderer;\n\t\t\tif(ns){\n\t\t\t\t// If more options are added, update the docblock at the end of shape.js!\n\t\t\t\tarr.forEach([\"Group\", \"Rect\", \"Ellipse\", \"Circle\", \"Line\",\n\t\t\t\t\t\t\"Polyline\", \"Image\", \"Text\", \"Path\", \"TextPath\",\n\t\t\t\t\t\t\"Surface\", \"createSurface\", \"fixTarget\"], function(name){\n\t\t\t\t\tg[name] = ns[name];\n\t\t\t\t});\n\t\t\t\tif(typeof renderer == \"string\"){\n\t\t\t\t\tg.renderer = renderer;\n\t\t\t\t}else{\n\t\t\t\t\tarr.some([\"svg\",\"vml\",\"canvas\",\"canvasWithEvents\",\"silverlight\"], function(r){\n\t\t\t\t\t\treturn (g.renderer = g[r] && g[r].Surface === g.Surface ? r : null);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\t\n\t/*=====\n\t\tg.createSurface = function(parentNode, width, height){\n\t\t\t// summary:\n\t\t\t//\t\tcreates a surface\n\t\t\t// parentNode: Node\n\t\t\t//\t\ta parent node\n\t\t\t// width: String|Number\n\t\t\t//\t\twidth of surface, e.g., \"100px\" or 100\n\t\t\t// height: String|Number\n\t\t\t//\t\theight of surface, e.g., \"100px\" or 100\n\t\t\t// returns: dojox/gfx.Surface\n\t\t\t//     newly created surface\n\t\t};\n\t\tg.fixTarget = function(){\n\t\t\t// tags:\n\t\t\t//\t\tprivate\n\t\t};\n\t=====*/\n\t\n\treturn g; // defaults object api\n});\n","define([\"./_base\", \"dojo/_base/lang\", \"./matrix\"], \n  function(g, lang, m){\n\tvar twoPI = 2 * Math.PI, pi4 = Math.PI / 4, pi8 = Math.PI / 8,\n\t\tpi48 = pi4 + pi8, curvePI4 = unitArcAsBezier(pi8);\n\n\tfunction unitArcAsBezier(alpha){\n\t\t// summary:\n\t\t//\t\treturn a start point, 1st and 2nd control points, and an end point of\n\t\t//\t\ta an arc, which is reflected on the x axis\n\t\t// alpha: Number\n\t\t//\t\tangle in radians, the arc will be 2 * angle size\n\t\tvar cosa  = Math.cos(alpha), sina  = Math.sin(alpha),\n\t\t\tp2 = {x: cosa + (4 / 3) * (1 - cosa), y: sina - (4 / 3) * cosa * (1 - cosa) / sina};\n\t\treturn {\t// Object\n\t\t\ts:  {x: cosa, y: -sina},\n\t\t\tc1: {x: p2.x, y: -p2.y},\n\t\t\tc2: p2,\n\t\t\te:  {x: cosa, y: sina}\n\t\t};\n\t}\n\n\tvar arc = g.arc = {\n\t\t// summary:\n\t\t//\t\tThis module contains the core graphics Arc functions.\n\t\t\n\t\tunitArcAsBezier: unitArcAsBezier,\n\t\t/*===== \n\t\tunitArcAsBezier: function(alpha) {\n\t\t\t// summary:\n\t\t\t//\t\treturn a start point, 1st and 2nd control points, and an end point of\n\t\t\t//\t\ta an arc, which is reflected on the x axis\n\t\t\t// alpha: Number\n\t\t\t//\t\tangle in radians, the arc will be 2 * angle size\n\t\t},\n\t\t=====*/\n\n\t\t// curvePI4: Object\n\t\t//\t\tan object with properties of an arc around a unit circle from 0 to pi/4\n\t\tcurvePI4: curvePI4,\n\n\t\tarcAsBezier: function(last, rx, ry, xRotg, large, sweep, x, y){\n\t\t\t// summary:\n\t\t\t//\t\tcalculates an arc as a series of Bezier curves\n\t\t\t//\t\tgiven the last point and a standard set of SVG arc parameters,\n\t\t\t//\t\tit returns an array of arrays of parameters to form a series of\n\t\t\t//\t\tabsolute Bezier curves.\n\t\t\t// last: Object\n\t\t\t//\t\ta point-like object as a start of the arc\n\t\t\t// rx: Number\n\t\t\t//\t\ta horizontal radius for the virtual ellipse\n\t\t\t// ry: Number\n\t\t\t//\t\ta vertical radius for the virtual ellipse\n\t\t\t// xRotg: Number\n\t\t\t//\t\ta rotation of an x axis of the virtual ellipse in degrees\n\t\t\t// large: Boolean\n\t\t\t//\t\twhich part of the ellipse will be used (the larger arc if true)\n\t\t\t// sweep: Boolean\n\t\t\t//\t\tdirection of the arc (CW if true)\n\t\t\t// x: Number\n\t\t\t//\t\tthe x coordinate of the end point of the arc\n\t\t\t// y: Number\n\t\t\t//\t\tthe y coordinate of the end point of the arc\n\n\t\t\t// calculate parameters\n\t\t\tlarge = Boolean(large);\n\t\t\tsweep = Boolean(sweep);\n\t\t\tvar xRot = m._degToRad(xRotg),\n\t\t\t\trx2 = rx * rx, ry2 = ry * ry,\n\t\t\t\tpa = m.multiplyPoint(\n\t\t\t\t\tm.rotate(-xRot),\n\t\t\t\t\t{x: (last.x - x) / 2, y: (last.y - y) / 2}\n\t\t\t\t),\n\t\t\t\tpax2 = pa.x * pa.x, pay2 = pa.y * pa.y,\n\t\t\t\tc1 = Math.sqrt((rx2 * ry2 - rx2 * pay2 - ry2 * pax2) / (rx2 * pay2 + ry2 * pax2));\n\t\t\tif(isNaN(c1)){ c1 = 0; }\n\t\t\tvar\tca = {\n\t\t\t\t\tx:  c1 * rx * pa.y / ry,\n\t\t\t\t\ty: -c1 * ry * pa.x / rx\n\t\t\t\t};\n\t\t\tif(large == sweep){\n\t\t\t\tca = {x: -ca.x, y: -ca.y};\n\t\t\t}\n\t\t\t// the center\n\t\t\tvar c = m.multiplyPoint(\n\t\t\t\t[\n\t\t\t\t\tm.translate(\n\t\t\t\t\t\t(last.x + x) / 2,\n\t\t\t\t\t\t(last.y + y) / 2\n\t\t\t\t\t),\n\t\t\t\t\tm.rotate(xRot)\n\t\t\t\t],\n\t\t\t\tca\n\t\t\t);\n\t\t\t// calculate the elliptic transformation\n\t\t\tvar elliptic_transform = m.normalize([\n\t\t\t\tm.translate(c.x, c.y),\n\t\t\t\tm.rotate(xRot),\n\t\t\t\tm.scale(rx, ry)\n\t\t\t]);\n\t\t\t// start, end, and size of our arc\n\t\t\tvar inversed = m.invert(elliptic_transform),\n\t\t\t\tsp = m.multiplyPoint(inversed, last),\n\t\t\t\tep = m.multiplyPoint(inversed, x, y),\n\t\t\t\tstartAngle = Math.atan2(sp.y, sp.x),\n\t\t\t\tendAngle   = Math.atan2(ep.y, ep.x),\n\t\t\t\ttheta = startAngle - endAngle;\t// size of our arc in radians\n\t\t\tif(sweep){ theta = -theta; }\n\t\t\tif(theta < 0){\n\t\t\t\ttheta += twoPI;\n\t\t\t}else if(theta > twoPI){\n\t\t\t\ttheta -= twoPI;\n\t\t\t}\n\n\t\t\t// draw curve chunks\n\t\t\tvar alpha = pi8, curve = curvePI4, step  = sweep ? alpha : -alpha,\n\t\t\t\tresult = [];\n\t\t\tfor(var angle = theta; angle > 0; angle -= pi4){\n\t\t\t\tif(angle < pi48){\n\t\t\t\t\talpha = angle / 2;\n\t\t\t\t\tcurve = unitArcAsBezier(alpha);\n\t\t\t\t\tstep  = sweep ? alpha : -alpha;\n\t\t\t\t\tangle = 0;\t// stop the loop\n\t\t\t\t}\n\t\t\t\tvar c2, e, M = m.normalize([elliptic_transform, m.rotate(startAngle + step)]);\n\t\t\t\tif(sweep){\n\t\t\t\t\tc1 = m.multiplyPoint(M, curve.c1);\n\t\t\t\t\tc2 = m.multiplyPoint(M, curve.c2);\n\t\t\t\t\te  = m.multiplyPoint(M, curve.e );\n\t\t\t\t}else{\n\t\t\t\t\tc1 = m.multiplyPoint(M, curve.c2);\n\t\t\t\t\tc2 = m.multiplyPoint(M, curve.c1);\n\t\t\t\t\te  = m.multiplyPoint(M, curve.s );\n\t\t\t\t}\n\t\t\t\t// draw the curve\n\t\t\t\tresult.push([c1.x, c1.y, c2.x, c2.y, e.x, e.y]);\n\t\t\t\tstartAngle += 2 * step;\n\t\t\t}\n\t\t\treturn result;\t// Array\n\t\t}\n\t};\n\t\n\treturn arc;\n});\n","define([\n\t\"./_base\"\n], function(gfx){\n\n\tvar bu = gfx.bezierutils = {},\n\t\terror = 0.1;\n\n\tvar tAtLength = bu.tAtLength = function(points, length){\n\t\t// summary:\n\t\t//\t\tReturns the t corresponding to the given length for the specified bezier curve.\n\t\t// points: Number[]\n\t\t//\t\tThe bezier points. Should be [p1x, p1y, c1x, c1y, c2x, c2y, p2x, p2y] for a cubic\n\t\t//\t\tbezier curve or [p1x, p1y, cx, cy, p2x, p2y] for a quadratic bezier curve.\n\t\t// length: Number\n\t\t//\t\tThe length.\n\t\tvar t = 0,\n\t\t\tquadratic = points.length == 6,\n\t\t\tcurrentLen = 0,\n\t\t\tsplitCount = 0,\n\t\t\tsplitFunc = quadratic ? splitQBezierAtT : splitBezierAtT;\n\t\tvar _compute = function(p, error){\n\t\t\t// control points polygon length\n\t\t\tvar pLen = 0;\n\t\t\tfor(var i = 0; i < p.length-2; i+=2)\n\t\t\t\tpLen += distance(p[i],p[i+1],p[i+2],p[i+3]);\n\t\t\t// chord length\n\t\t\tvar chord = quadratic ?\n\t\t\t\tdistance(points[0],points[1],points[4],points[5]) :\n\t\t\t\tdistance(points[0],points[1],points[6],points[7]);\n\t\t\t// if needs more approx. or if currentLen is greater than the target length,\n\t\t\t// split the curve one more time\n\t\t\tif(pLen - chord > error || currentLen + pLen > length + error){\n\t\t\t\t++splitCount;\n\t\t\t\tvar newbezier = splitFunc(p, .5);\n\t\t\t\t// check 1st subpath\n\t\t\t\t_compute(newbezier[0], error);\n\t\t\t\t// the 1st subcurve was the good one, we stop\n\t\t\t\tif(Math.abs(currentLen - length) <= error){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// need to continue with the 2nde subcurve\n\t\t\t\t_compute(newbezier[1], error);\n\t\t\t\treturn ;\n\t\t\t}\n\t\t\tcurrentLen += pLen;\n\t\t\tt += 1.0 / (1 << splitCount);\n\t\t};\n\t\tif(length)\n\t\t\t_compute(points, 0.5);\n\t\treturn t;\n\t};\n\n\tvar computeLength = bu.computeLength = function(/*Array*/points){\n\t\t// summary:\n\t\t//\t\tReturns the length of the given bezier curve.\n\t\t// points: Number[]\n\t\t//\t\tThe bezier points. Should be [p1x, p1y, c1x, c1y, c2x, c2y, p2x, p2y] for a cubic\n\t\t//\t\tbezier curve or [p1x, p1y, cx, cy, p2x, p2y] for a quadratic bezier curve.\n\n\t\tvar quadratic = points.length == 6, pLen=0;\n\t\t// control points polygon length\n\t\tfor(var i = 0; i < points.length-2; i+=2)\n\t\t\tpLen += distance(points[i],points[i+1],points[i+2],points[i+3]);\n\t\t// chord length\n\t\tvar chord = quadratic ?\n\t\t\tdistance(points[0],points[1],points[4],points[5]) :\n\t\t\tdistance(points[0],points[1],points[6],points[7]);\n\t\t// split polygons until the polygon and the chord are \"the same\"\n\t\tif(pLen-chord>error){\n\t\t\tvar newBeziers = quadratic ? splitQBezierAtT(points,.5) : splitCBezierAtT(points,.5);\n\t\t\tvar length = computeLength(newBeziers[0], quadratic);\n\t\t\tlength += computeLength(newBeziers[1], quadratic);\n\t\t\treturn length;\n\t\t}\n\t\t// pLen is close enough, done.\n\t\treturn pLen;\n\t};\n\n\tvar distance = bu.distance = function(x1, y1, x2, y2){\n\t\t// summary:\n\t\t//\t\tReturns the distance between the specified points.\n\t\treturn Math.sqrt((x2-x1)*(x2-x1)+(y2-y1)*(y2-y1));\n\t};\n\n\tvar splitQBezierAtT = function(points, t){\n\t\t// summary:\n\t\t//\t\tSplit a quadratic bezier curve into 2 sub-quadratic beziers at the specified t.\n\n\t\t// de Casteljau\n\t\tvar r = 1-t,\n\t\t\tr2 = r*r,\n\t\t\tt2 = t*t,\n\t\t\tp1x = points[0],\n\t\t\tp1y = points[1],\n\t\t\tcx = points[2],\n\t\t\tcy = points[3],\n\t\t\tp2x = points[4],\n\t\t\tp2y = points[5],\n\n\t\t\tax = r*p1x + t*cx,\n\t\t\tay = r*p1y + t*cy,\n\t\t\tbx = r*cx + t*p2x,\n\t\t\tby = r*cy + t*p2y,\n\t\t\tpx = r2*p1x + 2*r*t*cx + t2*p2x,\n\t\t\tpy = r2*p1y + 2*r*t*cy + t2*p2y;\n\n\t\treturn [\n\t\t\t[\n\t\t\t\tp1x, p1y,\n\t\t\t\tax, ay,\n\t\t\t\tpx, py\n\t\t\t],\n\t\t\t[\n\t\t\t\tpx, py,\n\t\t\t\tbx, by,\n\t\t\t\tp2x, p2y\n\t\t\t]\n\t\t];\n\t};\n\n\tvar splitCBezierAtT = function(points, t){\n\t\t// summary:\n\t\t//\t\tSplit a cubic bezier curve into 2 sub-cubic beziers at the specified t.\n\n\t\t// de Casteljau\n\t\tvar r = 1-t,\n\t\t\tr2 = r*r,\n\t\t\tr3 = r2*r,\n\t\t\tt2 = t*t,\n\t\t\tt3 = t2*t,\n\t\t\tp1x = points[0],\n\t\t\tp1y = points[1],\n\t\t\tc1x = points[2],\n\t\t\tc1y = points[3],\n\t\t\tc2x = points[4],\n\t\t\tc2y = points[5],\n\t\t\tp2x = points[6],\n\t\t\tp2y = points[7],\n\n\t\t\tax = r*p1x + t*c1x,\n\t\t\tay = r*p1y + t*c1y,\n\t\t\tcx = r*c2x + t*p2x,\n\t\t\tcy = r*c2y + t*p2y,\n\t\t\tmx = r2*p1x + 2*r*t*c1x + t2*c2x,\n\t\t\tmy = r2*p1y + 2*r*t*c1y + t2*c2y,\n\t\t\tnx = r2*c1x + 2*r*t*c2x + t2*p2x,\n\t\t\tny = r2*c1y + 2*r*t*c2y + t2*p2y,\n\t\t\tpx = r3*p1x + 3*r2*t*c1x + 3*r*t2*c2x+t3*p2x,\n\t\t\tpy = r3*p1y + 3*r2*t*c1y + 3*r*t2*c2y+t3*p2y;\n\n\t\treturn [\n\t\t\t[\n\t\t\t\tp1x, p1y,\n\t\t\t\tax, ay,\n\t\t\t\tmx, my,\n\t\t\t\tpx, py\n\t\t\t],\n\t\t\t[\n\t\t\t\tpx, py,\n\t\t\t\tnx, ny,\n\t\t\t\tcx, cy,\n\t\t\t\tp2x, p2y\n\t\t\t]\n\t\t];\n\t};\n\n\tvar splitBezierAtT = bu.splitBezierAtT = function(points, t){\n\t\treturn points.length == 6 ? splitQBezierAtT(points, t) : splitCBezierAtT(points, t);\n\t};\n\treturn bu;\n});","define([\"./_base\", \"dojo/_base/lang\", \"dojo/_base/array\", \"dojo/_base/declare\", \"dojo/_base/window\", \"dojo/dom-geometry\",\n\t\t\"dojo/dom\", \"./shape\", \"./path\", \"./arc\", \"./matrix\", \"./decompose\", \"./bezierutils\"],\nfunction(g, lang, arr, declare, win, domGeom, dom, gs, pathLib, ga, m, decompose, bezierUtils ){\n\tvar canvas = g.canvas = {\n\t\t// summary:\n\t\t//\t\tThis the graphics rendering bridge for W3C Canvas compliant browsers.\n\t\t//\t\tSince Canvas is an immediate mode graphics api, with no object graph or\n\t\t//\t\teventing capabilities, use of this module alone will only add in drawing support.\n\t\t//\t\tThe additional module, canvasWithEvents extends this module with additional support\n\t\t//\t\tfor handling events on Canvas.  By default, the support for events is now included\n\t\t//\t\thowever, if only drawing capabilities are needed, canvas event module can be disabled\n\t\t//\t\tusing the dojoConfig option, canvasEvents:true|false.\n\t\t//\t\tThe id of the Canvas renderer is 'canvas'.  This id can be used when switch Dojo's\n\t\t//\t\tgraphics context between renderer implementations.  See dojox/gfx/_base.switchRenderer\n\t\t//\t\tAPI.\n\t};\n\tvar pattrnbuffer = null,\n\t\tmp = m.multiplyPoint,\n\t\tpi = Math.PI,\n\t\ttwoPI = 2 * pi,\n\t\thalfPI = pi /2,\n\t\textend = lang.extend;\n\n\tif(win.global.CanvasRenderingContext2D){\n\t\tvar ctx2d = win.doc.createElement(\"canvas\").getContext(\"2d\");\n\t\tvar hasNativeDash = typeof ctx2d.setLineDash == \"function\";\n\t\tvar hasFillText = typeof ctx2d.fillText == \"function\";\n\t}\n\n\tvar dasharray = {\n\t\tsolid:\t\t\t\t\"none\",\n\t\tshortdash:\t\t\t[4, 1],\n\t\tshortdot:\t\t\t[1, 1],\n\t\tshortdashdot:\t\t[4, 1, 1, 1],\n\t\tshortdashdotdot:\t[4, 1, 1, 1, 1, 1],\n\t\tdot:\t\t\t\t[1, 3],\n\t\tdash:\t\t\t\t[4, 3],\n\t\tlongdash:\t\t\t[8, 3],\n\t\tdashdot:\t\t\t[4, 3, 1, 3],\n\t\tlongdashdot:\t\t[8, 3, 1, 3],\n\t\tlongdashdotdot:\t\t[8, 3, 1, 3, 1, 3]\n\t};\n\n\tfunction drawDashedArc(/*CanvasRenderingContext2D*/ctx, /*Number[]*/dash,  /*int*/cx,  /*int*/cy,  /*int*/r, /*Number*/sa, /*Number*/ea, /*Boolean*/ccw, /*Boolean?*/apply, prevResidue){\n\t\tvar residue, angle, l = dash.length, i= 0;\n\t\t// if there's a previous dash residue from the previous arc, start with it.\n\t\tif(prevResidue){\n\t\t\tangle = prevResidue.l/r;\n\t\t\ti = prevResidue.i;\n\t\t}else{\n\t\t\tangle = dash[0]/r;\n\t\t}\n\t\twhile(sa < ea){\n\t\t\t// if the dash segment length is longer than what remains to stroke, keep it for next arc. (aka residue)\n\t\t\tif(sa+angle > ea){\n\t\t\t\tresidue = {l: (sa+angle-ea)*r, i: i};\n\t\t\t\tangle = ea-sa;\n\t\t\t}\n\t\t\tif(!(i%2)){\n\t\t\t\tctx.beginPath();\n\t\t\t\tctx.arc(cx, cy, r, sa, sa+angle, ccw);\n\t\t\t\tif(apply) ctx.stroke();\n\t\t\t}\n\t\t\tsa += angle;\n\t\t\t++i;\n\t\t\tangle = dash[i%l]/r;\n\t\t}\n\t\treturn residue;\n\t}\n\n\tfunction splitToDashedBezier(/*Number[]*/points, /*Number[]*/dashArray, /*Number[]*/newPoints, /*Object*/prevResidue){\n\t\tvar residue = 0, t = 0, dash, i = 0;\n\t\tif(prevResidue){\n\t\t\tdash = prevResidue.l;\n\t\t\ti = prevResidue.i;\n\t\t}else{\n\t\t\tdash = dashArray[0];\n\t\t}\n\t\twhile(t<1){\n\t\t\t// get the 't' corresponding to the given dash value.\n\t\t\tt = bezierUtils.tAtLength(points, dash);\n\t\t\tif(t==1){\n\t\t\t\tvar rl = bezierUtils.computeLength(points);\n\t\t\t\tresidue = {l: dash-rl, i: i};\n\t\t\t}\n\t\t\t// split bezier at t: left part is the \"dash\" curve, right part is the remaining bezier points\n\t\t\tvar curves = bezierUtils.splitBezierAtT(points, t);\n\t\t\tif(!(i%2)){\n\t\t\t\t// only keep the \"dash\" curve\n\t\t\t\tnewPoints.push(curves[0]);\n\t\t\t}\n\t\t\tpoints = curves[1];\n\t\t\t++i;\n\t\t\tdash = dashArray[i%dashArray.length];\n\t\t}\n\t\treturn residue;\n\t}\n\n\tfunction toDashedCurveTo(/*Array||CanvasRenderingContext2D*/ctx, /*shape.Path*/shape, /*Number[]*/points, /*Object*/prevResidue){\n\t\t// summary:\n\t\t//\t\tBuilds a set of bezier (cubic || quadratic)curveTo' canvas instructions that represents a dashed stroke of the specified bezier geometry.\n\n\t\tvar pts = [shape.last.x, shape.last.y].concat(points),\n\t\t\tquadratic = points.length === 4, ctx2d = !(ctx instanceof Array),\n\t\t\tapi = quadratic ? \"quadraticCurveTo\" : \"bezierCurveTo\",\n\t\t\tcurves = [];\n\t\tvar residue = splitToDashedBezier(pts, shape.canvasDash, curves, prevResidue);\n\t\tfor(var c=0; c<curves.length;++c){\n\t\t\tvar curve = curves[c];\n\t\t\tif(ctx2d){\n\t\t\t\tctx.moveTo(curve[0], curve[1]);\n\t\t\t\tctx[api].apply(ctx, curve.slice(2));\n\t\t\t}else{\n\t\t\t\tctx.push(\"moveTo\", [curve[0], curve[1]]);\n\t\t\t\tctx.push(api, curve.slice(2));\n\t\t\t}\n\t\t}\n\t\treturn residue;\n\t}\n\n\tfunction toDashedLineTo(/*Array||CanvasRenderingContext2D*/ctx, /*shape.Shape*/shape, /*int*/x1, /*int*/y1, /*int*/x2, /*int*/y2, /*Object*/prevResidue){\n\t\t// summary:\n\t\t//\t\tBuilds a set of moveTo/lineTo' canvas instructions that represents a dashed stroke of the specified line geometry.\n\n\t\tvar residue = 0, r = 0, dal = 0, tlength = bezierUtils.distance(x1, y1, x2, y2), i = 0, dash = shape.canvasDash,\n\t\t\tprevx = x1, prevy = y1, x, y, ctx2d = !(ctx instanceof Array);\n\t\tif(prevResidue){\n\t\t\tdal=prevResidue.l;\n\t\t\ti = prevResidue.i;\n\t\t}else{\n\t\t\tdal += dash[0];\n\t\t}\n\t\twhile(Math.abs(1-r)>0.01){\n\t\t\tif(dal>tlength){\n\t\t\t\tresidue = {l:dal-tlength,i:i};\n\t\t\t\tdal=tlength;\n\t\t\t}\n\t\t\tr = dal/tlength;\n\t\t\tx = x1 + (x2-x1)*r;\n\t\t\ty = y1 + (y2-y1)*r;\n\t\t\tif(!(i++%2)){\n\t\t\t\tif(ctx2d){\n\t\t\t\t\tctx.moveTo(prevx, prevy);\n\t\t\t\t\tctx.lineTo(x, y);\n\t\t\t\t}else{\n\t\t\t\t\tctx.push(\"moveTo\", [prevx, prevy]);\n\t\t\t\t\tctx.push(\"lineTo\", [x, y]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tprevx = x;\n\t\t\tprevy = y;\n\t\t\tdal += dash[i%dash.length];\n\t\t}\n\t\treturn residue;\n\t}\n\n\tcanvas.Shape = declare(\"dojox.gfx.canvas.Shape\", gs.Shape, {\n\t\t_render: function(/* Object */ ctx){\n\t\t\t// summary:\n\t\t\t//\t\trender the shape\n\t\t\tctx.save();\n\t\t\tthis._renderTransform(ctx);\n\t\t\tthis._renderClip(ctx);\n\t\t\tthis._renderShape(ctx);\n\t\t\tthis._renderFill(ctx, true);\n\t\t\tthis._renderStroke(ctx, true);\n\t\t\tctx.restore();\n\t\t},\n\t\t_renderClip: function(ctx){\n\t\t\tif (this.canvasClip){\n\t\t\t\tthis.canvasClip.render(ctx);\n\t\t\t\tctx.clip();\n\t\t\t}\n\t\t},\n\t\t_renderTransform: function(/* Object */ ctx){\n\t\t\tif(\"canvasTransform\" in this){\n\t\t\t\tvar t = this.canvasTransform;\n\t\t\t\tctx.translate(t.dx, t.dy);\n\t\t\t\tctx.rotate(t.angle2);\n\t\t\t\tctx.scale(t.sx, t.sy);\n\t\t\t\tctx.rotate(t.angle1);\n\t\t\t\t// The future implementation when vendors catch up with the spec:\n\t\t\t\t// var t = this.matrix;\n\t\t\t\t// ctx.transform(t.xx, t.yx, t.xy, t.yy, t.dx, t.dy);\n\t\t\t}\n\t\t},\n\t\t_renderShape: function(/* Object */ ctx){\n\t\t\t// nothing\n\t\t},\n\t\t_renderFill: function(/* Object */ ctx, /* Boolean */ apply){\n\t\t\tif(\"canvasFill\" in this){\n\t\t\t\tvar fs = this.fillStyle;\n\t\t\t\tif(\"canvasFillImage\" in this){\n\t\t\t\t\tvar w = fs.width, h = fs.height,\n\t\t\t\t\t\tiw = this.canvasFillImage.width, ih = this.canvasFillImage.height,\n\t\t\t\t\t\t// let's match the svg default behavior wrt. aspect ratio: xMidYMid meet\n\t\t\t\t\t\tsx = w == iw ? 1 : w / iw,\n\t\t\t\t\t\tsy = h == ih ? 1 : h / ih,\n\t\t\t\t\t\ts = Math.min(sx,sy), //meet->math.min , slice->math.max\n\t\t\t\t\t\tdx = (w - s * iw)/2,\n\t\t\t\t\t\tdy = (h - s * ih)/2;\n\t\t\t\t\t// the buffer used to scaled the image\n\t\t\t\t\tpattrnbuffer.width = w; pattrnbuffer.height = h;\n\t\t\t\t\tvar copyctx = pattrnbuffer.getContext(\"2d\");\n\t\t\t\t\tcopyctx.clearRect(0, 0, w, h);\n\t\t\t\t\tcopyctx.drawImage(this.canvasFillImage, 0, 0, iw, ih, dx, dy, s*iw, s*ih);\n\t\t\t\t\tthis.canvasFill = ctx.createPattern(pattrnbuffer, \"repeat\");\n\t\t\t\t\tdelete this.canvasFillImage;\n\t\t\t\t}\n\t\t\t\tctx.fillStyle = this.canvasFill;\n\t\t\t\tif(apply){\n\t\t\t\t\t// offset the pattern\n\t\t\t\t\tif (fs.type===\"pattern\" && (fs.x !== 0 || fs.y !== 0)) {\n\t\t\t\t\t\tctx.translate(fs.x,fs.y);\n\t\t\t\t\t}\n\t\t\t\t\tctx.fill();\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tctx.fillStyle = \"rgba(0,0,0,0.0)\";\n\t\t\t}\n\t\t},\n\t\t_renderStroke: function(/* Object */ ctx, /* Boolean */ apply){\n\t\t\tvar s = this.strokeStyle;\n\t\t\tif(s){\n\t\t\t\tctx.strokeStyle = s.color.toString();\n\t\t\t\tctx.lineWidth = s.width;\n\t\t\t\tctx.lineCap = s.cap;\n\t\t\t\tif(typeof s.join == \"number\"){\n\t\t\t\t\tctx.lineJoin = \"miter\";\n\t\t\t\t\tctx.miterLimit = s.join;\n\t\t\t\t}else{\n\t\t\t\t\tctx.lineJoin = s.join;\n\t\t\t\t}\n\t\t\t\tif(this.canvasDash){\n\t\t\t\t\tif(hasNativeDash){\n\t\t\t\t\t\tctx.setLineDash(this.canvasDash);\n\t\t\t\t\t\tif(apply){ ctx.stroke(); }\n\t\t\t\t\t}else{\n\t\t\t\t\t\tthis._renderDashedStroke(ctx, apply);\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\tif(apply){ ctx.stroke(); }\n\t\t\t\t}\n\t\t\t}else if(!apply){\n\t\t\t\tctx.strokeStyle = \"rgba(0,0,0,0.0)\";\n\t\t\t}\n\t\t},\n\t\t_renderDashedStroke: function(ctx, apply){},\n\n\t\t// events are not implemented\n\t\tgetEventSource: function(){ return null; },\n\t\ton:\t\t\t\tfunction(){},\n\t\tconnect:\t\tfunction(){},\n\t\tdisconnect:\t\tfunction(){},\n\n\t\tcanvasClip:null,\n\t\tsetClip: function(/*Object*/clip){\n\t\t\tthis.inherited(arguments);\n\t\t\tvar clipType = clip ? \"width\" in clip ? \"rect\" :\n\t\t\t\t\t\t\t\"cx\" in clip ? \"ellipse\" :\n\t\t\t\t\t\t\t\"points\" in clip ? \"polyline\" : \"d\" in clip ? \"path\" : null : null;\n\t\t\tif(clip && !clipType){\n\t\t\t\treturn this;\n\t\t\t}\n\t\t\tthis.canvasClip = clip ? makeClip(clipType, clip) : null;\n\t\t\tif(this.parent){this.parent._makeDirty();}\n\t\t\treturn this;\n\t\t}\n\t});\n\n\tvar makeClip = function(clipType, geometry){\n\t\tswitch(clipType){\n\t\t\tcase \"ellipse\":\n\t\t\t\treturn {\n\t\t\t\t\tcanvasEllipse: makeEllipse({shape:geometry}),\n\t\t\t\t\trender: function(ctx){return canvas.Ellipse.prototype._renderShape.call(this, ctx);}\n\t\t\t\t};\n\t\t\tcase \"rect\":\n\t\t\t\treturn {\n\t\t\t\t\tshape: lang.delegate(geometry,{r:0}),\n\t\t\t\t\trender: function(ctx){return canvas.Rect.prototype._renderShape.call(this, ctx);}\n\t\t\t\t};\n\t\t\tcase \"path\":\n\t\t\t\treturn {\n\t\t\t\t\tcanvasPath: makeClipPath(geometry),\n\t\t\t\t\trender: function(ctx){this.canvasPath._renderShape(ctx);}\n\t\t\t\t};\n\t\t\tcase \"polyline\":\n\t\t\t\treturn {\n\t\t\t\t\tcanvasPolyline: geometry.points,\n\t\t\t\t\trender: function(ctx){return canvas.Polyline.prototype._renderShape.call(this, ctx);}\n\t\t\t\t};\n\t\t}\n\t\treturn null;\n\t};\n\n\tvar makeClipPath = function(geo){\n\t\tvar p = new dojox.gfx.canvas.Path();\n\t\tp.canvasPath = [];\n\t\tp._setPath(geo.d);\n\t\treturn p;\n\t};\n\n\tvar modifyMethod = function(shape, method, extra){\n\t\tvar old = shape.prototype[method];\n\t\tshape.prototype[method] = extra ?\n\t\t\tfunction(){\n\t\t\t\tif(this.parent){this.parent._makeDirty();}\n\t\t\t\told.apply(this, arguments);\n\t\t\t\textra.call(this);\n\t\t\t\treturn this;\n\t\t\t} :\n\t\t\tfunction(){\n\t\t\t\tif(this.parent){this.parent._makeDirty();}\n\t\t\t\treturn old.apply(this, arguments);\n\t\t\t};\n\t};\n\n\tmodifyMethod(canvas.Shape, \"setTransform\",\n\t\tfunction(){\n\t\t\t// prepare Canvas-specific structures\n\t\t\tif(this.matrix){\n\t\t\t\tthis.canvasTransform = g.decompose(this.matrix);\n\t\t\t}else{\n\t\t\t\tdelete this.canvasTransform;\n\t\t\t}\n\t\t});\n\n\tmodifyMethod(canvas.Shape, \"setFill\",\n\t\tfunction(){\n\t\t\t// prepare Canvas-specific structures\n\t\t\tvar fs = this.fillStyle, f;\n\t\t\tif(fs){\n\t\t\t\tif(typeof(fs) == \"object\" && \"type\" in fs){\n\t\t\t\t\tvar ctx = this.surface.rawNode.getContext(\"2d\");\n\t\t\t\t\tswitch(fs.type){\n\t\t\t\t\t\tcase \"linear\":\n\t\t\t\t\t\tcase \"radial\":\n\t\t\t\t\t\t\tf = fs.type == \"linear\" ?\n\t\t\t\t\t\t\t\tctx.createLinearGradient(fs.x1, fs.y1, fs.x2, fs.y2) :\n\t\t\t\t\t\t\t\tctx.createRadialGradient(fs.cx, fs.cy, 0, fs.cx, fs.cy, fs.r);\n\t\t\t\t\t\t\tarr.forEach(fs.colors, function(step){\n\t\t\t\t\t\t\t\tf.addColorStop(step.offset, g.normalizeColor(step.color).toString());\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"pattern\":\n\t\t\t\t\t\t\tif (!pattrnbuffer) {\n\t\t\t\t\t\t\t\tpattrnbuffer = document.createElement(\"canvas\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t// no need to scale the image since the canvas.createPattern uses\n\t\t\t\t\t\t\t// the original image data and not the scaled ones (see spec.)\n\t\t\t\t\t\t\t// the scaling needs to be done at rendering time in a context buffer\n\t\t\t\t\t\t\tvar img =new Image();\n\t\t\t\t\t\t\tthis.surface.downloadImage(img, fs.src);\n\t\t\t\t\t\t\tthis.canvasFillImage = img;\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\t// Set fill color using CSS RGBA func style\n\t\t\t\t\tf = fs.toString();\n\t\t\t\t}\n\t\t\t\tthis.canvasFill = f;\n\t\t\t}else{\n\t\t\t\tdelete this.canvasFill;\n\t\t\t}\n\t\t});\n\n\tmodifyMethod(canvas.Shape, \"setStroke\",\n\t\tfunction(){\n\t\t\tvar st = this.strokeStyle;\n\t\t\tif(st){\n\t\t\t\tvar da = this.strokeStyle.style.toLowerCase();\n\t\t\t\tif(da in dasharray){\n\t\t\t\t\tda = dasharray[da];\n\t\t\t\t}\n\t\t\t\tif(da instanceof Array){\n\t\t\t\t\tda = da.slice();\n\t\t\t\t\tthis.canvasDash = da;\n\t\t\t\t\tvar i;\n\t\t\t\t\tfor(i = 0; i < da.length; ++i){\n\t\t\t\t\t\tda[i] *= st.width;\n\t\t\t\t\t}\n\t\t\t\t\tif(st.cap != \"butt\"){\n\t\t\t\t\t\tfor(i = 0; i < da.length; i += 2){\n\t\t\t\t\t\t\tda[i] -= st.width;\n\t\t\t\t\t\t\tif(da[i] < 1){ da[i] = 1; }\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor(i = 1; i < da.length; i += 2){\n\t\t\t\t\t\t\tda[i] += st.width;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\tdelete this.canvasDash;\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tdelete this.canvasDash;\n\t\t\t}\n\t\t\tthis._needsDash = !hasNativeDash && !!this.canvasDash;\n\t\t});\n\n\tmodifyMethod(canvas.Shape, \"setShape\");\n\n\tcanvas.Group = declare(\"dojox.gfx.canvas.Group\", canvas.Shape, {\n\t\t// summary:\n\t\t//\t\ta group shape (Canvas), which can be used\n\t\t//\t\tto logically group shapes (e.g, to propagate matricies)\n\t\tconstructor: function(){\n\t\t\tgs.Container._init.call(this);\n\t\t},\n\t\t_render: function(/* Object */ ctx){\n\t\t\t// summary:\n\t\t\t//\t\trender the group\n\t\t\tctx.save();\n\t\t\tthis._renderTransform(ctx);\n\t\t\tthis._renderClip(ctx);\n\t\t\tfor(var i = 0; i < this.children.length; ++i){\n\t\t\t\tthis.children[i]._render(ctx);\n\t\t\t}\n\t\t\tctx.restore();\n\t\t},\n\t\tdestroy: function(){\n\t\t\t// summary:\n\t\t\t//\t\tReleases all internal resources owned by this shape. Once this method has been called,\n\t\t\t//\t\tthe instance is considered disposed and should not be used anymore.\n\n\t\t\t// don't call canvas impl to avoid makeDirty'\n\t\t\tgs.Container.clear.call(this, true);\n\t\t\t// avoid this.inherited\n\t\t\tcanvas.Shape.prototype.destroy.apply(this, arguments);\n\t\t}\n\t});\n\n\n\n\tcanvas.Rect = declare(\"dojox.gfx.canvas.Rect\", [canvas.Shape, gs.Rect], {\n\t\t// summary:\n\t\t//\t\ta rectangle shape (Canvas)\n\t\t_renderShape: function(/* Object */ ctx){\n\t\t\tvar s = this.shape, r = Math.min(s.r, s.height / 2, s.width / 2),\n\t\t\t\txl = s.x, xr = xl + s.width, yt = s.y, yb = yt + s.height,\n\t\t\t\txl2 = xl + r, xr2 = xr - r, yt2 = yt + r, yb2 = yb - r;\n\t\t\tctx.beginPath();\n\t\t\tctx.moveTo(xl2, yt);\n\t\t\tif(r){\n\t\t\t\tctx.arc(xr2, yt2, r, -halfPI, 0, false);\n\t\t\t\tctx.arc(xr2, yb2, r, 0, halfPI, false);\n\t\t\t\tctx.arc(xl2, yb2, r, halfPI, pi, false);\n\t\t\t\tctx.arc(xl2, yt2, r, pi, pi + halfPI, false);\n\t\t\t}else{\n\t\t\t\tctx.lineTo(xr2, yt);\n\t\t\t\tctx.lineTo(xr, yb2);\n\t\t\t\tctx.lineTo(xl2, yb);\n\t\t\t\tctx.lineTo(xl, yt2);\n\t\t\t}\n\t\t\tctx.closePath();\n\t\t},\n\t\t_renderDashedStroke: function(ctx, apply){\n\t\t\tvar s = this.shape, residue, r = Math.min(s.r, s.height / 2, s.width / 2),\n\t\t\t\txl = s.x, xr = xl + s.width, yt = s.y, yb = yt + s.height,\n\t\t\t\txl2 = xl + r, xr2 = xr - r, yt2 = yt + r, yb2 = yb - r;\n\t\t\tif(r){\n\t\t\t\tctx.beginPath();\n\t\t\t\tresidue = toDashedLineTo(ctx, this, xl2, yt, xr2, yt);\n\t\t\t\tif(apply) ctx.stroke();\n\t\t\t\tresidue = drawDashedArc(ctx, this.canvasDash, xr2, yt2, r, -halfPI, 0, false, apply, residue);\n\t\t\t\tctx.beginPath();\n\t\t\t\tresidue = toDashedLineTo(ctx, this, xr, yt2, xr, yb2, residue);\n\t\t\t\tif(apply) ctx.stroke();\n\t\t\t\tresidue = drawDashedArc(ctx, this.canvasDash, xr2, yb2, r, 0, halfPI, false, apply, residue);\n\t\t\t\tctx.beginPath();\n\t\t\t\tresidue = toDashedLineTo(ctx, this, xr2, yb, xl2, yb, residue);\n\t\t\t\tif(apply) ctx.stroke();\n\t\t\t\tresidue = drawDashedArc(ctx, this.canvasDash, xl2, yb2, r, halfPI, pi, false, apply, residue);\n\t\t\t\tctx.beginPath();\n\t\t\t\tresidue = toDashedLineTo(ctx, this, xl, yb2, xl, yt2,residue);\n\t\t\t\tif(apply) ctx.stroke();\n\t\t\t\tdrawDashedArc(ctx, this.canvasDash, xl2, yt2, r, pi, pi + halfPI, false, apply, residue);\n\t\t\t}else{\n\t\t\t\tctx.beginPath();\n\t\t\t\tresidue = toDashedLineTo(ctx, this, xl2, yt, xr2, yt);\n\t\t\t\tresidue = toDashedLineTo(ctx, this, xr2, yt, xr, yb2, residue);\n\t\t\t\tresidue = toDashedLineTo(ctx, this, xr, yb2, xl2, yb, residue);\n\t\t\t\ttoDashedLineTo(ctx, this, xl2, yb, xl, yt2, residue);\n\t\t\t\tif(apply) ctx.stroke();\n\t\t\t}\n\t\t}\n\t});\n\n\tvar bezierCircle = [];\n\t(function(){\n\t\tvar u = ga.curvePI4;\n\t\tbezierCircle.push(u.s, u.c1, u.c2, u.e);\n\t\tfor(var a = 45; a < 360; a += 45){\n\t\t\tvar r = m.rotateg(a);\n\t\t\tbezierCircle.push(mp(r, u.c1), mp(r, u.c2), mp(r, u.e));\n\t\t}\n\t})();\n\n\tvar makeEllipse = function(shape){\n\t\t// prepare Canvas-specific structures\n\t\tvar t, c1, c2, r = [], s = shape.shape,\n\t\t\tM = m.normalize([m.translate(s.cx, s.cy), m.scale(s.rx, s.ry)]);\n\t\tt = mp(M, bezierCircle[0]);\n\t\tr.push([t.x, t.y]);\n\t\tfor(var i = 1; i < bezierCircle.length; i += 3){\n\t\t\tc1 = mp(M, bezierCircle[i]);\n\t\t\tc2 = mp(M, bezierCircle[i + 1]);\n\t\t\tt  = mp(M, bezierCircle[i + 2]);\n\t\t\tr.push([c1.x, c1.y, c2.x, c2.y, t.x, t.y]);\n\t\t}\n\t\tif(shape._needsDash){\n\t\t\tvar points = [], p1 = r[0];\n\t\t\tfor(i = 1; i < r.length; ++i){\n\t\t\t\tvar curves = [];\n\t\t\t\tsplitToDashedBezier(p1.concat(r[i]), shape.canvasDash, curves);\n\t\t\t\tp1 = [r[i][4],r[i][5]];\n\t\t\t\tpoints.push(curves);\n\t\t\t}\n\t\t\tshape._dashedPoints = points;\n\t\t}\n\t\treturn r;\n\t};\n\n\tcanvas.Ellipse = declare(\"dojox.gfx.canvas.Ellipse\", [canvas.Shape, gs.Ellipse], {\n\t\t// summary:\n\t\t//\t\tan ellipse shape (Canvas)\n\t\tsetShape: function(){\n\t\t\tthis.inherited(arguments);\n\t\t\tthis.canvasEllipse = makeEllipse(this);\n\t\t\treturn this;\n\t\t},\n\t\tsetStroke: function(){\n\t\t\tthis.inherited(arguments);\n\t\t\tif(!hasNativeDash){\n\t\t\t\tthis.canvasEllipse = makeEllipse(this);\n\t\t\t}\n\t\t\treturn this;\n\t\t},\n\t\t_renderShape: function(/* Object */ ctx){\n\t\t\tvar r = this.canvasEllipse, i;\n\t\t\tctx.beginPath();\n\t\t\tctx.moveTo.apply(ctx, r[0]);\n\t\t\tfor(i = 1; i < r.length; ++i){\n\t\t\t\tctx.bezierCurveTo.apply(ctx, r[i]);\n\t\t\t}\n\t\t\tctx.closePath();\n\t\t},\n\t\t_renderDashedStroke: function(ctx, apply){\n\t\t\tvar r = this._dashedPoints;\n\t\t\tctx.beginPath();\n\t\t\tfor(var i = 0; i < r.length; ++i){\n\t\t\t\tvar curves = r[i];\n\t\t\t\tfor(var j=0;j<curves.length;++j){\n\t\t\t\t\tvar curve = curves[j];\n\t\t\t\t\tctx.moveTo(curve[0], curve[1]);\n\t\t\t\t\tctx.bezierCurveTo(curve[2],curve[3],curve[4],curve[5],curve[6],curve[7]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(apply) ctx.stroke();\n\t\t}\n\t});\n\n\tcanvas.Circle = declare(\"dojox.gfx.canvas.Circle\", [canvas.Shape, gs.Circle], {\n\t\t// summary:\n\t\t//\t\ta circle shape (Canvas)\n\t\t_renderShape: function(/* Object */ ctx){\n\t\t\tvar s = this.shape;\n\t\t\tctx.beginPath();\n\t\t\tctx.arc(s.cx, s.cy, s.r, 0, twoPI, 1);\n\t\t},\n\t\t_renderDashedStroke: function(ctx, apply){\n\t\t\tvar s = this.shape;\n\t\t\tvar startAngle = 0, angle, l = this.canvasDash.length; i=0;\n\t\t\twhile(startAngle < twoPI){\n\t\t\t\tangle = this.canvasDash[i%l]/s.r;\n\t\t\t\tif(!(i%2)){\n\t\t\t\t\tctx.beginPath();\n\t\t\t\t\tctx.arc(s.cx, s.cy, s.r, startAngle, startAngle+angle, 0);\n\t\t\t\t\tif(apply) ctx.stroke();\n\t\t\t\t}\n\t\t\t\tstartAngle+=angle;\n\t\t\t\t++i;\n\t\t\t}\n\t\t}\n\t});\n\n\tcanvas.Line = declare(\"dojox.gfx.canvas.Line\", [canvas.Shape, gs.Line], {\n\t\t// summary:\n\t\t//\t\ta line shape (Canvas)\n\t\t_renderShape: function(/* Object */ ctx){\n\t\t\tvar s = this.shape;\n\t\t\tctx.beginPath();\n\t\t\tctx.moveTo(s.x1, s.y1);\n\t\t\tctx.lineTo(s.x2, s.y2);\n\t\t},\n\t\t_renderDashedStroke: function(ctx, apply){\n\t\t\tvar s = this.shape;\n\t\t\tctx.beginPath();\n\t\t\ttoDashedLineTo(ctx, this, s.x1, s.y1, s.x2, s.y2);\n\t\t\tif(apply) ctx.stroke();\n\t\t}\n\t});\n\n\tcanvas.Polyline = declare(\"dojox.gfx.canvas.Polyline\", [canvas.Shape, gs.Polyline], {\n\t\t// summary:\n\t\t//\t\ta polyline/polygon shape (Canvas)\n\t\tsetShape: function(){\n\t\t\tthis.inherited(arguments);\n\t\t\tvar p = this.shape.points, f = p[0], r, c, i;\n\t\t\tthis.bbox = null;\n\t\t\t// normalize this.shape.points as array of points: [{x,y}, {x,y}, ...]\n\t\t\tthis._normalizePoints();\n\t\t\t// after _normalizePoints, if shape.points was [x1,y1,x2,y2,..], shape.points references a new array\n\t\t\t// and p references the original points array\n\t\t\t// prepare Canvas-specific structures, if needed\n\t\t\tif(p.length){\n\t\t\t\tif(typeof f == \"number\"){ // already in the canvas format [x1,y1,x2,y2,...]\n\t\t\t\t\tr = p;\n\t\t\t\t}else{ // convert into canvas-specific format\n\t\t\t\t\tr = [];\n\t\t\t\t\tfor(i=0; i < p.length; ++i){\n\t\t\t\t\t\tc = p[i];\n\t\t\t\t\t\tr.push(c.x, c.y);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tr = [];\n\t\t\t}\n\t\t\tthis.canvasPolyline = r;\n\t\t\treturn this;\n\t\t},\n\t\t_renderShape: function(/* Object */ ctx){\n\t\t\tvar p = this.canvasPolyline;\n\t\t\tif(p.length){\n\t\t\t\tctx.beginPath();\n\t\t\t\tctx.moveTo(p[0], p[1]);\n\t\t\t\tfor(var i = 2; i < p.length; i += 2){\n\t\t\t\t\tctx.lineTo(p[i], p[i + 1]);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t_renderDashedStroke: function(ctx, apply){\n\t\t\tvar p = this.canvasPolyline, residue = 0;\n\t\t\tctx.beginPath();\n\t\t\tfor(var i = 0; i < p.length; i += 2){\n\t\t\t\tresidue = toDashedLineTo(ctx, this, p[i], p[i + 1], p[i + 2], p[i + 3], residue);\n\t\t\t}\n\t\t\tif(apply) ctx.stroke();\n\t\t}\n\t});\n\n\tcanvas.Image = declare(\"dojox.gfx.canvas.Image\", [canvas.Shape, gs.Image], {\n\t\t// summary:\n\t\t//\t\tan image shape (Canvas)\n\t\tsetShape: function(){\n\t\t\tthis.inherited(arguments);\n\t\t\t// prepare Canvas-specific structures\n\t\t\tvar img = new Image();\n\t\t\tthis.surface.downloadImage(img, this.shape.src);\n\t\t\tthis.canvasImage = img;\n\t\t\treturn this;\n\t\t},\n\t\t_renderShape: function(/* Object */ ctx){\n\t\t\tvar s = this.shape;\n\t\t\tctx.drawImage(this.canvasImage, s.x, s.y, s.width, s.height);\n\t\t}\n\t});\n\n\tcanvas.Text = declare(\"dojox.gfx.canvas.Text\", [canvas.Shape, gs.Text], {\n\t\t_setFont:function(){\n\t\t\tif(this.fontStyle){\n\t\t\t\tthis.canvasFont = g.makeFontString(this.fontStyle);\n\t\t\t}else{\n\t\t\t\tdelete this.canvasFont;\n\t\t\t}\n\t\t},\n\n\t\tgetTextWidth: function(){\n\t\t\t// summary:\n\t\t\t//\t\tget the text width in pixels\n\t\t\tvar s = this.shape, w = 0, ctx;\n\t\t\tif(s.text){\n\t\t\t\tctx = this.surface.rawNode.getContext(\"2d\");\n\t\t\t\tctx.save();\n\t\t\t\tthis._renderTransform(ctx);\n\t\t\t\tthis._renderFill(ctx, false);\n\t\t\t\tthis._renderStroke(ctx, false);\n\t\t\t\tif (this.canvasFont)\n\t\t\t\t\tctx.font = this.canvasFont;\n\t\t\t\tw = ctx.measureText(s.text).width;\n\t\t\t\tctx.restore();\n\t\t\t}\n\t\t\treturn w;\n\t\t},\n\n\t\t// override to apply first fill and stroke (\n\t\t// the base implementation is for path-based shape that needs to first define the path then to fill/stroke it.\n\t\t// Here, we need the fillstyle or strokestyle to be set before calling fillText/strokeText.\n\t\t_render: function(/* Object */ctx){\n\t\t\t// summary:\n\t\t\t//\t\trender the shape\n\t\t\t// ctx: Object\n\t\t\t//\t\tthe drawing context.\n\t\t\tctx.save();\n\t\t\tthis._renderTransform(ctx);\n\t\t\tthis._renderFill(ctx, false);\n\t\t\tthis._renderStroke(ctx, false);\n\t\t\tthis._renderShape(ctx);\n\t\t\tctx.restore();\n\t\t},\n\n\t\t_renderShape: function(ctx){\n\t\t\t// summary:\n\t\t\t//\t\ta text shape (Canvas)\n\t\t\t// ctx: Object\n\t\t\t//\t\tthe drawing context.\n\t\t\tvar ta, s = this.shape;\n\t\t\tif(!s.text){\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// text align\n\t\t\tta = s.align === 'middle' ? 'center' : s.align;\n\t\t\tctx.textAlign = ta;\n\t\t\tif(this.canvasFont){\n\t\t\t\tctx.font = this.canvasFont;\n\t\t\t}\n\t\t\tif(this.canvasFill){\n\t\t\t\tctx.fillText(s.text, s.x, s.y);\n\t\t\t}\n\t\t\tif(this.strokeStyle){\n\t\t\t\tctx.beginPath(); // fix bug in FF3.6. Fixed in FF4b8\n\t\t\t\tctx.strokeText(s.text, s.x, s.y);\n\t\t\t\tctx.closePath();\n\t\t\t}\n\t\t}\n\t});\n\tmodifyMethod(canvas.Text, \"setFont\");\n\n\tif(!hasFillText){\n\t\tcanvas.Text.extend({\n\t\t\tgetTextWidth: function(){\n\t\t\t\treturn 0;\n\t\t\t},\n\t\t\tgetBoundingBox: function(){\n\t\t\t\treturn null;\n\t\t\t},\n\t\t\t_renderShape: function(){\n\t\t\t}\n\t\t});\n\t}\n\n\tvar pathRenderers = {\n\t\t\tM: \"_moveToA\", m: \"_moveToR\",\n\t\t\tL: \"_lineToA\", l: \"_lineToR\",\n\t\t\tH: \"_hLineToA\", h: \"_hLineToR\",\n\t\t\tV: \"_vLineToA\", v: \"_vLineToR\",\n\t\t\tC: \"_curveToA\", c: \"_curveToR\",\n\t\t\tS: \"_smoothCurveToA\", s: \"_smoothCurveToR\",\n\t\t\tQ: \"_qCurveToA\", q: \"_qCurveToR\",\n\t\t\tT: \"_qSmoothCurveToA\", t: \"_qSmoothCurveToR\",\n\t\t\tA: \"_arcTo\", a: \"_arcTo\",\n\t\t\tZ: \"_closePath\", z: \"_closePath\"\n\t\t};\n\n\n\tcanvas.Path = declare(\"dojox.gfx.canvas.Path\", [canvas.Shape, pathLib.Path], {\n\t\t// summary:\n\t\t//\t\ta path shape (Canvas)\n\t\tconstructor: function(){\n\t\t\tthis.lastControl = {};\n\t\t},\n\t\tsetShape: function(){\n\t\t\tthis.canvasPath = [];\n\t\t\tthis._dashedPath= [];\n\t\t\treturn this.inherited(arguments);\n\t\t},\n\t\tsetStroke:function(){\n\t\t\tthis.inherited(arguments);\n\t\t\tif(!hasNativeDash){\n\t\t\t\tthis.segmented = false;\n\t\t\t\tthis._confirmSegmented();\n\t\t\t}\n\t\t\treturn this;\n\t\t},\n\t\t_setPath: function(){\n\t\t\tthis._dashResidue = null;\n\t\t\tthis.inherited(arguments);\n\t\t},\n\t\t_updateWithSegment: function(segment){\n\t\t\tvar last = lang.clone(this.last);\n\t\t\tthis[pathRenderers[segment.action]](this.canvasPath, segment.action, segment.args, this._needsDash ? this._dashedPath : null);\n\t\t\tthis.last = last;\n\t\t\tthis.inherited(arguments);\n\t\t},\n\t\t_renderShape: function(/* Object */ ctx){\n\t\t\tvar r = this.canvasPath;\n\t\t\tctx.beginPath();\n\t\t\tfor(var i = 0; i < r.length; i += 2){\n\t\t\t\tctx[r[i]].apply(ctx, r[i + 1]);\n\t\t\t}\n\t\t},\n\t\t_renderDashedStroke: hasNativeDash ? function(){} : function(ctx, apply){\n\t\t\tvar r = this._dashedPath;\n\t\t\tctx.beginPath();\n\t\t\tfor(var i = 0; i < r.length; i += 2){\n\t\t\t\tctx[r[i]].apply(ctx, r[i + 1]);\n\t\t\t}\n\t\t\tif(apply) ctx.stroke();\n\t\t},\n\t\t_moveToA: function(result, action, args, doDash){\n\t\t\tresult.push(\"moveTo\", [args[0], args[1]]);\n\t\t\tif(doDash) doDash.push(\"moveTo\", [args[0], args[1]]);\n\t\t\tfor(var i = 2; i < args.length; i += 2){\n\t\t\t\tresult.push(\"lineTo\", [args[i], args[i + 1]]);\n\t\t\t\tif(doDash)\n\t\t\t\t\tthis._dashResidue = toDashedLineTo(doDash, this, args[i - 2], args[i - 1], args[i], args[i + 1], this._dashResidue);\n\t\t\t}\n\t\t\tthis.last.x = args[args.length - 2];\n\t\t\tthis.last.y = args[args.length - 1];\n\t\t\tthis.lastControl = {};\n\t\t},\n\t\t_moveToR: function(result, action, args, doDash){\n\t\t\tvar pts;\n\t\t\tif(\"x\" in this.last){\n\t\t\t\tpts = [this.last.x += args[0], this.last.y += args[1]];\n\t\t\t\tresult.push(\"moveTo\", pts);\n\t\t\t\tif(doDash) doDash.push(\"moveTo\", pts);\n\t\t\t}else{\n\t\t\t\tpts = [this.last.x = args[0], this.last.y = args[1]];\n\t\t\t\tresult.push(\"moveTo\", pts);\n\t\t\t\tif(doDash) doDash.push(\"moveTo\", pts);\n\t\t\t}\n\t\t\tfor(var i = 2; i < args.length; i += 2){\n\t\t\t\tresult.push(\"lineTo\", [this.last.x += args[i], this.last.y += args[i + 1]]);\n\t\t\t\tif(doDash)\n\t\t\t\t\tthis._dashResidue = toDashedLineTo(doDash, this, doDash[doDash.length - 1][0], doDash[doDash.length - 1][1], this.last.x, this.last.y, this._dashResidue);\n\t\t\t}\n\t\t\tthis.lastControl = {};\n\t\t},\n\t\t_lineToA: function(result, action, args, doDash){\n\t\t\tfor(var i = 0; i < args.length; i += 2){\n\t\t\t\tif(doDash)\n\t\t\t\t\tthis._dashResidue = toDashedLineTo(doDash, this, this.last.x, this.last.y, args[i], args[i + 1], this._dashResidue);\n\t\t\t\tresult.push(\"lineTo\", [args[i], args[i + 1]]);\n\t\t\t}\n\t\t\tthis.last.x = args[args.length - 2];\n\t\t\tthis.last.y = args[args.length - 1];\n\t\t\tthis.lastControl = {};\n\t\t},\n\t\t_lineToR: function(result, action, args, doDash){\n\t\t\tfor(var i = 0; i < args.length; i += 2){\n\t\t\t\tresult.push(\"lineTo\", [this.last.x += args[i], this.last.y += args[i + 1]]);\n\t\t\t\tif(doDash)\n\t\t\t\t\tthis._dashResidue = toDashedLineTo(doDash, this, doDash[doDash.length - 1][0], doDash[doDash.length - 1][1], this.last.x, this.last.y, this._dashResidue);\n\t\t\t}\n\t\t\tthis.lastControl = {};\n\t\t},\n\t\t_hLineToA: function(result, action, args, doDash){\n\t\t\tfor(var i = 0; i < args.length; ++i){\n\t\t\t\tresult.push(\"lineTo\", [args[i], this.last.y]);\n\t\t\t\tif(doDash)\n\t\t\t\t\tthis._dashResidue = toDashedLineTo(doDash, this, doDash[doDash.length - 1][0], doDash[doDash.length - 1][1], args[i], this.last.y, this._dashResidue);\n\t\t\t}\n\t\t\tthis.last.x = args[args.length - 1];\n\t\t\tthis.lastControl = {};\n\t\t},\n\t\t_hLineToR: function(result, action, args, doDash){\n\t\t\tfor(var i = 0; i < args.length; ++i){\n\t\t\t\tresult.push(\"lineTo\", [this.last.x += args[i], this.last.y]);\n\t\t\t\tif(doDash)\n\t\t\t\t\tthis._dashResidue = toDashedLineTo(doDash, this, doDash[doDash.length - 1][0], doDash[doDash.length - 1][1], this.last.x, this.last.y, this._dashResidue);\n\t\t\t}\n\t\t\tthis.lastControl = {};\n\t\t},\n\t\t_vLineToA: function(result, action, args, doDash){\n\t\t\tfor(var i = 0; i < args.length; ++i){\n\t\t\t\tresult.push(\"lineTo\", [this.last.x, args[i]]);\n\t\t\t\tif(doDash)\n\t\t\t\t\tthis._dashResidue = toDashedLineTo(doDash, this, doDash[doDash.length - 1][0], doDash[doDash.length - 1][1], this.last.x, args[i], this._dashResidue);\n\t\t\t}\n\t\t\tthis.last.y = args[args.length - 1];\n\t\t\tthis.lastControl = {};\n\t\t},\n\t\t_vLineToR: function(result, action, args, doDash){\n\t\t\tfor(var i = 0; i < args.length; ++i){\n\t\t\t\tresult.push(\"lineTo\", [this.last.x, this.last.y += args[i]]);\n\t\t\t\tif(doDash)\n\t\t\t\t\tthis._dashResidue = toDashedLineTo(doDash, this, doDash[doDash.length - 1][0], doDash[doDash.length - 1][1], this.last.x, this.last.y, this._dashResidue);\n\t\t\t}\n\t\t\tthis.lastControl = {};\n\t\t},\n\t\t_curveToA: function(result, action, args, doDash){\n\t\t\tfor(var i = 0; i < args.length; i += 6){\n\t\t\t\tresult.push(\"bezierCurveTo\", args.slice(i, i + 6));\n\t\t\t\tif(doDash)\n\t\t\t\t\tthis._dashResidue = toDashedCurveTo(doDash, this, result[result.length-1], this._dashResidue);\n\t\t\t}\n\t\t\tthis.last.x = args[args.length - 2];\n\t\t\tthis.last.y = args[args.length - 1];\n\t\t\tthis.lastControl.x = args[args.length - 4];\n\t\t\tthis.lastControl.y = args[args.length - 3];\n\t\t\tthis.lastControl.type = \"C\";\n\t\t},\n\t\t_curveToR: function(result, action, args, doDash){\n\t\t\tfor(var i = 0; i < args.length; i += 6){\n\t\t\t\tresult.push(\"bezierCurveTo\", [\n\t\t\t\t\tthis.last.x + args[i],\n\t\t\t\t\tthis.last.y + args[i + 1],\n\t\t\t\t\tthis.lastControl.x = this.last.x + args[i + 2],\n\t\t\t\t\tthis.lastControl.y = this.last.y + args[i + 3],\n\t\t\t\t\tthis.last.x + args[i + 4],\n\t\t\t\t\tthis.last.y + args[i + 5]\n\t\t\t\t]);\n\t\t\t\tif(doDash)\n\t\t\t\t\tthis._dashResidue = toDashedCurveTo(doDash, this, result[result.length-1], this._dashResidue);\n\t\t\t\tthis.last.x += args[i + 4];\n\t\t\t\tthis.last.y += args[i + 5];\n\t\t\t}\n\t\t\tthis.lastControl.type = \"C\";\n\t\t},\n\t\t_smoothCurveToA: function(result, action, args, doDash){\n\t\t\tfor(var i = 0; i < args.length; i += 4){\n\t\t\t\tvar valid = this.lastControl.type == \"C\";\n\t\t\t\tresult.push(\"bezierCurveTo\", [\n\t\t\t\t\tvalid ? 2 * this.last.x - this.lastControl.x : this.last.x,\n\t\t\t\t\tvalid ? 2 * this.last.y - this.lastControl.y : this.last.y,\n\t\t\t\t\targs[i],\n\t\t\t\t\targs[i + 1],\n\t\t\t\t\targs[i + 2],\n\t\t\t\t\targs[i + 3]\n\t\t\t\t]);\n\t\t\t\tif(doDash)\n\t\t\t\t\tthis._dashResidue = toDashedCurveTo(doDash, this, result[result.length-1], this._dashResidue);\n\t\t\t\tthis.lastControl.x = args[i];\n\t\t\t\tthis.lastControl.y = args[i + 1];\n\t\t\t\tthis.lastControl.type = \"C\";\n\t\t\t}\n\t\t\tthis.last.x = args[args.length - 2];\n\t\t\tthis.last.y = args[args.length - 1];\n\t\t},\n\t\t_smoothCurveToR: function(result, action, args, doDash){\n\t\t\tfor(var i = 0; i < args.length; i += 4){\n\t\t\t\tvar valid = this.lastControl.type == \"C\";\n\t\t\t\tresult.push(\"bezierCurveTo\", [\n\t\t\t\t\tvalid ? 2 * this.last.x - this.lastControl.x : this.last.x,\n\t\t\t\t\tvalid ? 2 * this.last.y - this.lastControl.y : this.last.y,\n\t\t\t\t\tthis.last.x + args[i],\n\t\t\t\t\tthis.last.y + args[i + 1],\n\t\t\t\t\tthis.last.x + args[i + 2],\n\t\t\t\t\tthis.last.y + args[i + 3]\n\t\t\t\t]);\n\t\t\t\tif(doDash)\n\t\t\t\t\tthis._dashResidue = toDashedCurveTo(doDash, this, result[result.length-1], this._dashResidue);\n\t\t\t\tthis.lastControl.x = this.last.x + args[i];\n\t\t\t\tthis.lastControl.y = this.last.y + args[i + 1];\n\t\t\t\tthis.lastControl.type = \"C\";\n\t\t\t\tthis.last.x += args[i + 2];\n\t\t\t\tthis.last.y += args[i + 3];\n\t\t\t}\n\t\t},\n\t\t_qCurveToA: function(result, action, args, doDash){\n\t\t\tfor(var i = 0; i < args.length; i += 4){\n\t\t\t\tresult.push(\"quadraticCurveTo\", args.slice(i, i + 4));\n\t\t\t}\n\t\t\tif(doDash)\n\t\t\t\tthis._dashResidue = toDashedCurveTo(doDash, this, result[result.length - 1], this._dashResidue);\n\t\t\tthis.last.x = args[args.length - 2];\n\t\t\tthis.last.y = args[args.length - 1];\n\t\t\tthis.lastControl.x = args[args.length - 4];\n\t\t\tthis.lastControl.y = args[args.length - 3];\n\t\t\tthis.lastControl.type = \"Q\";\n\t\t},\n\t\t_qCurveToR: function(result, action, args, doDash){\n\t\t\tfor(var i = 0; i < args.length; i += 4){\n\t\t\t\tresult.push(\"quadraticCurveTo\", [\n\t\t\t\t\tthis.lastControl.x = this.last.x + args[i],\n\t\t\t\t\tthis.lastControl.y = this.last.y + args[i + 1],\n\t\t\t\t\tthis.last.x + args[i + 2],\n\t\t\t\t\tthis.last.y + args[i + 3]\n\t\t\t\t]);\n\t\t\t\tif(doDash)\n\t\t\t\t\tthis._dashResidue = toDashedCurveTo(doDash, this, result[result.length - 1], this._dashResidue);\n\t\t\t\tthis.last.x += args[i + 2];\n\t\t\t\tthis.last.y += args[i + 3];\n\t\t\t}\n\t\t\tthis.lastControl.type = \"Q\";\n\t\t},\n\t\t_qSmoothCurveToA: function(result, action, args, doDash){\n\t\t\tfor(var i = 0; i < args.length; i += 2){\n\t\t\t\tvar valid = this.lastControl.type == \"Q\";\n\t\t\t\tresult.push(\"quadraticCurveTo\", [\n\t\t\t\t\tthis.lastControl.x = valid ? 2 * this.last.x - this.lastControl.x : this.last.x,\n\t\t\t\t\tthis.lastControl.y = valid ? 2 * this.last.y - this.lastControl.y : this.last.y,\n\t\t\t\t\targs[i],\n\t\t\t\t\targs[i + 1]\n\t\t\t\t]);\n\t\t\t\tif(doDash)\n\t\t\t\t\tthis._dashResidue = toDashedCurveTo(doDash, this, result[result.length - 1], this._dashResidue);\n\t\t\t\tthis.lastControl.type = \"Q\";\n\t\t\t}\n\t\t\tthis.last.x = args[args.length - 2];\n\t\t\tthis.last.y = args[args.length - 1];\n\t\t},\n\t\t_qSmoothCurveToR: function(result, action, args, doDash){\n\t\t\tfor(var i = 0; i < args.length; i += 2){\n\t\t\t\tvar valid = this.lastControl.type == \"Q\";\n\t\t\t\tresult.push(\"quadraticCurveTo\", [\n\t\t\t\t\tthis.lastControl.x = valid ? 2 * this.last.x - this.lastControl.x : this.last.x,\n\t\t\t\t\tthis.lastControl.y = valid ? 2 * this.last.y - this.lastControl.y : this.last.y,\n\t\t\t\t\tthis.last.x + args[i],\n\t\t\t\t\tthis.last.y + args[i + 1]\n\t\t\t\t]);\n\t\t\t\tif(doDash)\n\t\t\t\t\tthis._dashResidue = toDashedCurveTo(doDash, this, result[result.length - 1], this._dashResidue);\n\t\t\t\tthis.lastControl.type = \"Q\";\n\t\t\t\tthis.last.x += args[i];\n\t\t\t\tthis.last.y += args[i + 1];\n\t\t\t}\n\t\t},\n\t\t_arcTo: function(result, action, args, doDash){\n\t\t\tvar relative = action == \"a\";\n\t\t\tfor(var i = 0; i < args.length; i += 7){\n\t\t\t\tvar x1 = args[i + 5], y1 = args[i + 6];\n\t\t\t\tif(relative){\n\t\t\t\t\tx1 += this.last.x;\n\t\t\t\t\ty1 += this.last.y;\n\t\t\t\t}\n\t\t\t\tvar arcs = ga.arcAsBezier(\n\t\t\t\t\tthis.last, args[i], args[i + 1], args[i + 2],\n\t\t\t\t\targs[i + 3] ? 1 : 0, args[i + 4] ? 1 : 0,\n\t\t\t\t\tx1, y1\n\t\t\t\t);\n\t\t\t\tarr.forEach(arcs, function(p){\n\t\t\t\t\tresult.push(\"bezierCurveTo\", p);\n\t\t\t\t});\n\t\t\t\tif(doDash)\n\t\t\t\t\tthis._dashResidue = toDashedCurveTo(doDash, this, p, this._dashResidue);\n\t\t\t\tthis.last.x = x1;\n\t\t\t\tthis.last.y = y1;\n\t\t\t}\n\t\t\tthis.lastControl = {};\n\t\t},\n\t\t_closePath: function(result, action, args, doDash){\n\t\t\tresult.push(\"closePath\", []);\n\t\t\tif(doDash)\n\t\t\t\tthis._dashResidue = toDashedLineTo(doDash, this, this.last.x, this.last.y, doDash[1][0], doDash[1][1], this._dashResidue);\n\t\t\tthis.lastControl = {};\n\t\t}\n\t});\n\tarr.forEach([\"moveTo\", \"lineTo\", \"hLineTo\", \"vLineTo\", \"curveTo\",\n\t\t\"smoothCurveTo\", \"qCurveTo\", \"qSmoothCurveTo\", \"arcTo\", \"closePath\"],\n\t\tfunction(method){ modifyMethod(canvas.Path, method); }\n\t);\n\n\tcanvas.TextPath = declare(\"dojox.gfx.canvas.TextPath\", [canvas.Shape, pathLib.TextPath], {\n\t\t// summary:\n\t\t//\t\ta text shape (Canvas)\n\t\t_renderShape: function(/* Object */ ctx){\n\t\t\tvar s = this.shape;\n\t\t\t// nothing for the moment\n\t\t},\n\t\t_setText: function(){\n\t\t\t// not implemented\n\t\t},\n\t\t_setFont: function(){\n\t\t\t// not implemented\n\t\t}\n\t});\n\n\tcanvas.Surface = declare(\"dojox.gfx.canvas.Surface\", gs.Surface, {\n\t\t// summary:\n\t\t//\t\ta surface object to be used for drawings (Canvas)\n\t\tconstructor: function(){\n\t\t\tgs.Container._init.call(this);\n\t\t\tthis.pendingImageCount = 0;\n\t\t\tthis.makeDirty();\n\t\t},\n\t\tdestroy: function(){\n\t\t\tgs.Container.clear.call(this, true); // avoid makeDirty() from canvas.Container.clear impl.\n\t\t\tthis.inherited(arguments);\n\t\t},\n\t\tsetDimensions: function(width, height){\n\t\t\t// summary:\n\t\t\t//\t\tsets the width and height of the rawNode\n\t\t\t// width: String\n\t\t\t//\t\twidth of surface, e.g., \"100px\"\n\t\t\t// height: String\n\t\t\t//\t\theight of surface, e.g., \"100px\"\n\t\t\tthis.width  = g.normalizedLength(width);\t// in pixels\n\t\t\tthis.height = g.normalizedLength(height);\t// in pixels\n\t\t\tif(!this.rawNode) return this;\n\t\t\tvar dirty = false;\n\t\t\tif (this.rawNode.width != this.width){\n\t\t\t\tthis.rawNode.width = this.width;\n\t\t\t\tdirty = true;\n\t\t\t}\n\t\t\tif (this.rawNode.height != this.height){\n\t\t\t\tthis.rawNode.height = this.height;\n\t\t\t\tdirty = true;\n\t\t\t}\n\t\t\tif (dirty)\n\t\t\t\tthis.makeDirty();\n\t\t\treturn this;\t// self\n\t\t},\n\t\tgetDimensions: function(){\n\t\t\t// summary:\n\t\t\t//\t\treturns an object with properties \"width\" and \"height\"\n\t\t\treturn this.rawNode ? {width:  this.rawNode.width, height: this.rawNode.height} : null;\t// Object\n\t\t},\n\t\t_render: function(force){\n\t\t\t// summary:\n\t\t\t//\t\trender the all shapes\n\t\t\tif(!this.rawNode || (!force && this.pendingImageCount)){ return; }\n\t\t\tvar ctx = this.rawNode.getContext(\"2d\");\n\t\t\tctx.clearRect(0, 0, this.rawNode.width, this.rawNode.height);\n\t\t\tthis.render(ctx);\n\t\t\tif(\"pendingRender\" in this){\n\t\t\t\tclearTimeout(this.pendingRender);\n\t\t\t\tdelete this.pendingRender;\n\t\t\t}\n\t\t},\n\t\trender: function(ctx){\n\t\t\t// summary:\n\t\t\t//\t\tRenders the gfx scene.\n\t\t\t// description:\n\t\t\t//\t\tthis method is called to render the gfx scene to the specified context.\n\t\t\t//\t\tThis method should not be invoked directly but should be used instead\n\t\t\t//\t\tas an extension point on which user can connect to with aspect.before/aspect.after\n\t\t\t//\t\tto implement pre- or post- image processing jobs on the drawing surface.\n\t\t\t// ctx: CanvasRenderingContext2D\n\t\t\t//\t\tThe surface Canvas rendering context.\n\t\t\tctx.save();\n\t\t\tfor(var i = 0; i < this.children.length; ++i){\n\t\t\t\tthis.children[i]._render(ctx);\n\t\t\t}\n\t\t\tctx.restore();\n\t\t},\n\t\tmakeDirty: function(){\n\t\t\t// summary:\n\t\t\t//\t\tinternal method, which is called when we may need to redraw\n\t\t\tif(!this.pendingImagesCount && !(\"pendingRender\" in this) && !this._batch){\n\t\t\t\tthis.pendingRender = setTimeout(lang.hitch(this, this._render), 0);\n\t\t\t}\n\t\t},\n\t\tdownloadImage: function(img, url){\n\t\t\t// summary:\n\t\t\t//\t\tinternal method, which starts an image download and renders, when it is ready\n\t\t\t// img: Image\n\t\t\t//\t\tthe image object\n\t\t\t// url: String\n\t\t\t//\t\tthe url of the image\n\t\t\tvar handler = lang.hitch(this, this.onImageLoad);\n\t\t\tif(!this.pendingImageCount++ && \"pendingRender\" in this){\n\t\t\t\tclearTimeout(this.pendingRender);\n\t\t\t\tdelete this.pendingRender;\n\t\t\t}\n\t\t\timg.onload  = handler;\n\t\t\timg.onerror = handler;\n\t\t\timg.onabort = handler;\n\t\t\timg.src = url;\n\t\t},\n\t\tonImageLoad: function(){\n\t\t\tif(!--this.pendingImageCount){\n\t\t\t\tthis.onImagesLoaded();\n\t\t\t\tthis._render();\n\t\t\t}\n\t\t},\n\t\tonImagesLoaded: function(){\n\t\t\t// summary:\n\t\t\t//\t\tAn extension point called when all pending images downloads have been completed.\n\t\t\t// description:\n\t\t\t//\t\tThis method is invoked when all pending images downloads have been completed, just before\n\t\t\t//\t\tthe gfx scene is redrawn. User can connect to this method to get notified when a\n\t\t\t//\t\tgfx scene containing images is fully resolved.\n\t\t},\n\n\t\t// events are not implemented\n\t\tgetEventSource: function(){ return null; },\n\t\tconnect:\t\tfunction(){},\n\t\tdisconnect:\t\tfunction(){},\n\t\ton:\t\t\t\tfunction(){}\n\t});\n\n\tcanvas.createSurface = function(parentNode, width, height){\n\t\t// summary:\n\t\t//\t\tcreates a surface (Canvas)\n\t\t// parentNode: Node\n\t\t//\t\ta parent node\n\t\t// width: String\n\t\t//\t\twidth of surface, e.g., \"100px\"\n\t\t// height: String\n\t\t//\t\theight of surface, e.g., \"100px\"\n\n\t\tif(!width && !height){\n\t\t\tvar pos = domGeom.position(parentNode);\n\t\t\twidth  = width  || pos.w;\n\t\t\theight = height || pos.h;\n\t\t}\n\t\tif(typeof width == \"number\"){\n\t\t\twidth = width + \"px\";\n\t\t}\n\t\tif(typeof height == \"number\"){\n\t\t\theight = height + \"px\";\n\t\t}\n\n\t\tvar s = new canvas.Surface(),\n\t\t\tp = dom.byId(parentNode),\n\t\t\tc = p.ownerDocument.createElement(\"canvas\");\n\n\t\tc.width  = g.normalizedLength(width);\t// in pixels\n\t\tc.height = g.normalizedLength(height);\t// in pixels\n\n\t\tp.appendChild(c);\n\t\ts.rawNode = c;\n\t\ts._parent = p;\n\t\ts.surface = s;\n\t\treturn s;\t// dojox/gfx.Surface\n\t};\n\n\t// Extenders\n\n\tvar C = gs.Container, Container = {\n\t\topenBatch: function() {\n\t\t\t// summary:\n\t\t\t//\t\tstarts a new batch, subsequent new child shapes will be held in\n\t\t\t//\t\tthe batch instead of appending to the container directly.\n\t\t\t// description:\n\t\t\t//\t\tBecause the canvas renderer has no DOM hierarchy, the canvas implementation differs\n\t\t\t//\t\tsuch that it suspends the repaint requests for this container until the current batch is closed by a call to closeBatch().\n\t\t\t++this._batch;\n\t\t\treturn this;\n\t\t},\n\t\tcloseBatch: function() {\n\t\t\t// summary:\n\t\t\t//\t\tsubmits the current batch.\n\t\t\t// description:\n\t\t\t//\t\tOn canvas, this method flushes the pending redraws queue.\n\t\t\tthis._batch = this._batch > 0 ? --this._batch : 0;\n\t\t\tthis._makeDirty();\n\t\t\treturn this;\n\t\t},\n\t\t_makeDirty: function(){\n\t\t\tif(!this._batch){\n\t\t\t\tthis.surface.makeDirty();\n\t\t\t}\n\t\t},\n\t\tadd: function(shape){\n\t\t\tthis._makeDirty();\n\t\t\treturn C.add.apply(this, arguments);\n\t\t},\n\t\tremove: function(shape, silently){\n\t\t\tthis._makeDirty();\n\t\t\treturn C.remove.apply(this, arguments);\n\t\t},\n\t\tclear: function(){\n\t\t\tthis._makeDirty();\n\t\t\treturn C.clear.apply(this, arguments);\n\t\t},\n\t\tgetBoundingBox: C.getBoundingBox,\n\t\t_moveChildToFront: function(shape){\n\t\t\tthis._makeDirty();\n\t\t\treturn C._moveChildToFront.apply(this, arguments);\n\t\t},\n\t\t_moveChildToBack: function(shape){\n\t\t\tthis._makeDirty();\n\t\t\treturn C._moveChildToBack.apply(this, arguments);\n\t\t}\n\t};\n\n\tvar Creator = {\n\t\t// summary:\n\t\t//\t\tCanvas shape creators\n\t\tcreateObject: function(shapeType, rawShape) {\n\t\t\t// summary:\n\t\t\t//\t\tcreates an instance of the passed shapeType class\n\t\t\t// shapeType: Function\n\t\t\t//\t\ta class constructor to create an instance of\n\t\t\t// rawShape: Object\n\t\t\t//\t\tproperties to be passed in to the classes \"setShape\" method\n\t\t\t// overrideSize: Boolean\n\t\t\t//\t\tset the size explicitly, if true\n\t\t\tvar shape = new shapeType();\n\t\t\tshape.surface = this.surface;\n\t\t\tshape.setShape(rawShape);\n\t\t\tthis.add(shape);\n\t\t\treturn shape;\t// dojox/gfx/shape.Shape\n\t\t}\n\t};\n\n\textend(canvas.Group, Container);\n\textend(canvas.Group, gs.Creator);\n\textend(canvas.Group, Creator);\n\n\textend(canvas.Surface, Container);\n\textend(canvas.Surface, gs.Creator);\n\textend(canvas.Surface, Creator);\n\n\t// no event support -> nothing to fix.\n\tcanvas.fixTarget = function(event, gfxElement){\n\t\t// tags:\n\t\t//\t\tprivate\n\t\treturn true;\n\t};\n\n\treturn canvas;\n});\n","define([\"./_base\", \"dojo/_base/lang\", \"./matrix\"], \n  function (g, lang, m){\n\tfunction eq(/* Number */ a, /* Number */ b){\n\t\t// summary:\n\t\t//\t\tcompare two FP numbers for equality\n\t\treturn Math.abs(a - b) <= 1e-6 * (Math.abs(a) + Math.abs(b));\t// Boolean\n\t}\n\n\tfunction calcFromValues(/* Number */ r1, /* Number */ m1, /* Number */ r2, /* Number */ m2){\n\t\t// summary:\n\t\t//\t\tuses two close FP ration and their original magnitudes to approximate the result\n\t\tif(!isFinite(r1)){\n\t\t\treturn r2;\t// Number\n\t\t}else if(!isFinite(r2)){\n\t\t\treturn r1;\t// Number\n\t\t}\n\t\tm1 = Math.abs(m1); m2 = Math.abs(m2);\n\t\treturn (m1 * r1 + m2 * r2) / (m1 + m2);\t// Number\n\t}\n\n\tfunction transpose(matrix){\n\t\t// matrix: dojox/gfx/matrix.Matrix2D\n\t\t//\t\ta 2D matrix-like object\n\t\tvar M = new m.Matrix2D(matrix);\n\t\treturn lang.mixin(M, {dx: 0, dy: 0, xy: M.yx, yx: M.xy});\t// dojox/gfx/matrix.Matrix2D\n\t}\n\n\tfunction scaleSign(/* dojox/gfx/matrix.Matrix2D */ matrix){\n\t\treturn (matrix.xx * matrix.yy < 0 || matrix.xy * matrix.yx > 0) ? -1 : 1;\t// Number\n\t}\n\n\tfunction eigenvalueDecomposition(matrix){\n\t\t// matrix: dojox/gfx/matrix.Matrix2D\n\t\t//\t\ta 2D matrix-like object\n\t\tvar M = m.normalize(matrix),\n\t\t\tb = -M.xx - M.yy,\n\t\t\tc = M.xx * M.yy - M.xy * M.yx,\n\t\t\td = Math.sqrt(b * b - 4 * c),\n\t\t\tl1 = -(b + (b < 0 ? -d : d)) / 2,\n\t\t\tl2 = c / l1,\n\t\t\tvx1 = M.xy / (l1 - M.xx), vy1 = 1,\n\t\t\tvx2 = M.xy / (l2 - M.xx), vy2 = 1;\n\t\tif(eq(l1, l2)){\n\t\t\tvx1 = 1, vy1 = 0, vx2 = 0, vy2 = 1;\n\t\t}\n\t\tif(!isFinite(vx1)){\n\t\t\tvx1 = 1, vy1 = (l1 - M.xx) / M.xy;\n\t\t\tif(!isFinite(vy1)){\n\t\t\t\tvx1 = (l1 - M.yy) / M.yx, vy1 = 1;\n\t\t\t\tif(!isFinite(vx1)){\n\t\t\t\t\tvx1 = 1, vy1 = M.yx / (l1 - M.yy);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif(!isFinite(vx2)){\n\t\t\tvx2 = 1, vy2 = (l2 - M.xx) / M.xy;\n\t\t\tif(!isFinite(vy2)){\n\t\t\t\tvx2 = (l2 - M.yy) / M.yx, vy2 = 1;\n\t\t\t\tif(!isFinite(vx2)){\n\t\t\t\t\tvx2 = 1, vy2 = M.yx / (l2 - M.yy);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tvar d1 = Math.sqrt(vx1 * vx1 + vy1 * vy1),\n\t\t\td2 = Math.sqrt(vx2 * vx2 + vy2 * vy2);\n\t\tif(!isFinite(vx1 /= d1)){ vx1 = 0; }\n\t\tif(!isFinite(vy1 /= d1)){ vy1 = 0; }\n\t\tif(!isFinite(vx2 /= d2)){ vx2 = 0; }\n\t\tif(!isFinite(vy2 /= d2)){ vy2 = 0; }\n\t\treturn {\t// Object\n\t\t\tvalue1: l1,\n\t\t\tvalue2: l2,\n\t\t\tvector1: {x: vx1, y: vy1},\n\t\t\tvector2: {x: vx2, y: vy2}\n\t\t};\n\t}\n\n\tfunction decomposeSR(/* dojox/gfx/matrix.Matrix2D */ M, /* Object */ result){\n\t\t// summary:\n\t\t//\t\tdecomposes a matrix into [scale, rotate]; no checks are done.\n\t\tvar sign = scaleSign(M),\n\t\t\ta = result.angle1 = (Math.atan2(M.yx, M.yy) + Math.atan2(-sign * M.xy, sign * M.xx)) / 2,\n\t\t\tcos = Math.cos(a), sin = Math.sin(a);\n\t\tresult.sx = calcFromValues(M.xx / cos, cos, -M.xy / sin, sin);\n\t\tresult.sy = calcFromValues(M.yy / cos, cos,  M.yx / sin, sin);\n\t\treturn result;\t// Object\n\t}\n\n\tfunction decomposeRS(/* dojox/gfx/matrix.Matrix2D */ M, /* Object */ result){\n\t\t// summary:\n\t\t//\t\tdecomposes a matrix into [rotate, scale]; no checks are done\n\t\tvar sign = scaleSign(M),\n\t\t\ta = result.angle2 = (Math.atan2(sign * M.yx, sign * M.xx) + Math.atan2(-M.xy, M.yy)) / 2,\n\t\t\tcos = Math.cos(a), sin = Math.sin(a);\n\t\tresult.sx = calcFromValues(M.xx / cos, cos,  M.yx / sin, sin);\n\t\tresult.sy = calcFromValues(M.yy / cos, cos, -M.xy / sin, sin);\n\t\treturn result;\t// Object\n\t}\n\n\treturn g.decompose = function(matrix){\n\t\t// summary:\n\t\t//\t\tDecompose a 2D matrix into translation, scaling, and rotation components.\n\t\t// description:\n\t\t//\t\tThis function decompose a matrix into four logical components:\n\t\t//\t\ttranslation, rotation, scaling, and one more rotation using SVD.\n\t\t//\t\tThe components should be applied in following order:\n\t\t//\t| [translate, rotate(angle2), scale, rotate(angle1)]\n\t\t// matrix: dojox/gfx/matrix.Matrix2D\n\t\t//\t\ta 2D matrix-like object\n\t\tvar M = m.normalize(matrix),\n\t\t\tresult = {dx: M.dx, dy: M.dy, sx: 1, sy: 1, angle1: 0, angle2: 0};\n\t\t// detect case: [scale]\n\t\tif(eq(M.xy, 0) && eq(M.yx, 0)){\n\t\t\treturn lang.mixin(result, {sx: M.xx, sy: M.yy});\t// Object\n\t\t}\n\t\t// detect case: [scale, rotate]\n\t\tif(eq(M.xx * M.yx, -M.xy * M.yy)){\n\t\t\treturn decomposeSR(M, result);\t// Object\n\t\t}\n\t\t// detect case: [rotate, scale]\n\t\tif(eq(M.xx * M.xy, -M.yx * M.yy)){\n\t\t\treturn decomposeRS(M, result);\t// Object\n\t\t}\n\t\t// do SVD\n\t\tvar\tMT = transpose(M),\n\t\t\tu  = eigenvalueDecomposition([M, MT]),\n\t\t\tv  = eigenvalueDecomposition([MT, M]),\n\t\t\tU  = new m.Matrix2D({xx: u.vector1.x, xy: u.vector2.x, yx: u.vector1.y, yy: u.vector2.y}),\n\t\t\tVT = new m.Matrix2D({xx: v.vector1.x, xy: v.vector1.y, yx: v.vector2.x, yy: v.vector2.y}),\n\t\t\tS = new m.Matrix2D([m.invert(U), M, m.invert(VT)]);\n\t\tdecomposeSR(VT, result);\n\t\tS.xx *= result.sx;\n\t\tS.yy *= result.sy;\n\t\tdecomposeRS(U, result);\n\t\tS.xx *= result.sx;\n\t\tS.yy *= result.sy;\n\t\treturn lang.mixin(result, {sx: S.xx, sy: S.yy});\t// Object\n\t};\n});\n","define([\"./_base\",\"dojo/_base/lang\"], \n  function(g, lang){\n\tvar m = g.matrix = {};\n\n\t// candidates for dojox.math:\n\tvar _degToRadCache = {};\n\tm._degToRad = function(degree){\n\t\treturn _degToRadCache[degree] || (_degToRadCache[degree] = (Math.PI * degree / 180));\n\t};\n\tm._radToDeg = function(radian){ return radian / Math.PI * 180; };\n\n\tm.Matrix2D = function(arg){\n\t\t// summary:\n\t\t//\t\ta 2D matrix object\n\t\t// description:\n\t\t//\t\tNormalizes a 2D matrix-like object. If arrays is passed,\n\t\t//\t\tall objects of the array are normalized and multiplied sequentially.\n\t\t// arg: Object\n\t\t//\t\ta 2D matrix-like object, a number, or an array of such objects\n\t\tif(arg){\n\t\t\tif(typeof arg == \"number\"){\n\t\t\t\tthis.xx = this.yy = arg;\n\t\t\t}else if(arg instanceof Array){\n\t\t\t\tif(arg.length > 0){\n\t\t\t\t\tvar matrix = m.normalize(arg[0]);\n\t\t\t\t\t// combine matrices\n\t\t\t\t\tfor(var i = 1; i < arg.length; ++i){\n\t\t\t\t\t\tvar l = matrix, r = m.normalize(arg[i]);\n\t\t\t\t\t\tmatrix = new m.Matrix2D();\n\t\t\t\t\t\tmatrix.xx = l.xx * r.xx + l.xy * r.yx;\n\t\t\t\t\t\tmatrix.xy = l.xx * r.xy + l.xy * r.yy;\n\t\t\t\t\t\tmatrix.yx = l.yx * r.xx + l.yy * r.yx;\n\t\t\t\t\t\tmatrix.yy = l.yx * r.xy + l.yy * r.yy;\n\t\t\t\t\t\tmatrix.dx = l.xx * r.dx + l.xy * r.dy + l.dx;\n\t\t\t\t\t\tmatrix.dy = l.yx * r.dx + l.yy * r.dy + l.dy;\n\t\t\t\t\t}\n\t\t\t\t\tlang.mixin(this, matrix);\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tlang.mixin(this, arg);\n\t\t\t}\n\t\t}\n\t};\n\n\t// the default (identity) matrix, which is used to fill in missing values\n\tlang.extend(m.Matrix2D, {xx: 1, xy: 0, yx: 0, yy: 1, dx: 0, dy: 0});\n\n\tlang.mixin(m, {\n\t\t// summary:\n\t\t//\t\tclass constants, and methods of dojox/gfx/matrix\n\n\t\t// matrix constants\n\n\t\t// identity: dojox/gfx/matrix.Matrix2D\n\t\t//\t\tan identity matrix constant: identity * (x, y) == (x, y)\n\t\tidentity: new m.Matrix2D(),\n\n\t\t// flipX: dojox/gfx/matrix.Matrix2D\n\t\t//\t\ta matrix, which reflects points at x = 0 line: flipX * (x, y) == (-x, y)\n\t\tflipX:    new m.Matrix2D({xx: -1}),\n\n\t\t// flipY: dojox/gfx/matrix.Matrix2D\n\t\t//\t\ta matrix, which reflects points at y = 0 line: flipY * (x, y) == (x, -y)\n\t\tflipY:    new m.Matrix2D({yy: -1}),\n\n\t\t// flipXY: dojox/gfx/matrix.Matrix2D\n\t\t//\t\ta matrix, which reflects points at the origin of coordinates: flipXY * (x, y) == (-x, -y)\n\t\tflipXY:   new m.Matrix2D({xx: -1, yy: -1}),\n\n\t\t// matrix creators\n\n\t\ttranslate: function(a, b){\n\t\t\t// summary:\n\t\t\t//\t\tforms a translation matrix\n\t\t\t// description:\n\t\t\t//\t\tThe resulting matrix is used to translate (move) points by specified offsets.\n\t\t\t// a: Number|dojox/gfx.Point\n\t\t\t//\t\tan x coordinate value, or a point-like object, which specifies offsets for both dimensions\n\t\t\t// b: Number?\n\t\t\t//\t\ta y coordinate value\n\t\t\t// returns: dojox/gfx/matrix.Matrix2D\n\t\t\tif(arguments.length > 1){\n\t\t\t\treturn new m.Matrix2D({dx: a, dy: b}); // dojox/gfx/matrix.Matrix2D\n\t\t\t}\n\t\t\t// branch\n\t\t\treturn new m.Matrix2D({dx: a.x, dy: a.y}); // dojox/gfx/matrix.Matrix2D\n\t\t},\n\t\tscale: function(a, b){\n\t\t\t// summary:\n\t\t\t//\t\tforms a scaling matrix\n\t\t\t// description:\n\t\t\t//\t\tThe resulting matrix is used to scale (magnify) points by specified offsets.\n\t\t\t// a: Number|dojox/gfx.Point\n\t\t\t//\t\ta scaling factor used for the x coordinate, or\n\t\t\t//\t\ta uniform scaling factor used for the both coordinates, or\n\t\t\t//\t\ta point-like object, which specifies scale factors for both dimensions\n\t\t\t// b: Number?\n\t\t\t//\t\ta scaling factor used for the y coordinate\n\t\t\t// returns: dojox/gfx/matrix.Matrix2D\n\t\t\tif(arguments.length > 1){\n\t\t\t\treturn new m.Matrix2D({xx: a, yy: b}); // dojox/gfx/matrix.Matrix2D\n\t\t\t}\n\t\t\tif(typeof a == \"number\"){\n\t\t\t\treturn new m.Matrix2D({xx: a, yy: a}); // dojox/gfx/matrix.Matrix2D\n\t\t\t}\n\t\t\treturn new m.Matrix2D({xx: a.x, yy: a.y}); // dojox/gfx/matrix.Matrix2D\n\t\t},\n\t\trotate: function(angle){\n\t\t\t// summary:\n\t\t\t//\t\tforms a rotating matrix\n\t\t\t// description:\n\t\t\t//\t\tThe resulting matrix is used to rotate points\n\t\t\t//\t\taround the origin of coordinates (0, 0) by specified angle.\n\t\t\t// angle: Number\n\t\t\t//\t\tan angle of rotation in radians (>0 for CW)\n\t\t\t// returns: dojox/gfx/matrix.Matrix2D\n\t\t\tvar c = Math.cos(angle);\n\t\t\tvar s = Math.sin(angle);\n\t\t\treturn new m.Matrix2D({xx: c, xy: -s, yx: s, yy: c}); // dojox/gfx/matrix.Matrix2D\n\t\t},\n\t\trotateg: function(degree){\n\t\t\t// summary:\n\t\t\t//\t\tforms a rotating matrix\n\t\t\t// description:\n\t\t\t//\t\tThe resulting matrix is used to rotate points\n\t\t\t//\t\taround the origin of coordinates (0, 0) by specified degree.\n\t\t\t//\t\tSee dojox/gfx/matrix.rotate() for comparison.\n\t\t\t// degree: Number\n\t\t\t//\t\tan angle of rotation in degrees (>0 for CW)\n\t\t\t// returns: dojox/gfx/matrix.Matrix2D\n\t\t\treturn m.rotate(m._degToRad(degree)); // dojox/gfx/matrix.Matrix2D\n\t\t},\n\t\tskewX: function(angle) {\n\t\t\t// summary:\n\t\t\t//\t\tforms an x skewing matrix\n\t\t\t// description:\n\t\t\t//\t\tThe resulting matrix is used to skew points in the x dimension\n\t\t\t//\t\taround the origin of coordinates (0, 0) by specified angle.\n\t\t\t// angle: Number\n\t\t\t//\t\ta skewing angle in radians\n\t\t\t// returns: dojox/gfx/matrix.Matrix2D\n\t\t\treturn new m.Matrix2D({xy: Math.tan(angle)}); // dojox/gfx/matrix.Matrix2D\n\t\t},\n\t\tskewXg: function(degree){\n\t\t\t// summary:\n\t\t\t//\t\tforms an x skewing matrix\n\t\t\t// description:\n\t\t\t//\t\tThe resulting matrix is used to skew points in the x dimension\n\t\t\t//\t\taround the origin of coordinates (0, 0) by specified degree.\n\t\t\t//\t\tSee dojox/gfx/matrix.skewX() for comparison.\n\t\t\t// degree: Number\n\t\t\t//\t\ta skewing angle in degrees\n\t\t\t// returns: dojox/gfx/matrix.Matrix2D\n\t\t\treturn m.skewX(m._degToRad(degree)); // dojox/gfx/matrix.Matrix2D\n\t\t},\n\t\tskewY: function(angle){\n\t\t\t// summary:\n\t\t\t//\t\tforms a y skewing matrix\n\t\t\t// description:\n\t\t\t//\t\tThe resulting matrix is used to skew points in the y dimension\n\t\t\t//\t\taround the origin of coordinates (0, 0) by specified angle.\n\t\t\t// angle: Number\n\t\t\t//\t\ta skewing angle in radians\n\t\t\t// returns: dojox/gfx/matrix.Matrix2D\n\t\t\treturn new m.Matrix2D({yx: Math.tan(angle)}); // dojox/gfx/matrix.Matrix2D\n\t\t},\n\t\tskewYg: function(degree){\n\t\t\t// summary:\n\t\t\t//\t\tforms a y skewing matrix\n\t\t\t// description:\n\t\t\t//\t\tThe resulting matrix is used to skew points in the y dimension\n\t\t\t//\t\taround the origin of coordinates (0, 0) by specified degree.\n\t\t\t//\t\tSee dojox/gfx/matrix.skewY() for comparison.\n\t\t\t// degree: Number\n\t\t\t//\t\ta skewing angle in degrees\n\t\t\t// returns: dojox/gfx/matrix.Matrix2D\n\t\t\treturn m.skewY(m._degToRad(degree)); // dojox/gfx/matrix.Matrix2D\n\t\t},\n\t\treflect: function(a, b){\n\t\t\t// summary:\n\t\t\t//\t\tforms a reflection matrix\n\t\t\t// description:\n\t\t\t//\t\tThe resulting matrix is used to reflect points around a vector,\n\t\t\t//\t\twhich goes through the origin.\n\t\t\t// a: dojox/gfx.Point|Number\n\t\t\t//\t\ta point-like object, which specifies a vector of reflection, or an X value\n\t\t\t// b: Number?\n\t\t\t//\t\ta Y value\n\t\t\t// returns: dojox/gfx/matrix.Matrix2D\n\t\t\tif(arguments.length == 1){\n\t\t\t\tb = a.y;\n\t\t\t\ta = a.x;\n\t\t\t}\n\t\t\t// make a unit vector\n\t\t\tvar a2 = a * a, b2 = b * b, n2 = a2 + b2, xy = 2 * a * b / n2;\n\t\t\treturn new m.Matrix2D({xx: 2 * a2 / n2 - 1, xy: xy, yx: xy, yy: 2 * b2 / n2 - 1}); // dojox/gfx/matrix.Matrix2D\n\t\t},\n\t\tproject: function(a, b){\n\t\t\t// summary:\n\t\t\t//\t\tforms an orthogonal projection matrix\n\t\t\t// description:\n\t\t\t//\t\tThe resulting matrix is used to project points orthogonally on a vector,\n\t\t\t//\t\twhich goes through the origin.\n\t\t\t// a: dojox/gfx.Point|Number\n\t\t\t//\t\ta point-like object, which specifies a vector of projection, or\n\t\t\t//\t\tan x coordinate value\n\t\t\t// b: Number?\n\t\t\t//\t\ta y coordinate value\n\t\t\t// returns: dojox/gfx/matrix.Matrix2D\n\t\t\tif(arguments.length == 1){\n\t\t\t\tb = a.y;\n\t\t\t\ta = a.x;\n\t\t\t}\n\t\t\t// make a unit vector\n\t\t\tvar a2 = a * a, b2 = b * b, n2 = a2 + b2, xy = a * b / n2;\n\t\t\treturn new m.Matrix2D({xx: a2 / n2, xy: xy, yx: xy, yy: b2 / n2}); // dojox/gfx/matrix.Matrix2D\n\t\t},\n\n\t\t// ensure matrix 2D conformance\n\t\tnormalize: function(matrix){\n\t\t\t// summary:\n\t\t\t//\t\tconverts an object to a matrix, if necessary\n\t\t\t// description:\n\t\t\t//\t\tConverts any 2D matrix-like object or an array of\n\t\t\t//\t\tsuch objects to a valid dojox/gfx/matrix.Matrix2D object.\n\t\t\t// matrix: Object\n\t\t\t//\t\tan object, which is converted to a matrix, if necessary\n\t\t\t// returns: dojox/gfx/matrix.Matrix2D\n\t\t\treturn (matrix instanceof m.Matrix2D) ? matrix : new m.Matrix2D(matrix); // dojox/gfx/matrix.Matrix2D\n\t\t},\n\n\t\t// common operations\n\n\t\tisIdentity: function(matrix){\n\t\t\t// summary:\n\t\t\t//\t\treturns whether the specified matrix is the identity.\n\t\t\t// matrix: dojox/gfx/matrix.Matrix2D\n\t\t\t//\t\ta 2D matrix object to be tested\n\t\t\t// returns: Boolean\n\t\t\treturn matrix.xx == 1 && matrix.xy == 0 && matrix.yx == 0 && matrix.yy == 1 && matrix.dx == 0 && matrix.dy == 0; // Boolean\n\t\t},\n\t\tclone: function(matrix){\n\t\t\t// summary:\n\t\t\t//\t\tcreates a copy of a 2D matrix\n\t\t\t// matrix: dojox/gfx/matrix.Matrix2D\n\t\t\t//\t\ta 2D matrix-like object to be cloned\n\t\t\t// returns: dojox/gfx/matrix.Matrix2D\n\t\t\tvar obj = new m.Matrix2D();\n\t\t\tfor(var i in matrix){\n\t\t\t\tif(typeof(matrix[i]) == \"number\" && typeof(obj[i]) == \"number\" && obj[i] != matrix[i]) obj[i] = matrix[i];\n\t\t\t}\n\t\t\treturn obj; // dojox/gfx/matrix.Matrix2D\n\t\t},\n\t\tinvert: function(matrix){\n\t\t\t// summary:\n\t\t\t//\t\tinverts a 2D matrix\n\t\t\t// matrix: dojox/gfx/matrix.Matrix2D\n\t\t\t//\t\ta 2D matrix-like object to be inverted\n\t\t\t// returns: dojox/gfx/matrix.Matrix2D\n\t\t\tvar M = m.normalize(matrix),\n\t\t\t\tD = M.xx * M.yy - M.xy * M.yx;\n\t\t\t\tM = new m.Matrix2D({\n\t\t\t\t\txx: M.yy/D, xy: -M.xy/D,\n\t\t\t\t\tyx: -M.yx/D, yy: M.xx/D,\n\t\t\t\t\tdx: (M.xy * M.dy - M.yy * M.dx) / D,\n\t\t\t\t\tdy: (M.yx * M.dx - M.xx * M.dy) / D\n\t\t\t\t});\n\t\t\treturn M; // dojox/gfx/matrix.Matrix2D\n\t\t},\n\t\t_multiplyPoint: function(matrix, x, y){\n\t\t\t// summary:\n\t\t\t//\t\tapplies a matrix to a point\n\t\t\t// matrix: dojox/gfx/matrix.Matrix2D\n\t\t\t//\t\ta 2D matrix object to be applied\n\t\t\t// x: Number\n\t\t\t//\t\tan x coordinate of a point\n\t\t\t// y: Number\n\t\t\t//\t\ta y coordinate of a point\n\t\t\t// returns: dojox/gfx.Point\n\t\t\treturn {x: matrix.xx * x + matrix.xy * y + matrix.dx, y: matrix.yx * x + matrix.yy * y + matrix.dy}; // dojox/gfx.Point\n\t\t},\n\t\tmultiplyPoint: function(matrix, /* Number||Point */ a, /* Number? */ b){\n\t\t\t// summary:\n\t\t\t//\t\tapplies a matrix to a point\n\t\t\t// matrix: dojox/gfx/matrix.Matrix2D\n\t\t\t//\t\ta 2D matrix object to be applied\n\t\t\t// a: Number|dojox/gfx.Point\n\t\t\t//\t\tan x coordinate of a point, or a point\n\t\t\t// b: Number?\n\t\t\t//\t\ta y coordinate of a point\n\t\t\t// returns: dojox/gfx.Point\n\t\t\tvar M = m.normalize(matrix);\n\t\t\tif(typeof a == \"number\" && typeof b == \"number\"){\n\t\t\t\treturn m._multiplyPoint(M, a, b); // dojox/gfx.Point\n\t\t\t}\n\t\t\treturn m._multiplyPoint(M, a.x, a.y); // dojox/gfx.Point\n\t\t},\n\t\tmultiplyRectangle: function(matrix, /*Rectangle*/ rect){\n\t\t\t// summary:\n\t\t\t//\t\tApplies a matrix to a rectangle.\n\t\t\t// description:\n\t\t\t//\t\tThe method applies the transformation on all corners of the\n\t\t\t//\t\trectangle and returns the smallest rectangle enclosing the 4 transformed\n\t\t\t//\t\tpoints.\n\t\t\t// matrix: dojox/gfx/matrix.Matrix2D\n\t\t\t//\t\ta 2D matrix object to be applied.\n\t\t\t// rect: Rectangle\n\t\t\t//\t\tthe rectangle to transform.\n\t\t\t// returns: dojox/gfx.Rectangle\n\t\t\tvar M = m.normalize(matrix);\n\t\t\trect = rect || {x:0, y:0, width:0, height:0}; \n\t\t\tif(m.isIdentity(M))\n\t\t\t\treturn {x: rect.x, y: rect.y, width: rect.width, height: rect.height}; // dojo/gfx.Rectangle\n\t\t\tvar p0 = m.multiplyPoint(M, rect.x, rect.y),\n\t\t\t\tp1 = m.multiplyPoint(M, rect.x, rect.y + rect.height),\n\t\t\t\tp2 = m.multiplyPoint(M, rect.x + rect.width, rect.y),\n\t\t\t\tp3 = m.multiplyPoint(M, rect.x + rect.width, rect.y + rect.height),\n\t\t\t\tminx = Math.min(p0.x, p1.x, p2.x, p3.x),\n\t\t\t\tminy = Math.min(p0.y, p1.y, p2.y, p3.y),\n\t\t\t\tmaxx = Math.max(p0.x, p1.x, p2.x, p3.x),\n\t\t\t\tmaxy = Math.max(p0.y, p1.y, p2.y, p3.y);\n\t\t\treturn{ // dojo/gfx.Rectangle\n\t\t\t\tx: minx,\n\t\t\t\ty: miny,\n\t\t\t\twidth: maxx - minx,\n\t\t\t\theight: maxy - miny\n\t\t\t};\n\t\t},\n\t\tmultiply: function(matrix){\n\t\t\t// summary:\n\t\t\t//\t\tcombines matrices by multiplying them sequentially in the given order\n\t\t\t// matrix: dojox/gfx/matrix.Matrix2D\n\t\t\t//\t\ta 2D matrix-like object,\n\t\t\t//\t\tall subsequent arguments are matrix-like objects too\n\t\t\tvar M = m.normalize(matrix);\n\t\t\t// combine matrices\n\t\t\tfor(var i = 1; i < arguments.length; ++i){\n\t\t\t\tvar l = M, r = m.normalize(arguments[i]);\n\t\t\t\tM = new m.Matrix2D();\n\t\t\t\tM.xx = l.xx * r.xx + l.xy * r.yx;\n\t\t\t\tM.xy = l.xx * r.xy + l.xy * r.yy;\n\t\t\t\tM.yx = l.yx * r.xx + l.yy * r.yx;\n\t\t\t\tM.yy = l.yx * r.xy + l.yy * r.yy;\n\t\t\t\tM.dx = l.xx * r.dx + l.xy * r.dy + l.dx;\n\t\t\t\tM.dy = l.yx * r.dx + l.yy * r.dy + l.dy;\n\t\t\t}\n\t\t\treturn M; // dojox/gfx/matrix.Matrix2D\n\t\t},\n\n\t\t// high level operations\n\n\t\t_sandwich: function(matrix, x, y){\n\t\t\t// summary:\n\t\t\t//\t\tapplies a matrix at a central point\n\t\t\t// matrix: dojox/gfx/matrix.Matrix2D\n\t\t\t//\t\ta 2D matrix-like object, which is applied at a central point\n\t\t\t// x: Number\n\t\t\t//\t\tan x component of the central point\n\t\t\t// y: Number\n\t\t\t//\t\ta y component of the central point\n\t\t\treturn m.multiply(m.translate(x, y), matrix, m.translate(-x, -y)); // dojox/gfx/matrix.Matrix2D\n\t\t},\n\t\tscaleAt: function(a, b, c, d){\n\t\t\t// summary:\n\t\t\t//\t\tscales a picture using a specified point as a center of scaling\n\t\t\t// description:\n\t\t\t//\t\tCompare with dojox/gfx/matrix.scale().\n\t\t\t// a: Number\n\t\t\t//\t\ta scaling factor used for the x coordinate, or a uniform scaling factor used for both coordinates\n\t\t\t// b: Number?\n\t\t\t//\t\ta scaling factor used for the y coordinate\n\t\t\t// c: Number|Point\n\t\t\t//\t\tan x component of a central point, or a central point\n\t\t\t// d: Number\n\t\t\t//\t\ta y component of a central point\n\t\t\t// returns: dojox/gfx/matrix.Matrix2D\n\t\t\tswitch(arguments.length){\n\t\t\t\tcase 4:\n\t\t\t\t\t// a and b are scale factor components, c and d are components of a point\n\t\t\t\t\treturn m._sandwich(m.scale(a, b), c, d); // dojox/gfx/matrix.Matrix2D\n\t\t\t\tcase 3:\n\t\t\t\t\tif(typeof c == \"number\"){\n\t\t\t\t\t\treturn m._sandwich(m.scale(a), b, c); // dojox/gfx/matrix.Matrix2D\n\t\t\t\t\t}\n\t\t\t\t\treturn m._sandwich(m.scale(a, b), c.x, c.y); // dojox/gfx/matrix.Matrix2D\n\t\t\t}\n\t\t\treturn m._sandwich(m.scale(a), b.x, b.y); // dojox/gfx/matrix.Matrix2D\n\t\t},\n\t\trotateAt: function(angle, a, b){\n\t\t\t// summary:\n\t\t\t//\t\trotates a picture using a specified point as a center of rotation\n\t\t\t// description:\n\t\t\t//\t\tCompare with dojox/gfx/matrix.rotate().\n\t\t\t// angle: Number\n\t\t\t//\t\tan angle of rotation in radians (>0 for CW)\n\t\t\t// a: Number|dojox/gfx.Point\n\t\t\t//\t\tan x component of a central point, or a central point\n\t\t\t// b: Number?\n\t\t\t//\t\ta y component of a central point\n\t\t\t// returns: dojox/gfx/matrix.Matrix2D\n\t\t\tif(arguments.length > 2){\n\t\t\t\treturn m._sandwich(m.rotate(angle), a, b); // dojox/gfx/matrix.Matrix2D\n\t\t\t}\n\t\t\treturn m._sandwich(m.rotate(angle), a.x, a.y); // dojox/gfx/matrix.Matrix2D\n\t\t},\n\t\trotategAt: function(degree, a, b){\n\t\t\t// summary:\n\t\t\t//\t\trotates a picture using a specified point as a center of rotation\n\t\t\t// description:\n\t\t\t//\t\tCompare with dojox/gfx/matrix.rotateg().\n\t\t\t// degree: Number\n\t\t\t//\t\tan angle of rotation in degrees (>0 for CW)\n\t\t\t// a: Number|dojox/gfx.Point\n\t\t\t//\t\tan x component of a central point, or a central point\n\t\t\t// b: Number?\n\t\t\t//\t\ta y component of a central point\n\t\t\t// returns: dojox/gfx/matrix.Matrix2D\n\t\t\tif(arguments.length > 2){\n\t\t\t\treturn m._sandwich(m.rotateg(degree), a, b); // dojox/gfx/matrix.Matrix2D\n\t\t\t}\n\t\t\treturn m._sandwich(m.rotateg(degree), a.x, a.y); // dojox/gfx/matrix.Matrix2D\n\t\t},\n\t\tskewXAt: function(angle, a, b){\n\t\t\t// summary:\n\t\t\t//\t\tskews a picture along the x axis using a specified point as a center of skewing\n\t\t\t// description:\n\t\t\t//\t\tCompare with dojox/gfx/matrix.skewX().\n\t\t\t// angle: Number\n\t\t\t//\t\ta skewing angle in radians\n\t\t\t// a: Number|dojox/gfx.Point\n\t\t\t//\t\tan x component of a central point, or a central point\n\t\t\t// b: Number?\n\t\t\t//\t\ta y component of a central point\n\t\t\t// returns: dojox/gfx/matrix.Matrix2D\n\t\t\tif(arguments.length > 2){\n\t\t\t\treturn m._sandwich(m.skewX(angle), a, b); // dojox/gfx/matrix.Matrix2D\n\t\t\t}\n\t\t\treturn m._sandwich(m.skewX(angle), a.x, a.y); // dojox/gfx/matrix.Matrix2D\n\t\t},\n\t\tskewXgAt: function(degree, a, b){\n\t\t\t// summary:\n\t\t\t//\t\tskews a picture along the x axis using a specified point as a center of skewing\n\t\t\t// description:\n\t\t\t//\t\tCompare with dojox/gfx/matrix.skewXg().\n\t\t\t// degree: Number\n\t\t\t//\t\ta skewing angle in degrees\n\t\t\t// a: Number|dojox/gfx.Point\n\t\t\t//\t\tan x component of a central point, or a central point\n\t\t\t// b: Number?\n\t\t\t//\t\ta y component of a central point\n\t\t\t// returns: dojox/gfx/matrix.Matrix2D\n\t\t\tif(arguments.length > 2){\n\t\t\t\treturn m._sandwich(m.skewXg(degree), a, b); // dojox/gfx/matrix.Matrix2D\n\t\t\t}\n\t\t\treturn m._sandwich(m.skewXg(degree), a.x, a.y); // dojox/gfx/matrix.Matrix2D\n\t\t},\n\t\tskewYAt: function(angle, a, b){\n\t\t\t// summary:\n\t\t\t//\t\tskews a picture along the y axis using a specified point as a center of skewing\n\t\t\t// description:\n\t\t\t//\t\tCompare with dojox/gfx/matrix.skewY().\n\t\t\t// angle: Number\n\t\t\t//\t\ta skewing angle in radians\n\t\t\t// a: Number|dojox/gfx.Point\n\t\t\t//\t\tan x component of a central point, or a central point\n\t\t\t// b: Number?\n\t\t\t//\t\ta y component of a central point\n\t\t\t// returns: dojox/gfx/matrix.Matrix2D\n\t\t\tif(arguments.length > 2){\n\t\t\t\treturn m._sandwich(m.skewY(angle), a, b); // dojox/gfx/matrix.Matrix2D\n\t\t\t}\n\t\t\treturn m._sandwich(m.skewY(angle), a.x, a.y); // dojox/gfx/matrix.Matrix2D\n\t\t},\n\t\tskewYgAt: function(/* Number */ degree, /* Number||Point */ a, /* Number? */ b){\n\t\t\t// summary:\n\t\t\t//\t\tskews a picture along the y axis using a specified point as a center of skewing\n\t\t\t// description:\n\t\t\t//\t\tCompare with dojox/gfx/matrix.skewYg().\n\t\t\t// degree: Number\n\t\t\t//\t\ta skewing angle in degrees\n\t\t\t// a: Number|dojox/gfx.Point\n\t\t\t//\t\tan x component of a central point, or a central point\n\t\t\t// b: Number?\n\t\t\t//\t\ta y component of a central point\n\t\t\t// returns: dojox/gfx/matrix.Matrix2D\n\t\t\tif(arguments.length > 2){\n\t\t\t\treturn m._sandwich(m.skewYg(degree), a, b); // dojox/gfx/matrix.Matrix2D\n\t\t\t}\n\t\t\treturn m._sandwich(m.skewYg(degree), a.x, a.y); // dojox/gfx/matrix.Matrix2D\n\t\t}\n\n\t\t//TODO: rect-to-rect mapping, scale-to-fit (isotropic and anisotropic versions)\n\n\t});\n\t// propagate Matrix2D up\n\tg.Matrix2D = m.Matrix2D;\n\n\treturn m;\n});\n\n\n","define([\"./_base\", \"dojo/_base/lang\",\"dojo/_base/declare\", \"./matrix\", \"./shape\"],\n\tfunction(g, lang, declare, matrix, shapeLib){\n\n\t// module:\n\t//\t\tdojox/gfx/path\n\n\tvar Path = declare(\"dojox.gfx.path.Path\", shapeLib.Shape, {\n\t\t// summary:\n\t\t//\t\ta generalized path shape\n\n\t\tconstructor: function(rawNode){\n\t\t\t// summary:\n\t\t\t//\t\ta path constructor\n\t\t\t// rawNode: Node\n\t\t\t//\t\ta DOM node to be used by this path object\n\t\t\tthis.shape = lang.clone(g.defaultPath);\n\t\t\tthis.segments = [];\n\t\t\tthis.tbbox = null;\n\t\t\tthis.absolute = true;\n\t\t\tthis.last = {};\n\t\t\tthis.rawNode = rawNode;\n\t\t\tthis.segmented = false;\n\t\t},\n\n\t\t// mode manipulations\n\t\tsetAbsoluteMode: function(mode){\n\t\t\t// summary:\n\t\t\t//\t\tsets an absolute or relative mode for path points\n\t\t\t// mode: Boolean\n\t\t\t//\t\ttrue/false or \"absolute\"/\"relative\" to specify the mode\n\t\t\tthis._confirmSegmented();\n\t\t\tthis.absolute = typeof mode == \"string\" ? (mode == \"absolute\") : mode;\n\t\t\treturn this; // self\n\t\t},\n\t\tgetAbsoluteMode: function(){\n\t\t\t// summary:\n\t\t\t//\t\treturns a current value of the absolute mode\n\t\t\tthis._confirmSegmented();\n\t\t\treturn this.absolute; // Boolean\n\t\t},\n\n\t\tgetBoundingBox: function(){\n\t\t\t// summary:\n\t\t\t//\t\treturns the bounding box {x, y, width, height} or null\n\t\t\tthis._confirmSegmented();\n\t\t\treturn (this.bbox && (\"l\" in this.bbox)) ? {x: this.bbox.l, y: this.bbox.t, width: this.bbox.r - this.bbox.l, height: this.bbox.b - this.bbox.t} : null; // dojox/gfx.Rectangle\n\t\t},\n\n\t\t_getRealBBox: function(){\n\t\t\t// summary:\n\t\t\t//\t\treturns an array of four points or null\n\t\t\t//\t\tfour points represent four corners of the untransformed bounding box\n\t\t\tthis._confirmSegmented();\n\t\t\tif(this.tbbox){\n\t\t\t\treturn this.tbbox;\t// Array\n\t\t\t}\n\t\t\tvar bbox = this.bbox, matrix = this._getRealMatrix();\n\t\t\tthis.bbox = null;\n\t\t\tfor(var i = 0, len = this.segments.length; i < len; ++i){\n\t\t\t\tthis._updateWithSegment(this.segments[i], matrix);\n\t\t\t}\n\t\t\tvar t = this.bbox;\n\t\t\tthis.bbox = bbox;\n\t\t\tthis.tbbox = t ? [\n\t\t\t\t{x: t.l, y: t.t},\n\t\t\t\t{x: t.r, y: t.t},\n\t\t\t\t{x: t.r, y: t.b},\n\t\t\t\t{x: t.l, y: t.b}\n\t\t\t] : null;\n\t\t\treturn this.tbbox;\t// Array\n\t\t},\n\n\t\tgetLastPosition: function(){\n\t\t\t// summary:\n\t\t\t//\t\treturns the last point in the path, or null\n\t\t\tthis._confirmSegmented();\n\t\t\treturn \"x\" in this.last ? this.last : null; // Object\n\t\t},\n\n\t\t_applyTransform: function(){\n\t\t\tthis.tbbox = null;\n\t\t\treturn this.inherited(arguments);\n\t\t},\n\n\t\t// segment interpretation\n\t\t_updateBBox: function(x, y, m){\n\t\t\t// summary:\n\t\t\t//\t\tupdates the bounding box of path with new point\n\t\t\t// x: Number\n\t\t\t//\t\tan x coordinate\n\t\t\t// y: Number\n\t\t\t//\t\ta y coordinate\n\n\t\t\tif(m){\n\t\t\t\tvar t = matrix.multiplyPoint(m, x, y);\n\t\t\t\tx = t.x;\n\t\t\t\ty = t.y;\n\t\t\t}\n\n\t\t\t// we use {l, b, r, t} representation of a bbox\n\t\t\tif(this.bbox && (\"l\" in this.bbox)){\n\t\t\t\tif(this.bbox.l > x) this.bbox.l = x;\n\t\t\t\tif(this.bbox.r < x) this.bbox.r = x;\n\t\t\t\tif(this.bbox.t > y) this.bbox.t = y;\n\t\t\t\tif(this.bbox.b < y) this.bbox.b = y;\n\t\t\t}else{\n\t\t\t\tthis.bbox = {l: x, b: y, r: x, t: y};\n\t\t\t}\n\t\t},\n\t\t_updateWithSegment: function(segment, matrix){\n\t\t\t// summary:\n\t\t\t//\t\tupdates the bounding box of path with new segment\n\t\t\t// segment: Object\n\t\t\t//\t\ta segment\n\t\t\tvar n = segment.args, l = n.length, i;\n\t\t\t// update internal variables: bbox, absolute, last\n\t\t\tswitch(segment.action){\n\t\t\t\tcase \"M\":\n\t\t\t\tcase \"L\":\n\t\t\t\tcase \"C\":\n\t\t\t\tcase \"S\":\n\t\t\t\tcase \"Q\":\n\t\t\t\tcase \"T\":\n\t\t\t\t\tfor(i = 0; i < l; i += 2){\n\t\t\t\t\t\tthis._updateBBox(n[i], n[i + 1], matrix);\n\t\t\t\t\t}\n\t\t\t\t\tthis.last.x = n[l - 2];\n\t\t\t\t\tthis.last.y = n[l - 1];\n\t\t\t\t\tthis.absolute = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"H\":\n\t\t\t\t\tfor(i = 0; i < l; ++i){\n\t\t\t\t\t\tthis._updateBBox(n[i], this.last.y, matrix);\n\t\t\t\t\t}\n\t\t\t\t\tthis.last.x = n[l - 1];\n\t\t\t\t\tthis.absolute = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"V\":\n\t\t\t\t\tfor(i = 0; i < l; ++i){\n\t\t\t\t\t\tthis._updateBBox(this.last.x, n[i], matrix);\n\t\t\t\t\t}\n\t\t\t\t\tthis.last.y = n[l - 1];\n\t\t\t\t\tthis.absolute = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"m\":\n\t\t\t\t\tvar start = 0;\n\t\t\t\t\tif(!(\"x\" in this.last)){\n\t\t\t\t\t\tthis._updateBBox(this.last.x = n[0], this.last.y = n[1], matrix);\n\t\t\t\t\t\tstart = 2;\n\t\t\t\t\t}\n\t\t\t\t\tfor(i = start; i < l; i += 2){\n\t\t\t\t\t\tthis._updateBBox(this.last.x += n[i], this.last.y += n[i + 1], matrix);\n\t\t\t\t\t}\n\t\t\t\t\tthis.absolute = false;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"l\":\n\t\t\t\tcase \"t\":\n\t\t\t\t\tfor(i = 0; i < l; i += 2){\n\t\t\t\t\t\tthis._updateBBox(this.last.x += n[i], this.last.y += n[i + 1], matrix);\n\t\t\t\t\t}\n\t\t\t\t\tthis.absolute = false;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"h\":\n\t\t\t\t\tfor(i = 0; i < l; ++i){\n\t\t\t\t\t\tthis._updateBBox(this.last.x += n[i], this.last.y, matrix);\n\t\t\t\t\t}\n\t\t\t\t\tthis.absolute = false;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"v\":\n\t\t\t\t\tfor(i = 0; i < l; ++i){\n\t\t\t\t\t\tthis._updateBBox(this.last.x, this.last.y += n[i], matrix);\n\t\t\t\t\t}\n\t\t\t\t\tthis.absolute = false;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"c\":\n\t\t\t\t\tfor(i = 0; i < l; i += 6){\n\t\t\t\t\t\tthis._updateBBox(this.last.x + n[i], this.last.y + n[i + 1], matrix);\n\t\t\t\t\t\tthis._updateBBox(this.last.x + n[i + 2], this.last.y + n[i + 3], matrix);\n\t\t\t\t\t\tthis._updateBBox(this.last.x += n[i + 4], this.last.y += n[i + 5], matrix);\n\t\t\t\t\t}\n\t\t\t\t\tthis.absolute = false;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"s\":\n\t\t\t\tcase \"q\":\n\t\t\t\t\tfor(i = 0; i < l; i += 4){\n\t\t\t\t\t\tthis._updateBBox(this.last.x + n[i], this.last.y + n[i + 1], matrix);\n\t\t\t\t\t\tthis._updateBBox(this.last.x += n[i + 2], this.last.y += n[i + 3], matrix);\n\t\t\t\t\t}\n\t\t\t\t\tthis.absolute = false;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"A\":\n\t\t\t\t\tfor(i = 0; i < l; i += 7){\n\t\t\t\t\t\tthis._updateBBox(n[i + 5], n[i + 6], matrix);\n\t\t\t\t\t}\n\t\t\t\t\tthis.last.x = n[l - 2];\n\t\t\t\t\tthis.last.y = n[l - 1];\n\t\t\t\t\tthis.absolute = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"a\":\n\t\t\t\t\tfor(i = 0; i < l; i += 7){\n\t\t\t\t\t\tthis._updateBBox(this.last.x += n[i + 5], this.last.y += n[i + 6], matrix);\n\t\t\t\t\t}\n\t\t\t\t\tthis.absolute = false;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\t// add an SVG path segment\n\t\t\tvar path = [segment.action];\n\t\t\tfor(i = 0; i < l; ++i){\n\t\t\t\tpath.push(g.formatNumber(n[i], true));\n\t\t\t}\n\t\t\tif(typeof this.shape.path == \"string\"){\n\t\t\t\tthis.shape.path += path.join(\"\");\n\t\t\t}else{\n\t\t\t\tfor(i = 0, l = path.length; i < l; ++i){\n\t\t\t\t\tthis.shape.path.push(path[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t// a dictionary, which maps segment type codes to a number of their arguments\n\t\t_validSegments: {m: 2, l: 2, h: 1, v: 1, c: 6, s: 4, q: 4, t: 2, a: 7, z: 0},\n\n\t\t_pushSegment: function(action, args){\n\t\t\t// summary:\n\t\t\t//\t\tadds a segment\n\t\t\t// action: String\n\t\t\t//\t\tvalid SVG code for a segment's type\n\t\t\t// args: Array\n\t\t\t//\t\ta list of parameters for this segment\n\t\t\tthis.tbbox = null;\n\t\t\tvar group = this._validSegments[action.toLowerCase()], segment;\n\t\t\tif(typeof group == \"number\"){\n\t\t\t\tif(group){\n\t\t\t\t\tif(args.length >= group){\n\t\t\t\t\t\tsegment = {action: action, args: args.slice(0, args.length - args.length % group)};\n\t\t\t\t\t\tthis.segments.push(segment);\n\t\t\t\t\t\tthis._updateWithSegment(segment);\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\tsegment = {action: action, args: []};\n\t\t\t\t\tthis.segments.push(segment);\n\t\t\t\t\tthis._updateWithSegment(segment);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t_collectArgs: function(array, args){\n\t\t\t// summary:\n\t\t\t//\t\tconverts an array of arguments to plain numeric values\n\t\t\t// array: Array\n\t\t\t//\t\tan output argument (array of numbers)\n\t\t\t// args: Array\n\t\t\t//\t\tan input argument (can be values of Boolean, Number, dojox/gfx.Point, or an embedded array of them)\n\t\t\tfor(var i = 0; i < args.length; ++i){\n\t\t\t\tvar t = args[i];\n\t\t\t\tif(typeof t == \"boolean\"){\n\t\t\t\t\tarray.push(t ? 1 : 0);\n\t\t\t\t}else if(typeof t == \"number\"){\n\t\t\t\t\tarray.push(t);\n\t\t\t\t}else if(t instanceof Array){\n\t\t\t\t\tthis._collectArgs(array, t);\n\t\t\t\t}else if(\"x\" in t && \"y\" in t){\n\t\t\t\t\tarray.push(t.x, t.y);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t// segments\n\t\tmoveTo: function(){\n\t\t\t// summary:\n\t\t\t//\t\tforms a move segment\n\t\t\tthis._confirmSegmented();\n\t\t\tvar args = [];\n\t\t\tthis._collectArgs(args, arguments);\n\t\t\tthis._pushSegment(this.absolute ? \"M\" : \"m\", args);\n\t\t\treturn this; // self\n\t\t},\n\t\tlineTo: function(){\n\t\t\t// summary:\n\t\t\t//\t\tforms a line segment\n\t\t\tthis._confirmSegmented();\n\t\t\tvar args = [];\n\t\t\tthis._collectArgs(args, arguments);\n\t\t\tthis._pushSegment(this.absolute ? \"L\" : \"l\", args);\n\t\t\treturn this; // self\n\t\t},\n\t\thLineTo: function(){\n\t\t\t// summary:\n\t\t\t//\t\tforms a horizontal line segment\n\t\t\tthis._confirmSegmented();\n\t\t\tvar args = [];\n\t\t\tthis._collectArgs(args, arguments);\n\t\t\tthis._pushSegment(this.absolute ? \"H\" : \"h\", args);\n\t\t\treturn this; // self\n\t\t},\n\t\tvLineTo: function(){\n\t\t\t// summary:\n\t\t\t//\t\tforms a vertical line segment\n\t\t\tthis._confirmSegmented();\n\t\t\tvar args = [];\n\t\t\tthis._collectArgs(args, arguments);\n\t\t\tthis._pushSegment(this.absolute ? \"V\" : \"v\", args);\n\t\t\treturn this; // self\n\t\t},\n\t\tcurveTo: function(){\n\t\t\t// summary:\n\t\t\t//\t\tforms a curve segment\n\t\t\tthis._confirmSegmented();\n\t\t\tvar args = [];\n\t\t\tthis._collectArgs(args, arguments);\n\t\t\tthis._pushSegment(this.absolute ? \"C\" : \"c\", args);\n\t\t\treturn this; // self\n\t\t},\n\t\tsmoothCurveTo: function(){\n\t\t\t// summary:\n\t\t\t//\t\tforms a smooth curve segment\n\t\t\tthis._confirmSegmented();\n\t\t\tvar args = [];\n\t\t\tthis._collectArgs(args, arguments);\n\t\t\tthis._pushSegment(this.absolute ? \"S\" : \"s\", args);\n\t\t\treturn this; // self\n\t\t},\n\t\tqCurveTo: function(){\n\t\t\t// summary:\n\t\t\t//\t\tforms a quadratic curve segment\n\t\t\tthis._confirmSegmented();\n\t\t\tvar args = [];\n\t\t\tthis._collectArgs(args, arguments);\n\t\t\tthis._pushSegment(this.absolute ? \"Q\" : \"q\", args);\n\t\t\treturn this; // self\n\t\t},\n\t\tqSmoothCurveTo: function(){\n\t\t\t// summary:\n\t\t\t//\t\tforms a quadratic smooth curve segment\n\t\t\tthis._confirmSegmented();\n\t\t\tvar args = [];\n\t\t\tthis._collectArgs(args, arguments);\n\t\t\tthis._pushSegment(this.absolute ? \"T\" : \"t\", args);\n\t\t\treturn this; // self\n\t\t},\n\t\tarcTo: function(){\n\t\t\t// summary:\n\t\t\t//\t\tforms an elliptic arc segment\n\t\t\tthis._confirmSegmented();\n\t\t\tvar args = [];\n\t\t\tthis._collectArgs(args, arguments);\n\t\t\tthis._pushSegment(this.absolute ? \"A\" : \"a\", args);\n\t\t\treturn this; // self\n\t\t},\n\t\tclosePath: function(){\n\t\t\t// summary:\n\t\t\t//\t\tcloses a path\n\t\t\tthis._confirmSegmented();\n\t\t\tthis._pushSegment(\"Z\", []);\n\t\t\treturn this; // self\n\t\t},\n\n\t\t_confirmSegmented: function() {\n\t\t\tif (!this.segmented) {\n\t\t\t\tvar path = this.shape.path;\n\t\t\t\t// switch to non-updating version of path building\n\t\t\t\tthis.shape.path = [];\n\t\t\t\tthis._setPath(path);\n\t\t\t\t// switch back to the string path\n\t\t\t\tthis.shape.path = this.shape.path.join(\"\");\n\t\t\t\t// become segmented\n\t\t\t\tthis.segmented = true;\n\t\t\t}\n\t\t},\n\n\t\t// setShape\n\t\t_setPath: function(path){\n\t\t\t// summary:\n\t\t\t//\t\tforms a path using an SVG path string\n\t\t\t// path: String\n\t\t\t//\t\tan SVG path string\n\t\t\tvar p = lang.isArray(path) ? path : path.match(g.pathSvgRegExp);\n\t\t\tthis.segments = [];\n\t\t\tthis.absolute = true;\n\t\t\tthis.bbox = {};\n\t\t\tthis.last = {};\n\t\t\tif(!p) return;\n\t\t\t// create segments\n\t\t\tvar action = \"\",\t// current action\n\t\t\t\targs = [],\t\t// current arguments\n\t\t\t\tl = p.length;\n\t\t\tfor(var i = 0; i < l; ++i){\n\t\t\t\tvar t = p[i], x = parseFloat(t);\n\t\t\t\tif(isNaN(x)){\n\t\t\t\t\tif(action){\n\t\t\t\t\t\tthis._pushSegment(action, args);\n\t\t\t\t\t}\n\t\t\t\t\targs = [];\n\t\t\t\t\taction = t;\n\t\t\t\t}else{\n\t\t\t\t\targs.push(x);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._pushSegment(action, args);\n\t\t},\n\t\tsetShape: function(newShape){\n\t\t\t// summary:\n\t\t\t//\t\tforms a path using a shape\n\t\t\t// newShape: Object\n\t\t\t//\t\tan SVG path string or a path object (see dojox/gfx.defaultPath)\n\t\t\tthis.inherited(arguments, [typeof newShape == \"string\" ? {path: newShape} : newShape]);\n\n\t\t\tthis.segmented = false;\n\t\t\tthis.segments = [];\n\t\t\tif(!g.lazyPathSegmentation){\n\t\t\t\tthis._confirmSegmented();\n\t\t\t}\n\t\t\treturn this; // self\n\t\t},\n\n\t\t// useful constant for descendants\n\t\t_2PI: Math.PI * 2\n\t});\n\n\tvar TextPath = declare(\"dojox.gfx.path.TextPath\", Path, {\n\t\t// summary:\n\t\t//\t\ta generalized TextPath shape\n\n\t\tconstructor: function(rawNode){\n\t\t\t// summary:\n\t\t\t//\t\ta TextPath shape constructor\n\t\t\t// rawNode: Node\n\t\t\t//\t\ta DOM node to be used by this TextPath object\n\t\t\tif(!(\"text\" in this)){\n\t\t\t\tthis.text = lang.clone(g.defaultTextPath);\n\t\t\t}\n\t\t\tif(!(\"fontStyle\" in this)){\n\t\t\t\tthis.fontStyle = lang.clone(g.defaultFont);\n\t\t\t}\n\t\t},\n\t\tgetText: function(){\n\t\t\t// summary:\n\t\t\t//\t\treturns the current text object or null\n\t\t\treturn this.text;\t// Object\n\t\t},\n\t\tsetText: function(newText){\n\t\t\t// summary:\n\t\t\t//\t\tsets a text to be drawn along the path\n\t\t\tthis.text = g.makeParameters(this.text,\n\t\t\t\ttypeof newText == \"string\" ? {text: newText} : newText);\n\t\t\tthis._setText();\n\t\t\treturn this;\t// self\n\t\t},\n\t\tgetFont: function(){\n\t\t\t// summary:\n\t\t\t//\t\treturns the current font object or null\n\t\t\treturn this.fontStyle;\t// Object\n\t\t},\n\t\tsetFont: function(newFont){\n\t\t\t// summary:\n\t\t\t//\t\tsets a font for text\n\t\t\tthis.fontStyle = typeof newFont == \"string\" ?\n\t\t\t\tg.splitFontString(newFont) :\n\t\t\t\tg.makeParameters(g.defaultFont, newFont);\n\t\t\tthis._setFont();\n\t\t\treturn this;\t// self\n\t\t}\n\t});\n\n\t/*=====\n\tg.Path = Path;\n\tg.TextPath = TextPath;\n\t=====*/\n\n\treturn g.path = {\n\t\t// summary:\n\t\t//\t\tThis module contains the core graphics Path API.\n\t\t//\t\tPath command format follows the W3C SVG 1.0 Path api.\n\n\t\tPath: Path,\n\t\tTextPath: TextPath\n\t};\n});\n","define([\"./_base\", \"dojo/_base/lang\", \"dojo/_base/declare\", \"dojo/_base/kernel\", \"dojo/_base/sniff\",\n\t\"dojo/on\", \"dojo/_base/array\", \"dojo/dom-construct\", \"dojo/_base/Color\", \"./matrix\" ],\n\tfunction(g, lang, declare, kernel, has, on, arr, domConstruct, Color, matrixLib){\n\n\tfunction removeItemAt(a, index) {\n\t\tvar len = (a.length - 1);\n\t\twhile (index < len) {\n\t\t\ta[index] = a[++index];\n\t\t}\n\t\ta.length = len;\n\t}\n\n\tvar shape = g.shape = {\n\t\t// summary:\n\t\t//\t\tThis module contains the core graphics Shape API.\n\t\t//\t\tDifferent graphics renderer implementation modules (svg, canvas, vml, silverlight, etc.) extend this\n\t\t//\t\tbasic api to provide renderer-specific implementations for each shape.\n\t};\n\n\tshape.Shape = declare(\"dojox.gfx.shape.Shape\", null, {\n\t\t// summary:\n\t\t//\t\ta Shape object, which knows how to apply\n\t\t//\t\tgraphical attributes and transformations\n\t\n\t\tconstructor: function(){\n\t\t\t// rawNode: Node\n\t\t\t//\t\tunderlying graphics-renderer-specific implementation object (if applicable)\n\t\t\tthis.rawNode = null;\n\n\t\t\t// shape: Object\n\t\t\t//\t\tan abstract shape object\n\t\t\t//\t\t(see dojox/gfx.defaultPath,\n\t\t\t//\t\tdojox/gfx.defaultPolyline,\n\t\t\t//\t\tdojox/gfx.defaultRect,\n\t\t\t//\t\tdojox/gfx.defaultEllipse,\n\t\t\t//\t\tdojox/gfx.defaultCircle,\n\t\t\t//\t\tdojox/gfx.defaultLine,\n\t\t\t//\t\tor dojox/gfx.defaultImage)\n\t\t\tthis.shape = null;\n\t\n\t\t\t// matrix: dojox/gfx/matrix.Matrix2D\n\t\t\t//\t\ta transformation matrix\n\t\t\tthis.matrix = null;\n\t\n\t\t\t// fillStyle: dojox/gfx.Fill\n\t\t\t//\t\ta fill object\n\t\t\t//\t\t(see dojox/gfx.defaultLinearGradient,\n\t\t\t//\t\tdojox/gfx.defaultRadialGradient,\n\t\t\t//\t\tdojox/gfx.defaultPattern,\n\t\t\t//\t\tor dojo/Color)\n\t\t\tthis.fillStyle = null;\n\t\n\t\t\t// strokeStyle: dojox/gfx.Stroke\n\t\t\t//\t\ta stroke object\n\t\t\t//\t\t(see dojox/gfx.defaultStroke)\n\t\t\tthis.strokeStyle = null;\n\t\n\t\t\t// bbox: dojox/gfx.Rectangle\n\t\t\t//\t\ta bounding box of this shape\n\t\t\t//\t\t(see dojox/gfx.defaultRect)\n\t\t\tthis.bbox = null;\n\t\n\t\t\t// virtual group structure\n\t\n\t\t\t// parent: Object\n\t\t\t//\t\ta parent or null\n\t\t\t//\t\t(see dojox/gfx/shape.Surface,\n\t\t\t//\t\tor dojox/gfx.Group)\n\t\t\tthis.parent = null;\n\t\n\t\t\t// parentMatrix: dojox/gfx/matrix.Matrix2D\n\t\t\t//\t\ta transformation matrix inherited from the parent\n\t\t\tthis.parentMatrix = null;\n\n\t\t\tif(has(\"gfxRegistry\")){\n\t\t\t\tvar uid = shape.register(this);\n\t\t\t\tthis.getUID = function(){\n\t\t\t\t\treturn uid;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t\n\t\tdestroy: function(){\n\t\t\t// summary:\n\t\t\t//\t\tReleases all internal resources owned by this shape. Once this method has been called,\n\t\t\t//\t\tthe instance is considered destroyed and should not be used anymore.\n\t\t\tif(has(\"gfxRegistry\")){\n\t\t\t\tshape.dispose(this);\n\t\t\t}\n\t\t\tif(this.rawNode && \"__gfxObject__\" in this.rawNode){\n\t\t\t\tthis.rawNode.__gfxObject__ = null;\n\t\t\t}\n\t\t\tthis.rawNode = null;\n\t\t},\n\t\n\t\t// trivial getters\n\t\n\t\tgetNode: function(){\n\t\t\t// summary:\n\t\t\t//\t\tDifferent graphics rendering subsystems implement shapes in different ways.  This\n\t\t\t//\t\tmethod provides access to the underlying graphics subsystem object.  Clients calling this\n\t\t\t//\t\tmethod and using the return value must be careful not to try sharing or using the underlying node\n\t\t\t//\t\tin a general way across renderer implementation.\n\t\t\t//\t\tReturns the underlying graphics Node, or null if no underlying graphics node is used by this shape.\n\t\t\treturn this.rawNode; // Node\n\t\t},\n\t\tgetShape: function(){\n\t\t\t// summary:\n\t\t\t//\t\treturns the current Shape object or null\n\t\t\t//\t\t(see dojox/gfx.defaultPath,\n\t\t\t//\t\tdojox/gfx.defaultPolyline,\n\t\t\t//\t\tdojox/gfx.defaultRect,\n\t\t\t//\t\tdojox/gfx.defaultEllipse,\n\t\t\t//\t\tdojox/gfx.defaultCircle,\n\t\t\t//\t\tdojox/gfx.defaultLine,\n\t\t\t//\t\tor dojox/gfx.defaultImage)\n\t\t\treturn this.shape; // Object\n\t\t},\n\t\tgetTransform: function(){\n\t\t\t// summary:\n\t\t\t//\t\tReturns the current transformation matrix applied to this Shape or null\n\t\t\treturn this.matrix;\t// dojox/gfx/matrix.Matrix2D\n\t\t},\n\t\tgetFill: function(){\n\t\t\t// summary:\n\t\t\t//\t\tReturns the current fill object or null\n\t\t\t//\t\t(see dojox/gfx.defaultLinearGradient,\n\t\t\t//\t\tdojox/gfx.defaultRadialGradient,\n\t\t\t//\t\tdojox/gfx.defaultPattern,\n\t\t\t//\t\tor dojo/Color)\n\t\t\treturn this.fillStyle;\t// Object\n\t\t},\n\t\tgetStroke: function(){\n\t\t\t// summary:\n\t\t\t//\t\tReturns the current stroke object or null\n\t\t\t//\t\t(see dojox/gfx.defaultStroke)\n\t\t\treturn this.strokeStyle;\t// Object\n\t\t},\n\t\tgetParent: function(){\n\t\t\t// summary:\n\t\t\t//\t\tReturns the parent Shape, Group or null if this Shape is unparented.\n\t\t\t//\t\t(see dojox/gfx/shape.Surface,\n\t\t\t//\t\tor dojox/gfx.Group)\n\t\t\treturn this.parent;\t// Object\n\t\t},\n\t\tgetBoundingBox: function(){\n\t\t\t// summary:\n\t\t\t//\t\tReturns the bounding box Rectangle for this shape or null if a BoundingBox cannot be\n\t\t\t//\t\tcalculated for the shape on the current renderer or for shapes with no geometric area (points).\n\t\t\t//\t\tA bounding box is a rectangular geometric region\n\t\t\t//\t\tdefining the X and Y extent of the shape.\n\t\t\t//\t\t(see dojox/gfx.defaultRect)\n\t\t\t//\t\tNote that this method returns a direct reference to the attribute of this instance. Therefore you should\n\t\t\t//\t\tnot modify its value directly but clone it instead.\n\t\t\treturn this.bbox;\t// dojox/gfx.Rectangle\n\t\t},\n\t\tgetTransformedBoundingBox: function(){\n\t\t\t// summary:\n\t\t\t//\t\treturns an array of four points or null\n\t\t\t//\t\tfour points represent four corners of the untransformed bounding box\n\t\t\tvar b = this.getBoundingBox();\n\t\t\tif(!b){\n\t\t\t\treturn null;\t// null\n\t\t\t}\n\t\t\tvar m = this._getRealMatrix(),\n\t\t\t\tgm = matrixLib;\n\t\t\treturn [\t// Array\n\t\t\t\t\tgm.multiplyPoint(m, b.x, b.y),\n\t\t\t\t\tgm.multiplyPoint(m, b.x + b.width, b.y),\n\t\t\t\t\tgm.multiplyPoint(m, b.x + b.width, b.y + b.height),\n\t\t\t\t\tgm.multiplyPoint(m, b.x, b.y + b.height)\n\t\t\t\t];\n\t\t},\n\t\tgetEventSource: function(){\n\t\t\t// summary:\n\t\t\t//\t\treturns a Node, which is used as\n\t\t\t//\t\ta source of events for this shape\n\t\t\t\n\t\t\t// COULD BE RE-IMPLEMENTED BY THE RENDERER!\n\t\t\treturn this.rawNode;\t// Node\n\t\t},\n\t\n\t\t// empty settings\n\t\t\n\t\tsetClip: function(clip){\n\t\t\t// summary:\n\t\t\t//\t\tsets the clipping area of this shape.\n\t\t\t// description:\n\t\t\t//\t\tThe clipping area defines the shape area that will be effectively visible. Everything that\n\t\t\t//\t\twould be drawn outside of the clipping area will not be rendered.\n\t\t\t//\t\tThe possible clipping area types are rectangle, ellipse, polyline and path, but all are not\n\t\t\t//\t\tsupported by all the renderers. vml only supports rectangle clipping, while the gfx silverlight renderer does not\n\t\t\t//\t\tsupport path clipping.\n\t\t\t//\t\tThe clip parameter defines the clipping area geometry, and should be an object with the following properties:\n\t\t\t//\n\t\t\t//\t\t- {x:Number, y:Number, width:Number, height:Number} for rectangular clip\n\t\t\t//\t\t- {cx:Number, cy:Number, rx:Number, ry:Number} for ellipse clip\n\t\t\t//\t\t- {points:Array} for polyline clip\n\t\t\t//\t\t- {d:String} for a path clip.\n\t\t\t//\n\t\t\t//\t\tThe clip geometry coordinates are expressed in the coordinate system used to draw the shape. In other\n\t\t\t//\t\twords, the clipping area is defined in the shape parent coordinate system and the shape transform is automatically applied.\n\t\t\t// example:\n\t\t\t//\t\tThe following example shows how to clip a gfx image with all the possible clip geometry: a rectangle,\n\t\t\t//\t\tan ellipse, a circle (using the ellipse geometry), a polyline and a path:\n\t\t\t//\n\t\t\t//\t|\tsurface.createImage({src:img, width:200,height:200}).setClip({x:10,y:10,width:50,height:50});\n\t\t\t//\t|\tsurface.createImage({src:img, x:100,y:50,width:200,height:200}).setClip({cx:200,cy:100,rx:20,ry:30});\n\t\t\t//\t|\tsurface.createImage({src:img, x:0,y:350,width:200,height:200}).setClip({cx:100,cy:425,rx:60,ry:60});\n\t\t\t//\t|\tsurface.createImage({src:img, x:300,y:0,width:200,height:200}).setClip({points:[350,0,450,50,380,130,300,110]});\n\t\t\t//\t|\tsurface.createImage({src:img, x:300,y:350,width:200,height:200}).setClip({d:\"M 350,350 C314,414 317,557 373,450.0000 z\"});\n\n\t\t\t// clip: Object\n\t\t\t//\t\tan object that defines the clipping geometry, or null to remove clip.\n\t\t\t\n\t\t\t// COULD BE RE-IMPLEMENTED BY THE RENDERER!\n\t\t\tthis.clip = clip;\n\t\t},\n\t\t\n\t\tgetClip: function(){\n\t\t\treturn this.clip;\n\t\t},\n\t\n\t\tsetShape: function(shape){\n\t\t\t// summary:\n\t\t\t//\t\tsets a shape object\n\t\t\t//\t\t(the default implementation simply ignores it)\n\t\t\t// shape: Object\n\t\t\t//\t\ta shape object\n\t\t\t//\t\t(see dojox/gfx.defaultPath,\n\t\t\t//\t\tdojox/gfx.defaultPolyline,\n\t\t\t//\t\tdojox/gfx.defaultRect,\n\t\t\t//\t\tdojox/gfx.defaultEllipse,\n\t\t\t//\t\tdojox/gfx.defaultCircle,\n\t\t\t//\t\tdojox/gfx.defaultLine,\n\t\t\t//\t\tor dojox/gfx.defaultImage)\n\t\t\t\n\t\t\t// COULD BE RE-IMPLEMENTED BY THE RENDERER!\n\t\t\tthis.shape = g.makeParameters(this.shape, shape);\n\t\t\tthis.bbox = null;\n\t\t\treturn this;\t// self\n\t\t},\n\t\tsetFill: function(fill){\n\t\t\t// summary:\n\t\t\t//\t\tsets a fill object\n\t\t\t//\t\t(the default implementation simply ignores it)\n\t\t\t// fill: Object\n\t\t\t//\t\ta fill object\n\t\t\t//\t\t(see dojox/gfx.defaultLinearGradient,\n\t\t\t//\t\tdojox/gfx.defaultRadialGradient,\n\t\t\t//\t\tdojox/gfx.defaultPattern,\n\t\t\t//\t\tor dojo/_base/Color)\n\t\t\t\n\t\t\t// COULD BE RE-IMPLEMENTED BY THE RENDERER!\n\t\t\tif(!fill){\n\t\t\t\t// don't fill\n\t\t\t\tthis.fillStyle = null;\n\t\t\t\treturn this;\t// self\n\t\t\t}\n\t\t\tvar f = null;\n\t\t\tif(typeof(fill) == \"object\" && \"type\" in fill){\n\t\t\t\t// gradient or pattern\n\t\t\t\tswitch(fill.type){\n\t\t\t\t\tcase \"linear\":\n\t\t\t\t\t\tf = g.makeParameters(g.defaultLinearGradient, fill);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"radial\":\n\t\t\t\t\t\tf = g.makeParameters(g.defaultRadialGradient, fill);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"pattern\":\n\t\t\t\t\t\tf = g.makeParameters(g.defaultPattern, fill);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\t// color object\n\t\t\t\tf = g.normalizeColor(fill);\n\t\t\t}\n\t\t\tthis.fillStyle = f;\n\t\t\treturn this;\t// self\n\t\t},\n\t\tsetStroke: function(stroke){\n\t\t\t// summary:\n\t\t\t//\t\tsets a stroke object\n\t\t\t//\t\t(the default implementation simply ignores it)\n\t\t\t// stroke: Object\n\t\t\t//\t\ta stroke object\n\t\t\t//\t\t(see dojox/gfx.defaultStroke)\n\t\t\t\n\t\t\t// COULD BE RE-IMPLEMENTED BY THE RENDERER!\n\t\t\tif(!stroke){\n\t\t\t\t// don't stroke\n\t\t\t\tthis.strokeStyle = null;\n\t\t\t\treturn this;\t// self\n\t\t\t}\n\t\t\t// normalize the stroke\n\t\t\tif(typeof stroke == \"string\" || lang.isArray(stroke) || stroke instanceof Color){\n\t\t\t\tstroke = {color: stroke};\n\t\t\t}\n\t\t\tvar s = this.strokeStyle = g.makeParameters(g.defaultStroke, stroke);\n\t\t\ts.color = g.normalizeColor(s.color);\n\t\t\treturn this;\t// self\n\t\t},\n\t\tsetTransform: function(matrix){\n\t\t\t// summary:\n\t\t\t//\t\tsets a transformation matrix\n\t\t\t// matrix: dojox/gfx/matrix.Matrix2D\n\t\t\t//\t\ta matrix or a matrix-like object\n\t\t\t//\t\t(see an argument of dojox/gfx/matrix.Matrix2D\n\t\t\t//\t\tconstructor for a list of acceptable arguments)\n\t\t\t\n\t\t\t// COULD BE RE-IMPLEMENTED BY THE RENDERER!\n\t\t\tthis.matrix = matrixLib.clone(matrix ? matrixLib.normalize(matrix) : matrixLib.identity);\n\t\t\treturn this._applyTransform();\t// self\n\t\t},\n\t\n\t\t_applyTransform: function(){\n\t\t\t// summary:\n\t\t\t//\t\tphysically sets a matrix\n\t\t\t\n\t\t\t// COULD BE RE-IMPLEMENTED BY THE RENDERER!\n\t\t\treturn this;\t// self\n\t\t},\n\t\n\t\t// z-index\n\t\n\t\tmoveToFront: function(){\n\t\t\t// summary:\n\t\t\t//\t\tmoves a shape to front of its parent's list of shapes\n\t\t\tvar p = this.getParent();\n\t\t\tif(p){\n\t\t\t\tp._moveChildToFront(this);\n\t\t\t\tthis._moveToFront();\t// execute renderer-specific action\n\t\t\t}\n\t\t\treturn this;\t// self\n\t\t},\n\t\tmoveToBack: function(){\n\t\t\t// summary:\n\t\t\t//\t\tmoves a shape to back of its parent's list of shapes\n\t\t\tvar p = this.getParent();\n\t\t\tif(p){\n\t\t\t\tp._moveChildToBack(this);\n\t\t\t\tthis._moveToBack();\t// execute renderer-specific action\n\t\t\t}\n\t\t\treturn this;\n\t\t},\n\t\t_moveToFront: function(){\n\t\t\t// summary:\n\t\t\t//\t\trenderer-specific hook, see dojox/gfx/shape.Shape.moveToFront()\n\t\t\t\n\t\t\t// COULD BE RE-IMPLEMENTED BY THE RENDERER!\n\t\t},\n\t\t_moveToBack: function(){\n\t\t\t// summary:\n\t\t\t//\t\trenderer-specific hook, see dojox/gfx/shape.Shape.moveToFront()\n\t\t\t\n\t\t\t// COULD BE RE-IMPLEMENTED BY THE RENDERER!\n\t\t},\n\t\n\t\t// apply left & right transformation\n\t\n\t\tapplyRightTransform: function(matrix){\n\t\t\t// summary:\n\t\t\t//\t\tmultiplies the existing matrix with an argument on right side\n\t\t\t//\t\t(this.matrix * matrix)\n\t\t\t// matrix: dojox/gfx/matrix.Matrix2D\n\t\t\t//\t\ta matrix or a matrix-like object\n\t\t\t//\t\t(see an argument of dojox/gfx/matrix.Matrix2D\n\t\t\t//\t\tconstructor for a list of acceptable arguments)\n\t\t\treturn matrix ? this.setTransform([this.matrix, matrix]) : this;\t// self\n\t\t},\n\t\tapplyLeftTransform: function(matrix){\n\t\t\t// summary:\n\t\t\t//\t\tmultiplies the existing matrix with an argument on left side\n\t\t\t//\t\t(matrix * this.matrix)\n\t\t\t// matrix: dojox/gfx/matrix.Matrix2D\n\t\t\t//\t\ta matrix or a matrix-like object\n\t\t\t//\t\t(see an argument of dojox/gfx/matrix.Matrix2D\n\t\t\t//\t\tconstructor for a list of acceptable arguments)\n\t\t\treturn matrix ? this.setTransform([matrix, this.matrix]) : this;\t// self\n\t\t},\n\t\tapplyTransform: function(matrix){\n\t\t\t// summary:\n\t\t\t//\t\ta shortcut for dojox/gfx/shape.Shape.applyRightTransform\n\t\t\t// matrix: dojox/gfx/matrix.Matrix2D\n\t\t\t//\t\ta matrix or a matrix-like object\n\t\t\t//\t\t(see an argument of dojox/gfx/matrix.Matrix2D\n\t\t\t//\t\tconstructor for a list of acceptable arguments)\n\t\t\treturn matrix ? this.setTransform([this.matrix, matrix]) : this;\t// self\n\t\t},\n\t\n\t\t// virtual group methods\n\t\n\t\tremoveShape: function(silently){\n\t\t\t// summary:\n\t\t\t//\t\tremoves the shape from its parent's list of shapes\n\t\t\t// silently: Boolean\n\t\t\t//\t\tif true, do not redraw a picture yet\n\t\t\tif(this.parent){\n\t\t\t\tthis.parent.remove(this, silently);\n\t\t\t}\n\t\t\treturn this;\t// self\n\t\t},\n\t\t_setParent: function(parent, matrix){\n\t\t\t// summary:\n\t\t\t//\t\tsets a parent\n\t\t\t// parent: Object\n\t\t\t//\t\ta parent or null\n\t\t\t//\t\t(see dojox/gfx/shape.Surface,\n\t\t\t//\t\tor dojox/gfx.Group)\n\t\t\t// matrix: dojox/gfx/matrix.Matrix2D\n\t\t\t//\t\ta 2D matrix or a matrix-like object\n\t\t\tthis.parent = parent;\n\t\t\treturn this._updateParentMatrix(matrix);\t// self\n\t\t},\n\t\t_updateParentMatrix: function(matrix){\n\t\t\t// summary:\n\t\t\t//\t\tupdates the parent matrix with new matrix\n\t\t\t// matrix: dojox/gfx/Matrix2D\n\t\t\t//\t\ta 2D matrix or a matrix-like object\n\t\t\tthis.parentMatrix = matrix ? matrixLib.clone(matrix) : null;\n\t\t\treturn this._applyTransform();\t// self\n\t\t},\n\t\t_getRealMatrix: function(){\n\t\t\t// summary:\n\t\t\t//\t\treturns the cumulative ('real') transformation matrix\n\t\t\t//\t\tby combining the shape's matrix with its parent's matrix\n\t\t\tvar m = this.matrix;\n\t\t\tvar p = this.parent;\n\t\t\twhile(p){\n\t\t\t\tif(p.matrix){\n\t\t\t\t\tm = matrixLib.multiply(p.matrix, m);\n\t\t\t\t}\n\t\t\t\tp = p.parent;\n\t\t\t}\n\t\t\treturn m;\t// dojox/gfx/matrix.Matrix2D\n\t\t}\n\t});\n\t\n\tshape._eventsProcessing = {\n\t\ton: function(type, listener){\n\t\t\t//\tsummary:\n\t\t\t//\t\tConnects an event to this shape.\n\n\t\t\treturn on(this.getEventSource(), type, shape.fixCallback(this, g.fixTarget, listener));\n\t\t},\n\n\t\tconnect: function(name, object, method){\n\t\t\t// summary:\n\t\t\t//\t\tconnects a handler to an event on this shape\n\t\t\t\n\t\t\t// COULD BE RE-IMPLEMENTED BY THE RENDERER!\n\t\t\t// redirect to fixCallback to normalize events and add the gfxTarget to the event. The latter\n\t\t\t// is done by dojox/gfx.fixTarget which is defined by each renderer\n\t\t\tif(name.substring(0, 2) == \"on\"){\n\t\t\t\tname = name.substring(2);\n\t\t\t}\n\t\t\treturn this.on(name, method ? lang.hitch(object, method) : object);\n\t\t},\n\n\t\tdisconnect: function(token){\n\t\t\t// summary:\n\t\t\t//\t\tconnects a handler by token from an event on this shape\n\t\t\t\n\t\t\t// COULD BE RE-IMPLEMENTED BY THE RENDERER!\n\t\n\t\t\treturn token.remove();\n\t\t}\n\t};\n\t\n\tshape.fixCallback = function(gfxElement, fixFunction, scope, method){\n\t\t// summary:\n\t\t//\t\tWraps the callback to allow for tests and event normalization\n\t\t//\t\tbefore it gets invoked. This is where 'fixTarget' is invoked.\n\t\t// tags:\n\t\t//      private\n\t\t// gfxElement: Object\n\t\t//\t\tThe GFX object that triggers the action (ex.:\n\t\t//\t\tdojox/gfx.Surface and dojox/gfx/shape.Shape). A new event property\n\t\t//\t\t'gfxTarget' is added to the event to reference this object.\n\t\t//\t\tfor easy manipulation of GFX objects by the event handlers.\n\t\t// fixFunction: Function\n\t\t//\t\tThe function that implements the logic to set the 'gfxTarget'\n\t\t//\t\tproperty to the event. It should be 'dojox/gfx.fixTarget' for\n\t\t//\t\tmost of the cases\n\t\t// scope: Object\n\t\t//\t\tOptional. The scope to be used when invoking 'method'. If\n\t\t//\t\tomitted, a global scope is used.\n\t\t// method: Function|String\n\t\t//\t\tThe original callback to be invoked.\n\t\tif(!method){\n\t\t\tmethod = scope;\n\t\t\tscope = null;\n\t\t}\n\t\tif(lang.isString(method)){\n\t\t\tscope = scope || kernel.global;\n\t\t\tif(!scope[method]){ throw(['dojox.gfx.shape.fixCallback: scope[\"', method, '\"] is null (scope=\"', scope, '\")'].join('')); }\n\t\t\treturn function(e){  \n\t\t\t\treturn fixFunction(e,gfxElement) ? scope[method].apply(scope, arguments || []) : undefined; }; // Function\n\t\t}\n\t\treturn !scope \n\t\t\t? function(e){ \n\t\t\t\treturn fixFunction(e,gfxElement) ? method.apply(scope, arguments) : undefined; } \n\t\t\t: function(e){ \n\t\t\t\treturn fixFunction(e,gfxElement) ? method.apply(scope, arguments || []) : undefined; }; // Function\n\t};\n\tlang.extend(shape.Shape, shape._eventsProcessing);\n\t\n\tshape.Container = {\n\t\t// summary:\n\t\t//\t\ta container of shapes, which can be used\n\t\t//\t\tas a foundation for renderer-specific groups, or as a way\n\t\t//\t\tto logically group shapes (e.g, to propagate matricies)\n\t\n\t\t_init: function() {\n\t\t\t// children: Array\n\t\t\t//\t\ta list of children\n\t\t\tthis.children = [];\n\t\t\tthis._batch = 0;\n\t\t},\n\t\n\t\t// group management\n\t\n\t\topenBatch: function() {\n\t\t\t// summary:\n\t\t\t//\t\tstarts a new batch, subsequent new child shapes will be held in\n\t\t\t//\t\tthe batch instead of appending to the container directly.\n\t\t\t// description:\n\t\t\t//\t\tBecause the canvas renderer has no DOM hierarchy, the canvas implementation differs\n\t\t\t//\t\tsuch that it suspends the repaint requests for this container until the current batch is closed by a call to closeBatch().\n\t\t\treturn this;\n\t\t},\n\t\tcloseBatch: function() {\n\t\t\t// summary:\n\t\t\t//\t\tsubmits the current batch, append all pending child shapes to DOM\n\t\t\t// description:\n\t\t\t//\t\tOn canvas, this method flushes the pending redraws queue.\n\t\t\treturn this;\n\t\t},\n\t\tadd: function(shape){\n\t\t\t// summary:\n\t\t\t//\t\tadds a shape to the list\n\t\t\t// shape: dojox/gfx/shape.Shape\n\t\t\t//\t\tthe shape to add to the list\n\t\t\tvar oldParent = shape.getParent();\n\t\t\tif(oldParent){\n\t\t\t\toldParent.remove(shape, true);\n\t\t\t}\n\t\t\tthis.children.push(shape);\n\t\t\treturn shape._setParent(this, this._getRealMatrix());\t// self\n\t\t},\n\t\tremove: function(shape, silently){\n\t\t\t// summary:\n\t\t\t//\t\tremoves a shape from the list\n\t\t\t// shape: dojox/gfx/shape.Shape\n\t\t\t//\t\tthe shape to remove\n\t\t\t// silently: Boolean\n\t\t\t//\t\tif true, do not redraw a picture yet\n\t\t\tfor(var i = 0; i < this.children.length; ++i){\n\t\t\t\tif(this.children[i] == shape){\n\t\t\t\t\tif(silently){\n\t\t\t\t\t\t// skip for now\n\t\t\t\t\t}else{\n\t\t\t\t\t\tshape.parent = null;\n\t\t\t\t\t\tshape.parentMatrix = null;\n\t\t\t\t\t}\n\t\t\t\t\tremoveItemAt(this.children, i);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn this;\t// self\n\t\t},\n\t\tclear: function(/*Boolean?*/ destroy){\n\t\t\t// summary:\n\t\t\t//\t\tremoves all shapes from a group/surface.\n\t\t\t// destroy: Boolean\n\t\t\t//\t\tIndicates whether the children should be destroyed. Optional.\n\t\t\tvar shape;\n\t\t\tfor(var i = 0; i < this.children.length;++i){\n\t\t\t\tshape = this.children[i];\n\t\t\t\tshape.parent = null;\n\t\t\t\tshape.parentMatrix = null;\n\t\t\t\tif(destroy){\n\t\t\t\t\tshape.destroy();\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.children = [];\n\t\t\treturn this;\t// self\n\t\t},\n\t\tgetBoundingBox: function(){\n\t\t\t// summary:\n\t\t\t//\t\tReturns the bounding box Rectangle for this shape.\n\t\t\tif(this.children){\n\t\t\t\t// if this is a composite shape, then sum up all the children\n\t\t\t\tvar result = null;\n\t\t\t\tarr.forEach(this.children, function(shape){\n\t\t\t\t\tvar bb = shape.getBoundingBox();\n\t\t\t\t\tif(bb){\n\t\t\t\t\t\tvar ct = shape.getTransform();\n\t\t\t\t\t\tif(ct){\n\t\t\t\t\t\t\tbb = matrixLib.multiplyRectangle(ct, bb);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(result){\n\t\t\t\t\t\t\t// merge two bbox \n\t\t\t\t\t\t\tresult.x = Math.min(result.x, bb.x);\n\t\t\t\t\t\t\tresult.y = Math.min(result.y, bb.y);\n\t\t\t\t\t\t\tresult.endX = Math.max(result.endX, bb.x + bb.width);\n\t\t\t\t\t\t\tresult.endY = Math.max(result.endY, bb.y + bb.height);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t// first bbox \n\t\t\t\t\t\t\tresult = {\n\t\t\t\t\t\t\t\tx: bb.x,\n\t\t\t\t\t\t\t\ty: bb.y,\n\t\t\t\t\t\t\t\tendX: bb.x + bb.width,\n\t\t\t\t\t\t\t\tendY: bb.y + bb.height\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif(result){\n\t\t\t\t\tresult.width = result.endX - result.x;\n\t\t\t\t\tresult.height = result.endY - result.y;\n\t\t\t\t}\n\t\t\t\treturn result; // dojox/gfx.Rectangle\n\t\t\t}\n\t\t\t// unknown/empty bounding box, subclass shall override this impl \n\t\t\treturn null;\n\t\t},\n\t\t// moving child nodes\n\t\t_moveChildToFront: function(shape){\n\t\t\t// summary:\n\t\t\t//\t\tmoves a shape to front of the list of shapes\n\t\t\t// shape: dojox/gfx/shape.Shape\n\t\t\t//\t\tone of the child shapes to move to the front\n\t\t\tfor(var i = 0; i < this.children.length; ++i){\n\t\t\t\tif(this.children[i] == shape){\n\t\t\t\t\tremoveItemAt(this.children, i);\n\t\t\t\t\tthis.children.push(shape);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn this;\t// self\n\t\t},\n\t\t_moveChildToBack: function(shape){\n\t\t\t// summary:\n\t\t\t//\t\tmoves a shape to back of the list of shapes\n\t\t\t// shape: dojox/gfx/shape.Shape\n\t\t\t//\t\tone of the child shapes to move to the front\n\t\t\tfor(var i = 0; i < this.children.length; ++i){\n\t\t\t\tif(this.children[i] == shape){\n\t\t\t\t\tremoveItemAt(this.children, i);\n\t\t\t\t\tthis.children.unshift(shape);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn this;\t// self\n\t\t}\n\t};\n\n\tshape.Surface = declare(\"dojox.gfx.shape.Surface\", null, {\n\t\t// summary:\n\t\t//\t\ta surface object to be used for drawings\n\t\tconstructor: function(){\n\t\t\t// underlying node\n\t\t\tthis.rawNode = null;\n\t\t\t// the parent node\n\t\t\tthis._parent = null;\n\t\t\t// the list of DOM nodes to be deleted in the case of destruction\n\t\t\tthis._nodes = [];\n\t\t\t// the list of events to be detached in the case of destruction\n\t\t\tthis._events = [];\n\t\t},\n\t\tdestroy: function(){\n\t\t\t// summary:\n\t\t\t//\t\tdestroy all relevant external resources and release all\n\t\t\t//\t\texternal references to make this object garbage-collectible\n\t\t\tarr.forEach(this._nodes, domConstruct.destroy);\n\t\t\tthis._nodes = [];\n\t\t\tarr.forEach(this._events, function(h){ if(h){ h.remove(); } });\n\t\t\tthis._events = [];\n\t\t\tthis.rawNode = null;\t// recycle it in _nodes, if it needs to be recycled\n\t\t\tif(has(\"ie\")){\n\t\t\t\twhile(this._parent.lastChild){\n\t\t\t\t\tdomConstruct.destroy(this._parent.lastChild);\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tthis._parent.innerHTML = \"\";\n\t\t\t}\n\t\t\tthis._parent = null;\n\t\t},\n\t\tgetEventSource: function(){\n\t\t\t// summary:\n\t\t\t//\t\treturns a node, which can be used to attach event listeners\n\t\t\treturn this.rawNode; // Node\n\t\t},\n\t\t_getRealMatrix: function(){\n\t\t\t// summary:\n\t\t\t//\t\talways returns the identity matrix\n\t\t\treturn null;\t// dojox/gfx/Matrix2D\n\t\t},\n\t\t/*=====\n\t\t setDimensions: function(width, height){\n\t\t\t // summary:\n\t\t\t //\t\tsets the width and height of the rawNode\n\t\t\t // width: String\n\t\t\t //\t\twidth of surface, e.g., \"100px\"\n\t\t\t // height: String\n\t\t\t //\t\theight of surface, e.g., \"100px\"\n\t\t\t return this;\t// self\n\t\t },\n\t\t getDimensions: function(){\n\t\t\t // summary:\n\t\t\t //     gets current width and height in pixels\n\t\t\t // returns: Object\n\t\t\t //     object with properties \"width\" and \"height\"\n\t\t },\n\t\t =====*/\n\t\tisLoaded: true,\n\t\tonLoad: function(/*dojox/gfx/shape.Surface*/ surface){\n\t\t\t// summary:\n\t\t\t//\t\tlocal event, fired once when the surface is created\n\t\t\t//\t\tasynchronously, used only when isLoaded is false, required\n\t\t\t//\t\tonly for Silverlight.\n\t\t},\n\t\twhenLoaded: function(/*Object|Null*/ context, /*Function|String*/ method){\n\t\t\tvar f = lang.hitch(context, method);\n\t\t\tif(this.isLoaded){\n\t\t\t\tf(this);\n\t\t\t}else{\n\t\t\t\ton.once(this, \"load\", function(surface){\n\t\t\t\t\tf(surface);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t});\n\tlang.extend(shape.Surface, shape._eventsProcessing);\n\n\t/*=====\n\tg.Point = declare(\"dojox/gfx.Point\", null, {\n\t\t// summary:\n\t\t//\t\t2D point for drawings - {x, y}\n\t\t// description:\n\t\t//\t\tDo not use this object directly!\n\t\t//\t\tUse the naked object instead: {x: 1, y: 2}.\n\t});\n\n\tg.Rectangle = declare(\"dojox.gfx.Rectangle\", null, {\n\t\t// summary:\n\t\t//\t\trectangle - {x, y, width, height}\n\t\t// description:\n\t\t//\t\tDo not use this object directly!\n\t\t//\t\tUse the naked object instead: {x: 1, y: 2, width: 100, height: 200}.\n\t});\n\t =====*/\n\n\n\tshape.Rect = declare(\"dojox.gfx.shape.Rect\", shape.Shape, {\n\t\t// summary:\n\t\t//\t\ta generic rectangle\n\t\tconstructor: function(rawNode){\n\t\t\t// rawNode: Node\n\t\t\t//\t\tThe underlying graphics system object (typically a DOM Node)\n\t\t\tthis.shape = g.getDefault(\"Rect\");\n\t\t\tthis.rawNode = rawNode;\n\t\t},\n\t\tgetBoundingBox: function(){\n\t\t\t// summary:\n\t\t\t//\t\treturns the bounding box (its shape in this case)\n\t\t\treturn this.shape;\t// dojox/gfx.Rectangle\n\t\t}\n\t});\n\t\n\tshape.Ellipse = declare(\"dojox.gfx.shape.Ellipse\", shape.Shape, {\n\t\t// summary:\n\t\t//\t\ta generic ellipse\n\t\tconstructor: function(rawNode){\n\t\t\t// rawNode: Node\n\t\t\t//\t\ta DOM Node\n\t\t\tthis.shape = g.getDefault(\"Ellipse\");\n\t\t\tthis.rawNode = rawNode;\n\t\t},\n\t\tgetBoundingBox: function(){\n\t\t\t// summary:\n\t\t\t//\t\treturns the bounding box\n\t\t\tif(!this.bbox){\n\t\t\t\tvar shape = this.shape;\n\t\t\t\tthis.bbox = {x: shape.cx - shape.rx, y: shape.cy - shape.ry,\n\t\t\t\t\twidth: 2 * shape.rx, height: 2 * shape.ry};\n\t\t\t}\n\t\t\treturn this.bbox;\t// dojox/gfx.Rectangle\n\t\t}\n\t});\n\t\n\tshape.Circle = declare(\"dojox.gfx.shape.Circle\", shape.Shape, {\n\t\t// summary:\n\t\t//\t\ta generic circle\n\t\tconstructor: function(rawNode){\n\t\t\t// rawNode: Node\n\t\t\t//\t\ta DOM Node\n\t\t\tthis.shape = g.getDefault(\"Circle\");\n\t\t\tthis.rawNode = rawNode;\n\t\t},\n\t\tgetBoundingBox: function(){\n\t\t\t// summary:\n\t\t\t//\t\treturns the bounding box\n\t\t\tif(!this.bbox){\n\t\t\t\tvar shape = this.shape;\n\t\t\t\tthis.bbox = {x: shape.cx - shape.r, y: shape.cy - shape.r,\n\t\t\t\t\twidth: 2 * shape.r, height: 2 * shape.r};\n\t\t\t}\n\t\t\treturn this.bbox;\t// dojox/gfx.Rectangle\n\t\t}\n\t});\n\t\n\tshape.Line = declare(\"dojox.gfx.shape.Line\", shape.Shape, {\n\t\t// summary:\n\t\t//\t\ta generic line (do not instantiate it directly)\n\t\tconstructor: function(rawNode){\n\t\t\t// rawNode: Node\n\t\t\t//\t\ta DOM Node\n\t\t\tthis.shape = g.getDefault(\"Line\");\n\t\t\tthis.rawNode = rawNode;\n\t\t},\n\t\tgetBoundingBox: function(){\n\t\t\t// summary:\n\t\t\t//\t\treturns the bounding box\n\t\t\tif(!this.bbox){\n\t\t\t\tvar shape = this.shape;\n\t\t\t\tthis.bbox = {\n\t\t\t\t\tx:\t\tMath.min(shape.x1, shape.x2),\n\t\t\t\t\ty:\t\tMath.min(shape.y1, shape.y2),\n\t\t\t\t\twidth:\tMath.abs(shape.x2 - shape.x1),\n\t\t\t\t\theight:\tMath.abs(shape.y2 - shape.y1)\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn this.bbox;\t// dojox/gfx.Rectangle\n\t\t}\n\t});\n\t\n\tshape.Polyline = declare(\"dojox.gfx.shape.Polyline\", shape.Shape, {\n\t\t// summary:\n\t\t//\t\ta generic polyline/polygon (do not instantiate it directly)\n\t\tconstructor: function(rawNode){\n\t\t\t// rawNode: Node\n\t\t\t//\t\ta DOM Node\n\t\t\tthis.shape = g.getDefault(\"Polyline\");\n\t\t\tthis.rawNode = rawNode;\n\t\t},\n\t\tsetShape: function(points, closed){\n\t\t\t// summary:\n\t\t\t//\t\tsets a polyline/polygon shape object\n\t\t\t// points: Object|Array\n\t\t\t//\t\ta polyline/polygon shape object, or an array of points\n\t\t\t// closed: Boolean\n\t\t\t//\t\tclose the polyline to make a polygon\n\t\t\tif(points && points instanceof Array){\n\t\t\t\tthis.inherited(arguments, [{points: points}]);\n\t\t\t\tif(closed && this.shape.points.length){\n\t\t\t\t\tthis.shape.points.push(this.shape.points[0]);\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tthis.inherited(arguments, [points]);\n\t\t\t}\n\t\t\treturn this;\t// self\n\t\t},\n\t\t_normalizePoints: function(){\n\t\t\t// summary:\n\t\t\t//\t\tnormalize points to array of {x:number, y:number}\n\t\t\tvar p = this.shape.points, l = p && p.length;\n\t\t\tif(l && typeof p[0] == \"number\"){\n\t\t\t\tvar points = [];\n\t\t\t\tfor(var i = 0; i < l; i += 2){\n\t\t\t\t\tpoints.push({x: p[i], y: p[i + 1]});\n\t\t\t\t}\n\t\t\t\tthis.shape.points = points;\n\t\t\t}\n\t\t},\n\t\tgetBoundingBox: function(){\n\t\t\t// summary:\n\t\t\t//\t\treturns the bounding box\n\t\t\tif(!this.bbox && this.shape.points.length){\n\t\t\t\tvar p = this.shape.points;\n\t\t\t\tvar l = p.length;\n\t\t\t\tvar t = p[0];\n\t\t\t\tvar bbox = {l: t.x, t: t.y, r: t.x, b: t.y};\n\t\t\t\tfor(var i = 1; i < l; ++i){\n\t\t\t\t\tt = p[i];\n\t\t\t\t\tif(bbox.l > t.x) bbox.l = t.x;\n\t\t\t\t\tif(bbox.r < t.x) bbox.r = t.x;\n\t\t\t\t\tif(bbox.t > t.y) bbox.t = t.y;\n\t\t\t\t\tif(bbox.b < t.y) bbox.b = t.y;\n\t\t\t\t}\n\t\t\t\tthis.bbox = {\n\t\t\t\t\tx:\t\tbbox.l,\n\t\t\t\t\ty:\t\tbbox.t,\n\t\t\t\t\twidth:\tbbox.r - bbox.l,\n\t\t\t\t\theight:\tbbox.b - bbox.t\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn this.bbox;\t// dojox/gfx.Rectangle\n\t\t}\n\t});\n\t\n\tshape.Image = declare(\"dojox.gfx.shape.Image\", shape.Shape, {\n\t\t// summary:\n\t\t//\t\ta generic image (do not instantiate it directly)\n\t\tconstructor: function(rawNode){\n\t\t\t// rawNode: Node\n\t\t\t//\t\ta DOM Node\n\t\t\tthis.shape = g.getDefault(\"Image\");\n\t\t\tthis.rawNode = rawNode;\n\t\t},\n\t\tgetBoundingBox: function(){\n\t\t\t// summary:\n\t\t\t//\t\treturns the bounding box (its shape in this case)\n\t\t\treturn this.shape;\t// dojox/gfx.Rectangle\n\t\t},\n\t\tsetStroke: function(){\n\t\t\t// summary:\n\t\t\t//\t\tignore setting a stroke style\n\t\t\treturn this;\t// self\n\t\t},\n\t\tsetFill: function(){\n\t\t\t// summary:\n\t\t\t//\t\tignore setting a fill style\n\t\t\treturn this;\t// self\n\t\t}\n\t});\n\t\n\tshape.Text = declare(shape.Shape, {\n\t\t// summary:\n\t\t//\t\ta generic text (do not instantiate it directly)\n\t\tconstructor: function(rawNode){\n\t\t\t// rawNode: Node\n\t\t\t//\t\ta DOM Node\n\t\t\tthis.fontStyle = null;\n\t\t\tthis.shape = g.getDefault(\"Text\");\n\t\t\tthis.rawNode = rawNode;\n\t\t},\n\t\tgetFont: function(){\n\t\t\t// summary:\n\t\t\t//\t\treturns the current font object or null\n\t\t\treturn this.fontStyle;\t// Object\n\t\t},\n\t\tsetFont: function(newFont){\n\t\t\t// summary:\n\t\t\t//\t\tsets a font for text\n\t\t\t// newFont: Object\n\t\t\t//\t\ta font object (see dojox/gfx.defaultFont) or a font string\n\t\t\tthis.fontStyle = typeof newFont == \"string\" ? g.splitFontString(newFont) :\n\t\t\t\tg.makeParameters(g.defaultFont, newFont);\n\t\t\tthis._setFont();\n\t\t\treturn this;\t// self\n\t\t},\n\t\tgetBoundingBox: function(){\n\t\t\tvar bbox = null, s = this.getShape();\n\t\t\tif(s.text){\n\t\t\t\tbbox = g._base._computeTextBoundingBox(this);\n\t\t\t}\n\t\t\treturn bbox;\n\t\t}\n\t});\n\t\n\tshape.Creator = {\n\t\t// summary:\n\t\t//\t\tshape creators\n\t\tcreateShape: function(shape){\n\t\t\t// summary:\n\t\t\t//\t\tcreates a shape object based on its type; it is meant to be used\n\t\t\t//\t\tby group-like objects\n\t\t\t// shape: Object\n\t\t\t//\t\ta shape descriptor object\n\t\t\t// returns: dojox/gfx/shape.Shape | Null\n\t\t\t//      a fully instantiated surface-specific Shape object\n\t\t\tswitch(shape.type){\n\t\t\t\tcase g.defaultPath.type:\t\treturn this.createPath(shape);\n\t\t\t\tcase g.defaultRect.type:\t\treturn this.createRect(shape);\n\t\t\t\tcase g.defaultCircle.type:\t    return this.createCircle(shape);\n\t\t\t\tcase g.defaultEllipse.type:\t    return this.createEllipse(shape);\n\t\t\t\tcase g.defaultLine.type:\t\treturn this.createLine(shape);\n\t\t\t\tcase g.defaultPolyline.type:\treturn this.createPolyline(shape);\n\t\t\t\tcase g.defaultImage.type:\t\treturn this.createImage(shape);\n\t\t\t\tcase g.defaultText.type:\t\treturn this.createText(shape);\n\t\t\t\tcase g.defaultTextPath.type:\treturn this.createTextPath(shape);\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\t\tcreateGroup: function(){\n\t\t\t// summary:\n\t\t\t//\t\tcreates a group shape\n\t\t\treturn this.createObject(g.Group);\t// dojox/gfx/Group\n\t\t},\n\t\tcreateRect: function(rect){\n\t\t\t// summary:\n\t\t\t//\t\tcreates a rectangle shape\n\t\t\t// rect: Object\n\t\t\t//\t\ta path object (see dojox/gfx.defaultRect)\n\t\t\treturn this.createObject(g.Rect, rect);\t// dojox/gfx/shape.Rect\n\t\t},\n\t\tcreateEllipse: function(ellipse){\n\t\t\t// summary:\n\t\t\t//\t\tcreates an ellipse shape\n\t\t\t// ellipse: Object\n\t\t\t//\t\tan ellipse object (see dojox/gfx.defaultEllipse)\n\t\t\treturn this.createObject(g.Ellipse, ellipse);\t// dojox/gfx/shape.Ellipse\n\t\t},\n\t\tcreateCircle: function(circle){\n\t\t\t// summary:\n\t\t\t//\t\tcreates a circle shape\n\t\t\t// circle: Object\n\t\t\t//\t\ta circle object (see dojox/gfx.defaultCircle)\n\t\t\treturn this.createObject(g.Circle, circle);\t// dojox/gfx/shape.Circle\n\t\t},\n\t\tcreateLine: function(line){\n\t\t\t// summary:\n\t\t\t//\t\tcreates a line shape\n\t\t\t// line: Object\n\t\t\t//\t\ta line object (see dojox/gfx.defaultLine)\n\t\t\treturn this.createObject(g.Line, line);\t// dojox/gfx/shape.Line\n\t\t},\n\t\tcreatePolyline: function(points){\n\t\t\t// summary:\n\t\t\t//\t\tcreates a polyline/polygon shape\n\t\t\t// points: Object\n\t\t\t//\t\ta points object (see dojox/gfx.defaultPolyline)\n\t\t\t//\t\tor an Array of points\n\t\t\treturn this.createObject(g.Polyline, points);\t// dojox/gfx/shape.Polyline\n\t\t},\n\t\tcreateImage: function(image){\n\t\t\t// summary:\n\t\t\t//\t\tcreates a image shape\n\t\t\t// image: Object\n\t\t\t//\t\tan image object (see dojox/gfx.defaultImage)\n\t\t\treturn this.createObject(g.Image, image);\t// dojox/gfx/shape.Image\n\t\t},\n\t\tcreateText: function(text){\n\t\t\t// summary:\n\t\t\t//\t\tcreates a text shape\n\t\t\t// text: Object\n\t\t\t//\t\ta text object (see dojox/gfx.defaultText)\n\t\t\treturn this.createObject(g.Text, text);\t// dojox/gfx/shape.Text\n\t\t},\n\t\tcreatePath: function(path){\n\t\t\t// summary:\n\t\t\t//\t\tcreates a path shape\n\t\t\t// path: Object\n\t\t\t//\t\ta path object (see dojox/gfx.defaultPath)\n\t\t\treturn this.createObject(g.Path, path);\t// dojox/gfx/shape.Path\n\t\t},\n\t\tcreateTextPath: function(text){\n\t\t\t// summary:\n\t\t\t//\t\tcreates a text shape\n\t\t\t// text: Object\n\t\t\t//\t\ta textpath object (see dojox/gfx.defaultTextPath)\n\t\t\treturn this.createObject(g.TextPath, {}).setText(text);\t// dojox/gfx/shape.TextPath\n\t\t},\n\t\tcreateObject: function(shapeType, rawShape){\n\t\t\t// summary:\n\t\t\t//\t\tcreates an instance of the passed shapeType class\n\t\t\t// shapeType: Function\n\t\t\t//\t\ta class constructor to create an instance of\n\t\t\t// rawShape: Object \n\t\t\t//\t\tproperties to be passed in to the classes 'setShape' method\n\t\n\t\t\t// SHOULD BE RE-IMPLEMENTED BY THE RENDERER!\n\t\t\treturn null;\t// dojox/gfx/shape.Shape\n\t\t}\n\t};\n\t\n\t/*=====\n\t lang.extend(shape.Surface, shape.Container);\n\t lang.extend(shape.Surface, shape.Creator);\n\n\t g.Group = declare(shape.Shape, {\n\t\t// summary:\n\t\t//\t\ta group shape, which can be used\n\t\t//\t\tto logically group shapes (e.g, to propagate matricies)\n\t});\n\tlang.extend(g.Group, shape.Container);\n\tlang.extend(g.Group, shape.Creator);\n\n\tg.Rect     = shape.Rect;\n\tg.Circle   = shape.Circle;\n\tg.Ellipse  = shape.Ellipse;\n\tg.Line     = shape.Line;\n\tg.Polyline = shape.Polyline;\n\tg.Text     = shape.Text;\n\tg.Surface  = shape.Surface;\n\t=====*/\n\n\treturn shape;\n});\n"],"sourceRoot":"webpack:///"}